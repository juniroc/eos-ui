<!DOCTYPE  html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ko" lang="ko"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>[별지 제21호서식] 일반과세자 부가가치세(예정¸ 확정¸ 기한후과세표준¸ 영세율 등 조기환급)신고서(부가가치세법 시행규칙)</title><meta name="author" content="wonsa"/><style type="text/css"> * {margin:0; padding:0; text-indent:0; }
 p { color: black; font-family:돋움체, monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; margin:0pt; }
 .s2 { color: black; font-family:HY견고딕, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 16.5pt; }
input[type="checkbox"] { width:15pt; height:15pt; margin:0; padding:0; vertical-align:middle; border:none; background:transparent; appearance:none; -webkit-appearance:none; -moz-appearance:none; cursor:pointer; }
input[type="checkbox"]:checked { background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='15' height='15' viewBox='0 0 15 15'%3E%3Cpath d='M2 7 L6 11 L13 2' stroke='black' stroke-width='2' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E"); background-size:contain; background-repeat:no-repeat; background-position:center; }
input[type="radio"] { width:7pt; height:7pt; margin:0; padding:0; vertical-align:middle; border:none; background:transparent; appearance:none; -webkit-appearance:none; -moz-appearance:none; cursor:pointer; position:relative; }
input[type="radio"]:checked::after { content:''; position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); width:6pt; height:6pt; border-radius:50%; border:1pt solid #000; background:transparent; }
 .s3 { color: black; font-family:돋움체, monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
 .s4 { color: black; font-family:돋움체, monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 7pt; }
 .s5 { color: black; font-family:돋움체, monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 8pt; }
 .s6 { color: black; font-family:돋움체, monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s7 { color: black; font-family:돋움체, monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; }
 .s8 { color: black; font-family:돋움체, monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 10pt; }
 .s9 { color: black; font-family:돋움체, monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 6pt; }
 .s11 { color: black; font-family:돋움체, monospace; font-style: normal; font-weight: bold; text-decoration: none; font-size: 8pt; }
 .s12 { color: black; font-family:"Times New Roman", serif; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 10pt; }
 .s13 { color: black; font-family:돋움체, monospace; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 10pt; }
 .s14 { color: black; font-family:돋움체, monospace; font-style: normal; font-weight: normal; text-decoration: underline; font-size: 8pt; }
 .s15 { color: black; font-family:돋움체, monospace; font-style: normal; font-weight: bold; text-decoration: none; font-size: 13pt; }
 li {display: block; }
 #l1 {padding-left: 0pt; }
 #l1> li>*:first-child:before {content: "■ "; color: black; font-family:돋움체, monospace; font-style: normal; font-weight: normal; text-decoration: none; font-size: 9pt; }
table, tbody {vertical-align: top; overflow: visible; }
body {width: 624pt; min-height: 882pt; padding-top: 10pt; padding-bottom: 20pt; margin: 0 auto; }
.report-period-input {
  height: 15pt !important;
  line-height: 15pt !important;
}
.report-period-input:hover {border: 1pt solid #808080 !important; }
.report-period-input:focus {border: 1pt solid #808080 !important; outline: none; }
.business-info-table td {
  vertical-align: middle !important;
  text-align: center !important;
  position: relative !important;
  padding: 0 !important;
  margin: 0 !important;
}
.business-info-table td p {
  text-align: center !important;
  margin: 0 !important;
  padding: 0 !important;
}
.business-info-table .cell-input {
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  width: 100% !important;
  height: 100% !important;
  border: 1pt solid transparent !important;
  padding: 0 !important;
  margin: 0 !important;
  font-family: Arial, sans-serif;
  font-size: 9pt;
  line-height: 1em !important;
  background: transparent;
  box-sizing: border-box !important;
/* 모든 테이블의 폭과 정렬 통일 */
table { box-sizing: border-box !important; border: none !important; }
table[style*="width:624pt"] { box-sizing: border-box !important; border: none !important; }
  text-align: center;
  color: #000;
  display: block;
}
.business-info-table .cell-input:hover {
  border: 1pt solid #808080 !important;
  margin: 0 !important;
  line-height: 1em !important;
}
.business-info-table .cell-input:focus {
  border: 1pt solid #808080 !important;
  margin: 0 !important;
  line-height: 1em !important;
  outline: none;
}
td[style*="width:30pt"][style*="세율"], td[style*="width:30pt"]:has(p:contains("세율")) { max-width: 30pt !important; width: 30pt !important; min-width: 30pt !important; }
/* 테이블 3을 제외한 모든 테이블에만 table-layout: fixed 적용 */
table:not(:nth-of-type(3)) { table-layout: fixed !important; }
table:not(:nth-of-type(3)) table { table-layout: fixed !important; }
/* 테이블 4를 독립적으로 제어 */
table:nth-of-type(4) { isolation: isolate; }
/* 테이블 3은 HTML에서 직접 width 지정 */
/* 테이블 3의 입력박스 높이를 12pt로 설정 */
table:nth-of-type(3) .cell-input,
table:nth-of-type(3) input[type="text"],
table:nth-of-type(3) input[type="number"],
table:nth-of-type(3) textarea { height: 12pt !important; }
/* 첫 번째 신고내용 테이블의 마지막 열(7열) 오른쪽 테두리 제거 */
table[style*="width:624pt"][style*="table-layout:fixed"] { border: none !important; }
table[style*="width:624pt"][style*="table-layout:fixed"] tr td[style*="width:171pt"],
table[style*="width:624pt"][style*="table-layout:fixed"] tr td[style*="width:134pt"] { border-right: none !important; border-right-width: 0 !important; border-right-style: none !important; border-right-color: transparent !important; }
table[style*="width:624pt"][style*="table-layout:fixed"] tr td[style*="width:171pt"] + td,
table[style*="width:624pt"][style*="table-layout:fixed"] tr td[style*="width:134pt"] + td { border-left: none !important; }
/* 매입세액 테이블의 우측 border 제거 및 폭 조정 */
table.new-purchase-tax-table { border-right: none !important; margin-top: 0 !important; margin-bottom: 2pt !important; }
table.new-purchase-tax-table tr td:last-child { border-right: none !important; border-right-width: 0 !important; border-right-style: none !important; border-right-color: transparent !important; }
/* 매입세액 테이블 아래 테이블 스타일 */
table.below-purchase-tax-table { border-right: none !important; border-left: none !important; margin-top: 0 !important; margin-bottom: 2pt !important; width: 624pt !important; }
table.below-purchase-tax-table tr:first-child td:first-child { padding-left: 3pt !important; padding-right: 0 !important; padding-top: 0 !important; padding-bottom: 0 !important; }
table.below-purchase-tax-table tr td:first-child { border-left: none !important; }
table.below-purchase-tax-table tr td:last-child { border-right: none !important; }
table.below-purchase-tax-table td { position: relative; padding: 0 !important; margin: 0 !important; }
table.below-purchase-tax-table .text-input:hover,
table.below-purchase-tax-table .text-input:focus { border: 1pt solid #808080 !important; margin: 0 !important; outline: none !important; }
/* ② 국세환급금 계좌신고 테이블 아래 테이블 스타일 */
table.below-account-report-table { border-right: none !important; border-left: none !important; margin-top: 0 !important; width: 624pt !important; }
table.below-account-report-table tr td:first-child { border-left: none !important; }
table.below-account-report-table tr td:last-child { border-right: none !important; }
table.below-account-report-table td { position: relative; padding: 0 !important; margin: 0 !important; }
table.below-account-report-table .text-input:hover,
table.below-account-report-table .text-input:focus { border: 1pt solid #808080 !important; margin: 0 !important; outline: none !important; }
/* 신고내용 테이블 입력박스 스타일 */
table[style*="width:624pt"][style*="table-layout:fixed"] td { position: relative; padding: 0 !important; margin: 0 !important; line-height: 0 !important; font-size: 0; vertical-align: middle; }
/* 신고내용 테이블 첫 번째 열 병합 셀(rowspan=9) 바닥 테두리 */
table[style*="width:624pt"][style*="table-layout:fixed"] tr:nth-child(2) td[rowspan="9"],
table[style*="width:624pt"][style*="table-layout:fixed"] tr:nth-child(2) td[rowspan='9'] { border-bottom: 1pt solid #7E7E7E !important; }
table[style*="width:624pt"][style*="table-layout:fixed"] td input { font-size: 8pt; line-height: 1em !important; }
table[style*="width:624pt"][style*="table-layout:fixed"] td .text-input { font-size: 9pt; }
table[style*="width:624pt"][style*="table-layout:fixed"] .number-input,
table[style*="width:624pt"][style*="table-layout:fixed"] .text-input,
table.new-purchase-tax-table .number-input,
table.new-purchase-tax-table .text-input { position: absolute; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; border: none; padding: 0 !important; margin: 0 !important; font-family: Arial, sans-serif; font-size: 8pt; line-height: 1em !important; background: transparent; box-sizing: border-box; }
table[style*="width:624pt"][style*="table-layout:fixed"] .number-input,
table.new-purchase-tax-table .number-input { text-align: right; padding-right: 10pt !important; }
table[style*="width:624pt"][style*="table-layout:fixed"] .text-input,
table.new-purchase-tax-table .text-input { text-align: center; font-size: 9pt; color: #000; }
table[style*="width:624pt"][style*="table-layout:fixed"] .number-input:hover,
table[style*="width:624pt"][style*="table-layout:fixed"] .text-input:hover,
table.new-purchase-tax-table .number-input:hover,
table.new-purchase-tax-table .text-input:hover { border: 1pt solid #808080; margin: 0 !important; margin-top: 0 !important; margin-bottom: 0 !important; line-height: 1em !important; }
table[style*="width:624pt"][style*="table-layout:fixed"] .number-input:focus,
table[style*="width:624pt"][style*="table-layout:fixed"] .text-input:focus,
table.new-purchase-tax-table .number-input:focus,
table.new-purchase-tax-table .text-input:focus { border: 1pt solid #808080; margin: 0 !important; margin-top: 0 !important; margin-bottom: 0 !important; line-height: 1em !important; outline: none; }
/* 새로 만든 테이블(inserted-between-tables)의 입력박스 스타일 */
table.inserted-between-tables td { position: relative; padding: 0 !important; margin: 0 !important; }
table.inserted-between-tables input { position: absolute; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; border: none; padding: 0 !important; margin: 0 !important; font-family: Arial, sans-serif; font-size: 8pt; line-height: 1em !important; background: transparent; box-sizing: border-box; outline: none; }
table.inserted-between-tables input { text-align: center !important; }
table.inserted-between-tables input:hover { border: 1pt solid #808080 !important; }
table.inserted-between-tables input:focus { border: 1pt solid #808080 !important; }
/* 폐업신고 아래 테이블(closure-report-detail-table)의 입력박스 스타일 */
table.closure-report-detail-table td { position: relative; padding: 0 !important; margin: 0 !important; }
table.closure-report-detail-table .text-input { position: absolute; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; border: none; padding: 0 !important; margin: 0 !important; font-family: Arial, sans-serif; font-size: 9pt; line-height: 1em !important; background: transparent; box-sizing: border-box; outline: none; }
table.closure-report-detail-table .text-input:hover { border: 1pt solid #808080 !important; }
table.closure-report-detail-table .text-input:focus { border: 1pt solid #808080 !important; }
table.closure-report-detail-table input[type="checkbox"] { width: 15pt; height: 15pt; margin: 0; padding: 0; vertical-align: middle; border: none; background: transparent; appearance: none; -webkit-appearance: none; -moz-appearance: none; cursor: pointer; }
table.closure-report-detail-table input[type="checkbox"]:checked { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='15' height='15' viewBox='0 0 15 15'%3E%3Cpath d='M2 7 L6 11 L13 2' stroke='black' stroke-width='2' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E"); background-size: contain; background-repeat: no-repeat; background-position: center; }
/* 폐업신고 테이블과 새 테이블 간 간격 유지 및 정렬 */
table.inserted-between-tables { margin-bottom: 2pt !important; border: none !important; box-sizing: border-box !important; width: 624pt !important; }
table.closure-report-detail-table { margin-top: 2pt !important; border: none !important; box-sizing: border-box !important; width: 624pt !important; }
table.below-zero-rate-table {
  margin-top: 2pt !important;
  margin-bottom: 2pt !important;
  border: none !important;
  box-sizing: border-box !important;
  width: 624pt !important;
  display: table !important;
  visibility: visible !important;
  opacity: 1 !important;
  position: relative !important;
}
table.below-zero-rate-table[data-below-zero-rate="true"] {
  display: table !important;
  visibility: visible !important;
  opacity: 1 !important;
}
table.below-zero-rate-table input.cell-input:focus {
  border: 0.5pt solid #C0C0C0 !important;
  outline: none !important;
}
table.below-zero-rate-table input.cell-input:hover {
  border: 0.5pt solid #C0C0C0 !important;
}
/* 숫자 입력박스 스피너 제거 */
table.below-zero-rate-table input[type="number"]::-webkit-inner-spin-button,
table.below-zero-rate-table input[type="number"]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
table.below-zero-rate-table input[type="number"] {
  -moz-appearance: textfield;
}
/* 6열 7행 분할된 셀의 너비 강제 설정 */
table.below-zero-rate-table td[data-col-split="left"] {
  width: 90pt !important;
  min-width: 90pt !important;
  max-width: 90pt !important;
}
table.below-zero-rate-table td[data-col-split="right"] {
  width: 233pt !important;
  min-width: 233pt !important;
  max-width: 233pt !important;
}
/* 폐업신고 테이블과 새 테이블의 좌측 정렬을 맞추기 위해 margin-left는 JavaScript로 동적으로 설정 */
/* 세무대리인 테이블 스타일 - 깜빡임 방지 */
/* 마지막 테이블의 첫 번째 행 첫 번째 셀 (세무대리인 텍스트가 있는 셀) */
table:last-of-type:not(.new-purchase-tax-table) tr:first-child td:first-child {
  vertical-align: middle !important;
  text-align: center !important;
  padding: 0 !important;
}
table:last-of-type:not(.new-purchase-tax-table) tr:first-child td:first-child p {
  padding: 0 !important;
  margin: 0 !important;
  text-align: center !important;
}
/* 세무대리인 테이블의 모든 셀에 대한 기본 스타일 */
table:last-of-type:not(.new-purchase-tax-table) {
  width: 624pt !important;
  margin-left: 0 !important;
  margin-right: auto !important;
  margin-top: 0 !important;
}
/* 새로 생성한 테이블의 margin-bottom을 2pt로 강제 설정 */
table.below-zero-rate-table[data-below-zero-rate="true"] {
  margin-bottom: 2pt !important;
  margin-top: 2pt !important;
}
/* 새로 생성한 테이블 다음에 오는 세무대리인 테이블의 margin-top 제거 */
table.below-zero-rate-table[data-below-zero-rate="true"] + table:last-of-type:not(.new-purchase-tax-table),
table.below-zero-rate-table[data-below-zero-rate="true"] ~ table:last-of-type:not(.new-purchase-tax-table),
table.after-below-zero-rate-table,
table.below-zero-rate-table[data-below-zero-rate="true"] + table,
table.below-zero-rate-table[data-below-zero-rate="true"] ~ table {
  margin-top: 0 !important;
  padding-top: 0 !important;
  line-height: 0 !important;
  font-size: 0 !important;
}
/* 테이블 사이의 모든 요소 제거 */
table.below-zero-rate-table[data-below-zero-rate="true"] + *:not(table) {
  display: none !important;
  height: 0 !important;
  margin: 0 !important;
  padding: 0 !important;
  line-height: 0 !important;
  font-size: 0 !important;
}
/* 사업자 테이블과 가로선(hr) 사이 간격 2pt */
table.business-info-table {
  margin-bottom: 2pt !important;
}
table.business-info-table + p + p + hr,
table.business-info-table ~ hr {
  margin-top: 0 !important;
  padding-top: 0 !important;
  line-height: 0 !important;
  font-size: 0 !important;
}
/* 사업자 테이블과 hr 사이의 p 태그 제거 */
table.business-info-table + p {
  margin: 0 !important;
  padding: 0 !important;
  height: 0 !important;
  line-height: 0 !important;
  font-size: 0 !important;
  display: none !important;
}
/* 세무대리인 테이블의 입력박스 스타일 (매입세액 테이블과 동일) */
table:last-of-type:not(.new-purchase-tax-table) td {
  position: relative;
  padding: 0 !important;
}
table:last-of-type:not(.new-purchase-tax-table) .text-input {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  width: 100%;
  height: 100%;
  border: none;
  padding: 0 !important;
  margin: 0 !important;
  font-family: Arial, sans-serif;
  font-size: 9pt;
  line-height: 1em !important;
  background: transparent;
  box-sizing: border-box;
  text-align: center;
  color: #000;
}
table:last-of-type:not(.new-purchase-tax-table) .text-input:hover {
  border: 1pt solid #808080;
  margin: 0 !important;
  line-height: 1em !important;
}
table:last-of-type:not(.new-purchase-tax-table) .text-input:focus {
  border: 1pt solid #808080;
  margin: 0 !important;
  line-height: 1em !important;
  outline: none;
}
</style><script type="text/javascript">
document.addEventListener('DOMContentLoaded', function() {
  var checkboxes = document.querySelectorAll('input[name="reportType"]');
  checkboxes.forEach(function(checkbox) {
    checkbox.addEventListener('change', function() {
      if (this.checked) {
        checkboxes.forEach(function(otherCheckbox) {
          if (otherCheckbox !== checkbox) {
            otherCheckbox.checked = false;
          }
        });
      }
    });
  });

  // 3번째 테이블의 빈 셀에 입력 박스 추가
  function addInputBoxesToEmptyCells() {
    const businessTable = document.querySelector('.business-info-table');
    if (!businessTable) {
      setTimeout(addInputBoxesToEmptyCells, 100);
      return;
    }

    const allCells = businessTable.querySelectorAll('td');
    let replacedCount = 0;

    allCells.forEach(function(td) {
      // 셀 스타일 강제 설정 (모든 셀에 적용)
      let cellStyle = td.getAttribute('style') || '';
      cellStyle = cellStyle.replace(/padding[^;]*/gi, '');
      cellStyle = cellStyle.replace(/margin[^;]*/gi, '');
      if (!cellStyle.includes('position:relative') && !cellStyle.includes('position: relative')) {
        cellStyle = cellStyle.replace(/position[^;]*/gi, '');
        if (cellStyle && !cellStyle.endsWith(';') && cellStyle.trim() !== '') {
          cellStyle += ';';
        }
        cellStyle += 'position:relative;';
      }
      if (cellStyle && !cellStyle.endsWith(';') && cellStyle.trim() !== '') {
        cellStyle += ';';
      }
      cellStyle += 'padding:0;margin:0;';
      td.setAttribute('style', cellStyle);

      // 이미 입력 박스가 있으면 스킵
      if (td.querySelector('input.cell-input')) return;

      // 텍스트가 있는 셀은 스킵
      const textElements = td.querySelectorAll('p.s3, p.s2');
      if (textElements.length > 0) {
        const hasRealText = Array.from(textElements).some(function(p) {
          const text = p.textContent.trim();
          return text !== '' && text !== '-' && text !== '사업자';
        });
        if (hasRealText) return;
      }

      // 빈 셀인지 확인
      const innerHTML = td.innerHTML.trim();
      const isEmpty = innerHTML === '' ||
                      innerHTML === '<p style="text-indent: 0pt;text-align: left;"><br/></p>' ||
                      innerHTML === '<p style="text-indent: 0pt;text-align: left;"></p>' ||
                      innerHTML === '<br/>' ||
                      (td.children.length === 1 && td.children[0].tagName === 'P' && (td.children[0].innerHTML.trim() === '<br/>' || td.children[0].innerHTML.trim() === '')) ||
                      (td.textContent.trim() === '' && !td.querySelector('input, select, textarea'));

      if (isEmpty) {
        // 셀 스타일 설정 (padding, margin 제거, position: relative 설정)
        let cellStyle = td.getAttribute('style') || '';
        cellStyle = cellStyle.replace(/padding[^;]*/gi, '');
        cellStyle = cellStyle.replace(/margin[^;]*/gi, '');
        cellStyle = cellStyle.replace(/position[^;]*/gi, '');
        if (cellStyle && !cellStyle.endsWith(';') && cellStyle.trim() !== '') {
          cellStyle += ';';
        }
        cellStyle += 'position:relative!important;padding:0!important;margin:0!important;';
        td.setAttribute('style', cellStyle);

        const input = document.createElement('input');
        input.type = 'text';
        input.className = 'cell-input';
        // 인라인 스타일로 셀 크기에 맞춤 (border는 CSS에 맡김)
        input.style.position = 'absolute';
        input.style.top = '0';
        input.style.left = '0';
        input.style.right = '0';
        input.style.bottom = '0';
        input.style.width = '100%';
        input.style.height = '100%';
        input.style.padding = '0';
        input.style.margin = '0';
        input.style.boxSizing = 'border-box';
        td.innerHTML = '';
        td.appendChild(input);
        replacedCount++;
      }
    });

    console.log('Replaced ' + replacedCount + ' empty cells with input boxes');
  }

  // 사업자 테이블의 모든 입력박스를 셀 크기에 맞춤 (강력한 버전)
  let isFittingInputBoxes = false; // 실행 중 플래그
  function fitInputBoxesToCells() {
    // 이미 실행 중이면 스킵
    if (isFittingInputBoxes) {
      return;
    }

    const businessTable = document.querySelector('.business-info-table');
    if (!businessTable) {
      setTimeout(fitInputBoxesToCells, 100);
      return;
    }

    isFittingInputBoxes = true; // 실행 시작

    const allCells = businessTable.querySelectorAll('td');
    let fixedCount = 0;

    allCells.forEach(function(td) {
      // 셀 스타일 강제 설정 - 모든 padding, margin 제거
      let cellStyle = td.getAttribute('style') || '';
      // 기존 padding, margin, position 제거
      cellStyle = cellStyle.replace(/padding[^;]*/gi, '');
      cellStyle = cellStyle.replace(/margin[^;]*/gi, '');
      cellStyle = cellStyle.replace(/position[^;]*/gi, '');
      // 세미콜론 정리
      cellStyle = cellStyle.replace(/;;+/g, ';');
      cellStyle = cellStyle.replace(/^;|;$/g, '');
      if (cellStyle && !cellStyle.endsWith(';') && cellStyle.trim() !== '') {
        cellStyle += ';';
      }
      // 필수 스타일 강제 적용
      cellStyle += 'position:relative!important;padding:0!important;margin:0!important;';
      td.setAttribute('style', cellStyle);

      // 입력박스가 있으면 스타일 강제 적용
      const input = td.querySelector('input.cell-input');
      if (input) {
        // 모든 스타일 제거 후 재설정
        input.removeAttribute('style');

        // 인라인 스타일로 강제 설정 (border는 CSS에 맡김)
        input.style.cssText = 'position:absolute!important;top:0!important;left:0!important;right:0!important;bottom:0!important;width:100%!important;height:100%!important;padding:0!important;margin:0!important;box-sizing:border-box!important;';

        // 추가로 setProperty로도 설정 (더 강력함, border는 제외)
        input.style.setProperty('position', 'absolute', 'important');
        input.style.setProperty('top', '0', 'important');
        input.style.setProperty('left', '0', 'important');
        input.style.setProperty('right', '0', 'important');
        input.style.setProperty('bottom', '0', 'important');
        input.style.setProperty('width', '100%', 'important');
        input.style.setProperty('height', '100%', 'important');
        input.style.setProperty('padding', '0', 'important');
        input.style.setProperty('margin', '0', 'important');
        input.style.setProperty('box-sizing', 'border-box', 'important');

        fixedCount++;
      }
    });

    console.log('사업자 테이블 입력박스 셀 크기 맞춤 완료: ' + fixedCount + '개');

    // 추가로 한 번 더 실행 (DOM 렌더링 후)
    setTimeout(function() {
      const allInputs = businessTable.querySelectorAll('input.cell-input');
      allInputs.forEach(function(input) {
        const td = input.closest('td');
        if (td) {
          input.style.setProperty('position', 'absolute', 'important');
          input.style.setProperty('top', '0', 'important');
          input.style.setProperty('left', '0', 'important');
          input.style.setProperty('right', '0', 'important');
          input.style.setProperty('bottom', '0', 'important');
          input.style.setProperty('width', '100%', 'important');
          input.style.setProperty('height', '100%', 'important');
        }
      });
      isFittingInputBoxes = false; // 실행 완료
    }, 100);
  }

  // 여러 시점에서 실행
  // 과세표준명세 테이블 초기 스타일 고정 함수
  function fixTaxBaseDetailTableStyle() {
    const allTables = document.querySelectorAll('table');
    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const tableText = table.textContent || '';
      const normalizedText = tableText.replace(/\s+/g, '');
      const textWithoutSpaces = tableText.replace(/\s/g, '');
      if ((tableText.includes('⑤') && tableText.includes('과세표준명세')) ||
          textWithoutSpaces.includes('⑤과세표준명세')) {
        let tableStyle = table.getAttribute('style') || '';
        if (!tableStyle.includes('table-layout:fixed')) {
          tableStyle = (tableStyle ? tableStyle + ';' : '') + 'table-layout:fixed !important;';
        }
        if (!tableStyle.includes('width:624pt')) {
          tableStyle += 'width:624pt !important;';
        }
        if (!tableStyle.includes('border-collapse:collapse')) {
          tableStyle += 'border-collapse:collapse !important;';
        }
        table.setAttribute('style', tableStyle);
        break;
      }
    }
  }

  // 즉시 실행 (DOM이 준비되면)
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
      fixTaxBaseDetailTableStyle();
      addInputBoxesToEmptyCells();
      setTimeout(fitInputBoxesToCells, 100);
      setTimeout(fitInputBoxesToCells, 300);
      setTimeout(fitInputBoxesToCells, 500);
    });
  } else {
    fixTaxBaseDetailTableStyle();
    addInputBoxesToEmptyCells();
    setTimeout(fitInputBoxesToCells, 100);
    setTimeout(fitInputBoxesToCells, 300);
    setTimeout(fitInputBoxesToCells, 500);
  }

  // window load 이벤트에서도 실행
  window.addEventListener('load', function() {
    setTimeout(fitInputBoxesToCells, 100);
    setTimeout(fitInputBoxesToCells, 500);
    setTimeout(ensureColumn7InputBoxes, 200);
    setTimeout(ensureColumn7InputBoxes, 600);
  });

  // MutationObserver로 DOM 변경 감지하여 자동으로 스타일 적용 (스타일 변경은 제외)
  if (typeof MutationObserver !== 'undefined') {
    const observer = new MutationObserver(function(mutations) {
      // 이미 실행 중이면 스킵
      if (isFittingInputBoxes) {
        return;
      }

      let shouldFix = false;
      mutations.forEach(function(mutation) {
        // childList 변경만 감지 (새로운 입력박스 추가)
        if (mutation.type === 'childList') {
          mutation.addedNodes.forEach(function(node) {
            if (node.nodeType === 1) { // Element node
              if (node.classList && node.classList.contains('cell-input')) {
                shouldFix = true;
              } else if (node.querySelector && node.querySelector('.cell-input')) {
                shouldFix = true;
              }
            }
          });
        }
        // attributes 변경은 무시 (무한 루프 방지)
      });

      if (shouldFix && !isFittingInputBoxes) {
        setTimeout(fitInputBoxesToCells, 50);
      }
    });

    // DOMContentLoaded 후 observer 시작
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', function() {
        const businessTable = document.querySelector('.business-info-table');
        if (businessTable) {
          observer.observe(businessTable, {
            childList: true,
            subtree: true,
            attributes: false // 스타일 변경 감지 비활성화
          });
        }
      });
    } else {
      const businessTable = document.querySelector('.business-info-table');
      if (businessTable) {
        observer.observe(businessTable, {
          childList: true,
          subtree: true,
          attributes: false // 스타일 변경 감지 비활성화
        });
      }
    }
  }

  // 셀 병합 해제 헬퍼 함수
  function unmergeCell(td, keepFirstCellContent) {
    const colspan = parseInt(td.getAttribute('colspan') || '1', 10);
    if (colspan <= 1) return false;

    const row = td.parentElement;
    const cellIndex = Array.from(row.children).indexOf(td);

    // 원래 셀의 내용과 스타일 저장
    const originalContent = td.innerHTML;
    const originalStyle = td.getAttribute('style') || '';
    const originalWidth = td.style.width || '';

    // 개별 셀 너비 계산 (원래 셀 너비를 colspan으로 나눔)
    const singleCellWidth = originalWidth ? parseFloat(originalWidth) / colspan : '';

    // 원래 셀 제거
    td.remove();

    // 개별 셀들 생성
    for (let i = 0; i < colspan; i++) {
      const newCell = document.createElement('td');
      newCell.setAttribute('style', originalStyle);
      if (singleCellWidth) {
        newCell.style.width = singleCellWidth + 'pt';
      }

      // 첫 번째 셀 처리
      if (i === 0) {
        if (keepFirstCellContent) {
          newCell.innerHTML = originalContent;
        } else {
          // 입력박스가 있으면 유지, 없으면 추가
          if (originalContent.includes('<input')) {
            newCell.innerHTML = originalContent;
          } else {
            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'cell-input';
            newCell.appendChild(input);
          }
        }
      } else {
        // 나머지 셀은 입력박스 추가
        const input = document.createElement('input');
        input.type = 'text';
        input.className = 'cell-input';
        newCell.appendChild(input);
      }

      // 셀을 올바른 위치에 삽입
      if (cellIndex + i < row.children.length) {
        row.insertBefore(newCell, row.children[cellIndex + i]);
      } else {
        row.appendChild(newCell);
      }
    }

    return true;
  }

  // 2행, 3행 처리: 사업장 병합 해제 및 셀 구조 재구성
  function unmergeBusinessAddressCell() {
    const businessTable = document.querySelector('.business-info-table');
    if (!businessTable) {
      return;
    }

    const allRows = businessTable.querySelectorAll('tr');

    // 2행 처리: "사업장" 병합 해제 및 "주소지", "휴대전화" 추가
    if (allRows.length > 1) {
      const row2 = allRows[1]; // 2행 (0-based index 1)
      const row2Cells = row2.querySelectorAll('td');
      let colIdx = 0;
      let businessCell = null;
      let businessCellIndex = -1;

      // "사업장" 셀 찾기 (6열에 있거나 병합되어 있을 수 있음)
      row2Cells.forEach(function(td, idx) {
        const textContent = td.textContent.trim();
        const colspan = parseInt(td.getAttribute('colspan') || '1', 10);
        const startCol = colIdx;
        const endCol = colIdx + colspan - 1;

        if (textContent.includes('사업장')) {
          businessCell = td;
          businessCellIndex = idx;
        }

        colIdx += colspan;
      });

      if (businessCell) {
        const businessColspan = parseInt(businessCell.getAttribute('colspan') || '1', 10);
        const businessStartCol = 0;
        let tempColIdx = 0;
        row2Cells.forEach(function(td, idx) {
          if (idx < businessCellIndex) {
            tempColIdx += parseInt(td.getAttribute('colspan') || '1', 10);
          }
        });
        const actualBusinessStartCol = tempColIdx;

        // "사업장" 셀이 병합되어 있으면 해제
        if (businessColspan > 1) {
          const cellStyle = businessCell.getAttribute('style') || '';
          const businessContent = businessCell.innerHTML;

          // 기존 "휴대전화" 셀 찾기 (14열~18열)
          let mobileCell = null;
          let mobileCellIndex = -1;
          colIdx = 0;
          row2Cells.forEach(function(td, idx) {
            const textContent = td.textContent.trim();
            const colspan = parseInt(td.getAttribute('colspan') || '1', 10);
            const startCol = colIdx;
            const endCol = colIdx + colspan - 1;

            if (textContent.includes('휴대전화') || (startCol === 13 && endCol === 17)) {
              mobileCell = td;
              mobileCellIndex = idx;
            }

            colIdx += colspan;
          });

          // 병합된 셀 제거
          businessCell.remove();

          // 6열에 "사업장" 셀 재생성 (colspan=1)
          const newBusinessCell = document.createElement('td');
          newBusinessCell.setAttribute('colspan', '1');
          newBusinessCell.setAttribute('style', cellStyle);
          newBusinessCell.innerHTML = businessContent;

          // 7열~13열에 "주소지" 셀 생성
          const addressCell = document.createElement('td');
          addressCell.setAttribute('colspan', '7');
          addressCell.setAttribute('style', cellStyle);
          addressCell.innerHTML = '<p class="s3" style="padding-left: 25pt;text-indent: 0pt;line-height: 9pt;text-align: left;">주소지</p>';

          // 적절한 위치에 삽입
          if (businessCellIndex < row2.children.length) {
            row2.insertBefore(newBusinessCell, row2.children[businessCellIndex]);
            row2.insertBefore(addressCell, row2.children[businessCellIndex + 1]);
          } else {
            row2.appendChild(newBusinessCell);
            row2.appendChild(addressCell);
          }

          // "휴대전화" 셀은 기존 것을 그대로 유지 (이미 있으면 그대로 둠)

          console.log('2행 처리 완료: 6열(사업장), 7열~13열(주소지), 14열~18열(휴대전화-기존유지)');
        } else {
          // 이미 단일 셀이면 "주소지"만 추가 (휴대전화는 기존 것 유지)
          const cellStyle = businessCell.getAttribute('style') || '';

          // 7열~13열에 "주소지" 셀이 있는지 확인
          let foundAddress = false;
          colIdx = 0;
          row2Cells.forEach(function(td) {
            const colspan = parseInt(td.getAttribute('colspan') || '1', 10);
            const startCol = colIdx;
            const endCol = colIdx + colspan - 1;

            if (startCol === 6 && endCol === 12) foundAddress = true;

            colIdx += colspan;
          });

          if (!foundAddress) {
            const addressCell = document.createElement('td');
            addressCell.setAttribute('colspan', '7');
            addressCell.setAttribute('style', cellStyle);
            addressCell.innerHTML = '<p class="s3" style="padding-left: 25pt;text-indent: 0pt;line-height: 9pt;text-align: left;">주소지</p>';
            if (businessCellIndex + 1 < row2.children.length) {
              row2.insertBefore(addressCell, row2.children[businessCellIndex + 1]);
            } else {
              row2.appendChild(addressCell);
            }
          }

          // "휴대전화"는 기존 것을 그대로 유지
        }
      }
    }

    // 3행 처리: 6열 입력박스 셀을 2개로 분할
    if (allRows.length > 2) {
      const row2 = allRows[1]; // 2행 (0-based index 1)
      const row3 = allRows[2]; // 3행 (0-based index 2)
      const row2Cells = Array.from(row2.querySelectorAll('td'));
      const row3Cells = Array.from(row3.querySelectorAll('td'));

      // 2행에서 "사업장" 셀 찾기 및 colspan 확인
      let businessColInRow2 = -1;
      let businessColspan = 1;
      let colIdx = 0;

      row2Cells.forEach(function(td) {
        const textContent = td.textContent.trim();
        if (textContent.includes('사업장')) {
          businessColInRow2 = colIdx;
          businessColspan = parseInt(td.getAttribute('colspan') || '1', 10);
          console.log('2행에서 "사업장" 셀 발견: 시작열=' + (businessColInRow2 + 1) + ', colspan=' + businessColspan);
        }
        colIdx += parseInt(td.getAttribute('colspan') || '1', 10);
      });

      if (businessColInRow2 < 0) {
        console.log('2행에서 "사업장" 셀을 찾을 수 없습니다.');
        return;
      }

      // 3행에서 6열(사업장 위치)에 해당하는 셀 찾기
      colIdx = 0;
      let targetCell = null;

      row3Cells.forEach(function(td) {
        const colspan = parseInt(td.getAttribute('colspan') || '1', 10);
        const startCol = colIdx;
        const endCol = colIdx + colspan - 1;

        // 6열(사업장 위치)을 포함하는 셀 찾기
        if (startCol <= businessColInRow2 && endCol >= businessColInRow2) {
          targetCell = td;
          console.log('3행에서 6열 셀 발견: 시작열=' + (startCol + 1) + ', 끝열=' + (endCol + 1) + ', colspan=' + colspan);
        }

        colIdx += colspan;
      });

      if (!targetCell) {
        console.log('3행에서 6열 셀을 찾을 수 없습니다.');
        return;
      }

      const targetColspan = parseInt(targetCell.getAttribute('colspan') || '1', 10);

      // 이미 분할되어 있는지 확인 (왼쪽 셀의 colspan이 "사업장" 셀의 colspan과 동일한지)
      if (targetColspan === businessColspan) {
        console.log('3행 6열은 이미 분할되어 있습니다.');
        return;
      }

      // 병합된 셀 분할
      const cellStyle = targetCell.getAttribute('style') || '';
      const nextSibling = targetCell.nextElementSibling;

      // 기존 셀 제거
      targetCell.remove();

      // 왼쪽 셀 생성 (2행의 "사업장" 셀 폭과 동일)
      const leftCell = document.createElement('td');
      leftCell.setAttribute('colspan', businessColspan.toString());
      // 셀 스타일 설정: padding, margin 제거, position: relative 설정
      let leftCellStyle = cellStyle;
      leftCellStyle = leftCellStyle.replace(/padding[^;]*/gi, '');
      leftCellStyle = leftCellStyle.replace(/margin[^;]*/gi, '');
      leftCellStyle = leftCellStyle.replace(/position[^;]*/gi, '');
      if (leftCellStyle && !leftCellStyle.endsWith(';') && leftCellStyle.trim() !== '') {
        leftCellStyle += ';';
      }
      leftCellStyle += 'position:relative!important;padding:0!important;margin:0!important;';
      leftCell.setAttribute('style', leftCellStyle);
      const inputLeft = document.createElement('input');
      inputLeft.type = 'text';
      inputLeft.className = 'cell-input';
      inputLeft.style.position = 'absolute';
      inputLeft.style.top = '0';
      inputLeft.style.left = '0';
      inputLeft.style.right = '0';
      inputLeft.style.bottom = '0';
      inputLeft.style.width = '100%';
      inputLeft.style.height = '100%';
      inputLeft.style.padding = '0';
      inputLeft.style.margin = '0';
      inputLeft.style.boxSizing = 'border-box';
      leftCell.appendChild(inputLeft);

      // 오른쪽 셀 생성 (나머지 폭)
      const rightColspan = targetColspan - businessColspan;
      const rightCell = document.createElement('td');
      rightCell.setAttribute('colspan', rightColspan.toString());
      // 셀 스타일 설정: padding, margin 제거, position: relative 설정
      let rightCellStyle = cellStyle;
      rightCellStyle = rightCellStyle.replace(/padding[^;]*/gi, '');
      rightCellStyle = rightCellStyle.replace(/margin[^;]*/gi, '');
      rightCellStyle = rightCellStyle.replace(/position[^;]*/gi, '');
      if (rightCellStyle && !rightCellStyle.endsWith(';') && rightCellStyle.trim() !== '') {
        rightCellStyle += ';';
      }
      rightCellStyle += 'position:relative!important;padding:0!important;margin:0!important;';
      rightCell.setAttribute('style', rightCellStyle);
      const inputRight = document.createElement('input');
      inputRight.type = 'text';
      inputRight.className = 'cell-input';
      inputRight.style.position = 'absolute';
      inputRight.style.top = '0';
      inputRight.style.left = '0';
      inputRight.style.right = '0';
      inputRight.style.bottom = '0';
      inputRight.style.width = '100%';
      inputRight.style.height = '100%';
      inputRight.style.padding = '0';
      inputRight.style.margin = '0';
      inputRight.style.boxSizing = 'border-box';
      rightCell.appendChild(inputRight);

      // 셀 삽입
      if (nextSibling) {
        row3.insertBefore(leftCell, nextSibling);
        row3.insertBefore(rightCell, leftCell.nextSibling);
      } else {
        row3.appendChild(leftCell);
        row3.appendChild(rightCell);
      }

      console.log('3행 6열 분할 완료: 왼쪽(colspan=' + businessColspan + '), 오른쪽(colspan=' + rightColspan + ')');
    }
  }

  // 여러 시점에서 실행
  // unmergeBusinessAddressCell() 함수 비활성화 - HTML을 최종 형태로 직접 수정하여 동적 기능 제거
  /*
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', unmergeBusinessAddressCell);
  } else {
    unmergeBusinessAddressCell();
  }
  */

  // 숫자 포맷팅 함수 (3자리 콤마)
  function formatNumber(value) {
    if (!value) return '';
    // 숫자가 아닌 문자 제거
    const numValue = value.toString().replace(/[^0-9]/g, '');
    if (!numValue) return '';
    // 3자리마다 콤마 추가
    return numValue.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
  }

  // 숫자 입력 이벤트 핸들러
  function handleNumberInput(e) {
    const input = e.target;
    const cursorPosition = input.selectionStart;

    // 현재 값에서 콤마 제거
    let newValue = input.value.replace(/,/g, '');

    // 숫자가 아닌 문자 제거
    newValue = newValue.replace(/[^0-9]/g, '');

    // 항상 포맷팅 적용
    const formatted = formatNumber(newValue);

    // 값이 변경된 경우에만 업데이트
    if (input.value !== formatted) {
      input.value = formatted;

      // 커서 위치 조정 (콤마 추가로 인한 위치 변화 고려)
      // 입력된 숫자 개수 기준으로 새 위치 계산
      const digitsBeforeCursor = input.value.substring(0, cursorPosition).replace(/,/g, '').length;
      let newPosition = 0;
      let digitCount = 0;

      for (let i = 0; i < formatted.length; i++) {
        if (formatted[i] !== ',') {
          digitCount++;
          if (digitCount === digitsBeforeCursor) {
            newPosition = i + 1;
            break;
          }
        }
      }

      if (newPosition === 0 && digitsBeforeCursor > 0) {
        newPosition = formatted.length;
      }

      setTimeout(function() {
        input.setSelectionRange(newPosition, newPosition);
      }, 0);
    }
  }

  // 첫 번째 신고내용 테이블의 빈 셀에 입력박스 추가
  function addInputBoxesToReportTable() {
    const reportTable = document.querySelector('table[style*="width:624pt"][style*="table-layout:fixed"]');
    if (!reportTable) {
      return;
    }

    // 열 폭 확인 (colgroup 또는 첫 번째 행의 셀 width 속성)
    const colgroup = reportTable.querySelector('colgroup');
    if (colgroup) {
      const cols = colgroup.querySelectorAll('col');
      console.log('=== 신고내용 테이블 열 폭 (colgroup) ===');
      cols.forEach(function(col, idx) {
        const style = col.getAttribute('style') || '';
        const widthMatch = style.match(/width:\s*(\d+pt)/);
        console.log('열' + (idx + 1) + ': ' + (widthMatch ? widthMatch[1] : 'width 없음'));
      });
    } else {
      // colgroup이 없으면 첫 번째 행의 셀 width 속성 확인
      const firstRow = reportTable.querySelector('tr');
      if (firstRow) {
        const cells = firstRow.querySelectorAll('td');
        console.log('=== 신고내용 테이블 열 폭 (첫 번째 행 셀 width) ===');
        let colIndex = 0;
        cells.forEach(function(cell, idx) {
          const style = cell.getAttribute('style') || '';
          const widthMatch = style.match(/width:\s*(\d+pt)/);
          const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);
          if (widthMatch) {
            console.log('열' + (colIndex + 1) + (colspan > 1 ? '~' + (colIndex + colspan) : '') + ': ' + widthMatch[1]);
          }
          colIndex += colspan;
        });
      }
    }

    // 모든 행을 순회하면서 실제 열 위치를 계산하여 입력박스 처리
    const allRows = reportTable.querySelectorAll('tr');
    let convertedCount = 0;
    let replacedCount = 0;

    allRows.forEach(function(row, rowIndex) {
      const cells = row.querySelectorAll('td');
      let currentColIndex = 0;

      // 행 번호 (헤더 행 제외, 1부터 시작)
      const rowNumber = rowIndex + 1;
      const isRow8 = (rowNumber === 8);
      const isRow9 = (rowNumber === 9);
      const isRow10 = (rowNumber === 10);

      // 디버깅: 8, 9, 10행의 전체 구조 출력
      if (isRow8 || isRow9 || isRow10) {
        console.log('=== 행' + rowNumber + ' 시작 (셀 개수: ' + cells.length + ') ===');
      }

      // 각 행의 셀 인덱스 (0부터 시작)
      let cellIndex = -1; // -1로 시작해서 먼저 증가시킴
      const totalCells = cells.length;

      cells.forEach(function(td) {
        cellIndex++; // 먼저 증가시켜서 현재 셀의 인덱스로 사용
        const colspan = parseInt(td.getAttribute('colspan') || '1', 10);
        const startColIndex = currentColIndex;
        const endColIndex = currentColIndex + colspan - 1;

        // 8, 9, 10행의 경우: 셀 위치만으로 판단 (셀 병합 무시)
        const isLastCell = (cellIndex === totalCells - 1);
        const isSecondLastCell = (cellIndex === totalCells - 2);
        const isThirdLastCell = (cellIndex === totalCells - 3);
        const isActuallyLastCell = (cellIndex === totalCells - 1); // 백업 확인용

        // 8, 9, 10행의 경우: 셀 위치 기반으로 열 번호 판단
        let isColumn5, isColumn6, isColumn7;
        if (isRow8 || isRow9 || isRow10) {
          // 마지막 셀 = 7열 (세액)
          isColumn7 = isLastCell;
          // 마지막에서 두 번째 셀 = 6열 (세율)
          isColumn6 = isSecondLastCell;
          // 마지막에서 세 번째 셀 = 5열 (금액)
          isColumn5 = isThirdLastCell;
        } else {
          // 다른 행은 기존 방식 사용
          isColumn5 = (startColIndex <= 4 && endColIndex >= 4);
          isColumn7 = (startColIndex <= 6 && endColIndex >= 6);
          isColumn6 = (startColIndex === 5 && endColIndex === 5);
        }

        // 디버깅: 8, 9, 10행의 모든 셀 정보 출력
        if (isRow8 || isRow9 || isRow10) {
          const hasInput = td.querySelector('input') !== null;
          const isEmptyCheck = td.innerHTML.trim() === '' ||
            td.innerHTML === '<p style="text-indent: 0pt;text-align: left;"><br/></p>' ||
            td.innerHTML === '<p style="text-indent: 0pt;text-align: left;"></p>' ||
            td.innerHTML === '<br/>' ||
            (td.children.length === 1 && td.children[0].tagName === 'P' && (td.children[0].innerHTML.trim() === '<br/>' || td.children[0].innerHTML.trim() === '')) ||
            (td.textContent.trim() === '' && !td.querySelector('input, select, textarea'));
          console.log('행' + rowNumber + ', 셀인덱스 ' + cellIndex + '/' + (totalCells-1) + ', 열인덱스 ' + startColIndex + '-' + endColIndex + ', colspan=' + colspan +
            ', hasInput=' + hasInput + ', isEmpty=' + isEmptyCheck +
            ', isLastCell=' + isLastCell + ', isSecondLastCell=' + isSecondLastCell + ', isThirdLastCell=' + isThirdLastCell +
            ', isColumn5=' + isColumn5 + ', isColumn6=' + isColumn6 + ', isColumn7=' + isColumn7);
        }

        // 기존 입력박스가 있는 경우
        const existingInput = td.querySelector('input');
        if (existingInput) {
          // 8, 9, 10행의 7열 (마지막 셀) - 숫자 입력창 (가장 먼저 확인, 가장 높은 우선순위)
          // cellIndex와 totalCells를 직접 비교하여 마지막 셀 확인
          if ((isRow8 || isRow9 || isRow10) && (isLastCell || isActuallyLastCell)) {
            console.log('  [기존입력박스] 행' + rowNumber + '의 7열(마지막셀, 셀인덱스' + cellIndex + '/' + (totalCells-1) + ', isLastCell=' + isLastCell + ', isActuallyLastCell=' + isActuallyLastCell + ') - 숫자 입력창으로 변환');
            existingInput.className = 'number-input';
            existingInput.style.textAlign = 'right';
            existingInput.style.fontSize = '8pt';
            existingInput.oninput = function(e) { handleNumberInput(e); };
            // 기존 이벤트 리스너 제거
            existingInput.removeEventListener('input', handleNumberInput);
            existingInput.addEventListener('input', handleNumberInput);
            convertedCount++;
            currentColIndex += colspan;
            return;
          }
          // 10행의 6열 (마지막에서 두 번째 셀) - 입력박스 제거
          if (isRow10 && isSecondLastCell) {
            console.log('  [기존입력박스] 행10의 6열(마지막에서두번째) - 입력박스 제거');
            existingInput.remove();
            td.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
            currentColIndex += colspan;
            return;
          }
          // 8, 9행의 6열 (마지막에서 두 번째 셀) - 텍스트 입력창
          if ((isRow8 || isRow9) && isSecondLastCell) {
            console.log('  [기존입력박스] 행' + rowNumber + '의 6열(마지막에서두번째) - 텍스트 입력창으로 변환');
            existingInput.className = 'text-input';
            existingInput.style.textAlign = 'center';
            existingInput.style.fontSize = '9pt';
            existingInput.style.color = '#000';
            existingInput.oninput = null;
            existingInput.removeEventListener('input', handleNumberInput);
            convertedCount++;
            currentColIndex += colspan;
            return;
          }
          // 8, 9행의 마지막 셀 강제 처리 (백업 조건)
          if ((isRow8 || isRow9) && isActuallyLastCell) {
            console.log('  [기존입력박스-백업] 행' + rowNumber + '의 마지막셀(셀인덱스' + cellIndex + '/' + (totalCells-1) + ') - 숫자 입력창으로 강제 변환');
            existingInput.className = 'number-input';
            existingInput.style.textAlign = 'right';
            existingInput.style.fontSize = '8pt';
            existingInput.oninput = function(e) { handleNumberInput(e); };
            existingInput.removeEventListener('input', handleNumberInput);
            existingInput.addEventListener('input', handleNumberInput);
            convertedCount++;
            currentColIndex += colspan;
            return;
          }
          // 8, 9, 10행의 7열 - 숫자 입력창 (isColumn7로 인식된 경우, 백업 조건)
          if ((isRow8 || isRow9 || isRow10) && isColumn7) {
            console.log('  [기존입력박스] 행' + rowNumber + '의 7열(isColumn7=true) - 숫자 입력창으로 변환');
            existingInput.className = 'number-input';
            existingInput.style.textAlign = 'right';
            existingInput.style.fontSize = '8pt';
            existingInput.oninput = function(e) { handleNumberInput(e); };
            existingInput.removeEventListener('input', handleNumberInput);
            existingInput.addEventListener('input', handleNumberInput);
            convertedCount++;
            currentColIndex += colspan;
            return;
          }
          // 8, 9행의 7열 (마지막 셀) - 숫자 입력창 (일반 처리에서도 확인)
          if ((isRow8 || isRow9) && (isLastCell || isActuallyLastCell)) {
            console.log('  [기존입력박스-일반처리] 행' + rowNumber + '의 7열(마지막셀, 셀인덱스' + cellIndex + '/' + (totalCells-1) + ') - 숫자 입력창으로 강제 변환');
            existingInput.className = 'number-input';
            existingInput.style.textAlign = 'right';
            existingInput.style.fontSize = '8pt';
            existingInput.oninput = function(e) { handleNumberInput(e); };
            existingInput.removeEventListener('input', handleNumberInput);
            existingInput.addEventListener('input', handleNumberInput);
            convertedCount++;
            currentColIndex += colspan;
            return;
          }
          // 5열 또는 7열이면 숫자 입력창으로 설정
          if (isColumn5 || isColumn7) {
            if (!existingInput.classList.contains('number-input')) {
              existingInput.className = 'number-input';
              existingInput.style.textAlign = 'right';
              existingInput.style.fontSize = '8pt';
              existingInput.oninput = function(e) { handleNumberInput(e); };
              convertedCount++;
            }
          }
          // 6열이면 텍스트 입력창으로 설정
          else if (isColumn6) {
            if (!existingInput.classList.contains('text-input')) {
              existingInput.className = 'text-input';
              existingInput.style.textAlign = 'center';
              existingInput.style.fontSize = '9pt';
              existingInput.style.color = '#000';
            }
          }
          currentColIndex += colspan;
          return;
        }

        // 빈 셀인지 확인
        const isEmpty = td.innerHTML.trim() === '' ||
                      td.innerHTML === '<p style="text-indent: 0pt;text-align: left;"><br/></p>' ||
                      td.innerHTML === '<p style="text-indent: 0pt;text-align: left;"></p>' ||
                      td.innerHTML === '<br/>' ||
                      (td.children.length === 1 && td.children[0].tagName === 'P' && (td.children[0].innerHTML.trim() === '<br/>' || td.children[0].innerHTML.trim() === '')) ||
                      (td.textContent.trim() === '' && !td.querySelector('input, select, textarea'));

        if (isEmpty) {
          // 디버깅: 10행의 빈 셀 처리
          if (isRow10) {
            console.log('  [빈셀처리] 행10, 셀인덱스 ' + cellIndex + '/' + (totalCells-1) + ', 열인덱스 ' + startColIndex + '-' + endColIndex + ', isLastCell=' + isLastCell + ', isSecondLastCell=' + isSecondLastCell);
          }

          // 8, 9, 10행의 7열 (마지막 셀) - 숫자 입력창 (가장 먼저 확인)
          if ((isRow8 || isRow9 || isRow10) && (isLastCell || isActuallyLastCell)) {
            console.log('  [생성] 행' + rowNumber + '의 7열(마지막셀, 셀인덱스' + cellIndex + '/' + (totalCells-1) + ') - 숫자 입력창');
            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'number-input';
            input.style.textAlign = 'right';
            input.style.fontSize = '8pt';
            input.oninput = function(e) { handleNumberInput(e); };
            td.innerHTML = '';
            td.appendChild(input);
            replacedCount++;
            currentColIndex += colspan;
            return;
          }

          // 10행의 6열 (마지막에서 두 번째 셀)에는 입력박스를 추가하지 않음
          if (isRow10 && isSecondLastCell) {
            console.log('  [스킵] 행10의 6열(마지막에서두번째) - 입력박스 추가 안함');
            currentColIndex += colspan;
            return;
          }

          const input = document.createElement('input');
          input.type = 'text';

          // 8, 9행의 6열 (마지막에서 두 번째 셀) - 텍스트 입력창
          if ((isRow8 || isRow9) && isSecondLastCell) {
            console.log('  [생성] 행' + rowNumber + '의 6열(마지막에서두번째) - 텍스트 입력창');
            input.className = 'text-input';
            input.style.textAlign = 'center';
            input.style.fontSize = '9pt';
            input.style.color = '#000';
            td.innerHTML = '';
            td.appendChild(input);
            replacedCount++;
            currentColIndex += colspan;
            return;
          }
          // 8, 9행의 마지막 셀 강제 처리 (백업 조건)
          if ((isRow8 || isRow9) && isActuallyLastCell) {
            console.log('  [생성-백업] 행' + rowNumber + '의 마지막셀(셀인덱스' + cellIndex + '/' + (totalCells-1) + ') - 숫자 입력창');
            input.className = 'number-input';
            input.style.textAlign = 'right';
            input.style.fontSize = '8pt';
            input.oninput = function(e) { handleNumberInput(e); };
            td.innerHTML = '';
            td.appendChild(input);
            replacedCount++;
            currentColIndex += colspan;
            return;
          }
          // 8, 9, 10행의 7열 - 숫자 입력창 (다른 방법으로 인식된 경우)
          if ((isRow8 || isRow9 || isRow10) && isColumn7) {
            console.log('  [생성] 행' + rowNumber + '의 7열 - 숫자 입력창');
            input.className = 'number-input';
            input.style.textAlign = 'right';
            input.style.fontSize = '8pt';
            input.oninput = function(e) { handleNumberInput(e); };
            td.innerHTML = '';
            td.appendChild(input);
            replacedCount++;
            currentColIndex += colspan;
            return;
          }
          // 5열 또는 7열이면 숫자 입력창
          if (isColumn5 || isColumn7) {
            input.className = 'number-input';
            input.style.textAlign = 'right';
            input.style.fontSize = '8pt';
            input.oninput = function(e) { handleNumberInput(e); };
          }
          // 6열이면 텍스트 입력창
          else if (isColumn6) {
            input.className = 'text-input';
            input.style.textAlign = 'center';
            input.style.fontSize = '9pt';
            input.style.color = '#000';
          }
          // 나머지는 숫자 입력창
          else {
            input.className = 'number-input';
            input.style.textAlign = 'right';
            input.style.fontSize = '8pt';
            input.oninput = function(e) { handleNumberInput(e); };
          }

          td.innerHTML = '';
          td.appendChild(input);
          replacedCount++;
        }

        currentColIndex += colspan;
        // cellIndex는 루프 시작 부분에서 이미 증가시킴
      });
    });

    if (convertedCount > 0) {
      console.log('Converted ' + convertedCount + ' inputs to number-input in columns 5 and 7');
    }
    if (replacedCount > 0) {
      console.log('Replaced ' + replacedCount + ' empty cells in report table with input boxes');
    }

    // 입력창 개수 확인
    const allInputs = reportTable.querySelectorAll('input');
    console.log('총 입력창 개수: ' + allInputs.length);
  }

  // 매입세액 테이블의 모든 병합 해제 (비활성화됨)
  /*function unmergeAllCellsInPurchaseTaxTable() {
    // "매입 세액" 텍스트가 포함된 테이블 찾기 (새로 만든 테이블 제외)
    const allTables = document.querySelectorAll('table');
    let purchaseTaxTable = null;

    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      // 새로 만든 테이블은 제외
      if (table.classList.contains('new-purchase-tax-table')) {
        continue;
      }
      const tableText = table.textContent || '';
      if (tableText.includes('매입 세액') || tableText.includes('매입세액')) {
        purchaseTaxTable = table;
        console.log('매입세액 테이블 발견');
        break;
      }
    }

    if (!purchaseTaxTable) {
      return;
    }

    const allRows = Array.from(purchaseTaxTable.querySelectorAll('tr'));
    console.log('매입세액 테이블 총 행 수: ' + allRows.length);

    // 12행을 미리 저장 (나중에 삭제하기 위해)
    let row12ToDelete = null;
    if (allRows.length > 11) {
      row12ToDelete = allRows[11]; // 0-based index: 12행=11
      console.log('12행 미리 저장 완료');
    }

    // 1단계: 모든 rowspan 처리
    // 먼저 모든 rowspan 셀을 수집 (역순으로 처리하여 이미 추가된 셀의 영향을 받지 않도록)
    const rowspanCells = [];
    for (let rowIdx = 0; rowIdx < allRows.length; rowIdx++) {
      const row = allRows[rowIdx];
      const cells = Array.from(row.querySelectorAll('td'));
      let colPos = 0;

      for (let cellIdx = 0; cellIdx < cells.length; cellIdx++) {
        const cell = cells[cellIdx];
        const rowspan = parseInt(cell.getAttribute('rowspan') || '1', 10);
        const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);

        if (rowspan > 1) {
          rowspanCells.push({
            rowIdx: rowIdx,
            cellIdx: cellIdx,
            cell: cell,
            rowspan: rowspan,
            colspan: colspan,
            colPos: colPos
          });
          console.log('rowspan 발견: 행' + (rowIdx + 1) + ', 열위치' + colPos + ', rowspan=' + rowspan + ', colspan=' + colspan);
        }

        colPos += colspan;
      }
    }

    // 역순으로 처리 (아래 행부터 위로)
    for (let i = rowspanCells.length - 1; i >= 0; i--) {
      const item = rowspanCells[i];
      const cell = item.cell;
      const rowIdx = item.rowIdx;
      const rowspan = item.rowspan;
      const colspan = item.colspan;
      const colPos = item.colPos;
      const cellStyle = cell.getAttribute('style') || '';

      // rowspan 제거
      cell.removeAttribute('rowspan');

      // 아래 행들에 빈 셀 추가
      for (let r = 1; r < rowspan; r++) {
        const targetRowIdx = rowIdx + r;
        if (targetRowIdx < allRows.length) {
          const targetRow = allRows[targetRowIdx];
          const targetCells = Array.from(targetRow.querySelectorAll('td'));

          // 실제 열 위치 계산 (targetRow에서)
          let targetColPos = 0;
          let insertBeforeCell = null;
          let insertIndex = 0;

          for (let tc = 0; tc < targetCells.length; tc++) {
            const tcColspan = parseInt(targetCells[tc].getAttribute('colspan') || '1', 10);
            if (targetColPos >= colPos) {
              insertBeforeCell = targetCells[tc];
              insertIndex = tc;
              break;
            }
            targetColPos += tcColspan;
            insertIndex = tc + 1;
          }

          // 새 셀 생성
          const newCell = document.createElement('td');
          newCell.setAttribute('style', cellStyle);
          if (colspan > 1) {
            newCell.setAttribute('colspan', colspan.toString());
          }
          newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';

          if (colPos === 0) {
            // 첫 번째 열인 경우 맨 앞에 삽입
            targetRow.insertBefore(newCell, targetRow.firstChild);
            console.log('행' + (targetRowIdx + 1) + '에 첫 번째 열 셀 삽입');
          } else if (insertBeforeCell) {
            targetRow.insertBefore(newCell, insertBeforeCell);
            console.log('행' + (targetRowIdx + 1) + '에 열위치' + colPos + '에 셀 삽입');
          } else if (insertIndex < targetCells.length) {
            targetRow.insertBefore(newCell, targetCells[insertIndex]);
            console.log('행' + (targetRowIdx + 1) + '에 인덱스' + insertIndex + '에 셀 삽입');
          } else {
            targetRow.appendChild(newCell);
            console.log('행' + (targetRowIdx + 1) + '에 맨 뒤에 셀 삽입');
          }
        }
      }
    }

    // 2단계: 모든 colspan 처리 (여러 번 반복하여 완전히 해제)
    let hasColspan = true;
    let iterationCount = 0;
    const maxIterations = 10; // 무한 루프 방지

    while (hasColspan && iterationCount < maxIterations) {
      hasColspan = false;
      iterationCount++;

      for (let rowIdx = 0; rowIdx < allRows.length; rowIdx++) {
        const row = allRows[rowIdx];
        const cells = Array.from(row.querySelectorAll('td'));
        const cellsToProcess = [];

        // 모든 colspan 셀 수집
        cells.forEach(function(cell) {
          const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);
          if (colspan > 1) {
            hasColspan = true;
            cellsToProcess.push({ cell: cell, colspan: colspan });
          }
        });

        // 각 colspan 셀 처리 (역순으로 처리하여 인덱스 문제 방지)
        for (let i = cellsToProcess.length - 1; i >= 0; i--) {
          const item = cellsToProcess[i];
          const cell = item.cell;
          const colspan = item.colspan;
          const cellStyle = cell.getAttribute('style') || '';

          // 기존 셀의 내용 확인
          const cellContent = cell.innerHTML;
          const hasInput = cell.querySelector('input, select, textarea');

          // 원래 셀 제거
          const nextSibling = cell.nextElementSibling;
          cell.remove();

          // 개별 셀들 생성
          for (let c = 0; c < colspan; c++) {
            const newCell = document.createElement('td');
            newCell.setAttribute('style', cellStyle);

            // 첫 번째 셀에만 원래 내용 유지 (입력 필드가 있는 경우는 제외)
            if (c === 0 && !hasInput) {
              // 입력 필드가 없는 경우에만 기존 내용 유지
              newCell.innerHTML = cellContent;
            } else {
              // 빈 셀로 만들기 (입력 필드가 추가될 수 있도록)
              // 기존 텍스트가 겹치지 않도록 완전히 비우기
              newCell.innerHTML = '';
            }

            if (nextSibling) {
              row.insertBefore(newCell, nextSibling);
            } else {
              row.appendChild(newCell);
            }
          }
        }
      }
    }

    console.log('매입세액 테이블 병합 해제 완료 (반복 횟수: ' + iterationCount + ')');

    // 3단계: 1열의 11행, 12행, 13행에 상하 경계선 확인 및 추가
    if (allRows.length >= 13) {
      // 11행 (0-based index 10)
      const row11 = allRows[10];
      const row11FirstCell = row11.querySelector('td');
      if (row11FirstCell) {
        const style11 = row11FirstCell.getAttribute('style') || '';
        let hasTopBorder = style11.includes('border-top');
        let hasBottomBorder = style11.includes('border-bottom');

        console.log('11행 1열 - 상단경계선: ' + hasTopBorder + ', 하단경계선: ' + hasBottomBorder);

        if (!hasBottomBorder) {
          row11FirstCell.setAttribute('style', style11 + (style11 ? '; ' : '') + 'border-bottom: 1pt solid #7E7E7E;');
          console.log('11행 1열에 하단 경계선 추가');
        }
      }

      // 12행 (0-based index 11)
      const row12 = allRows[11];
      const row12FirstCell = row12.querySelector('td');
      if (row12FirstCell) {
        let style12 = row12FirstCell.getAttribute('style') || '';
        let hasTopBorder = style12.includes('border-top');
        let hasBottomBorder = style12.includes('border-bottom');

        console.log('12행 1열 - 상단경계선: ' + hasTopBorder + ', 하단경계선: ' + hasBottomBorder);

        if (!hasTopBorder) {
          style12 = style12 + (style12 ? '; ' : '') + 'border-top: 1pt solid #7E7E7E;';
          console.log('12행 1열에 상단 경계선 추가');
        }
        if (!hasBottomBorder) {
          style12 = style12 + (style12 ? '; ' : '') + 'border-bottom: 1pt solid #7E7E7E;';
          console.log('12행 1열에 하단 경계선 추가');
        }
        if (!hasTopBorder || !hasBottomBorder) {
          row12FirstCell.setAttribute('style', style12);
        }
      }

      // 13행 (0-based index 12)
      const row13 = allRows[12];
      const row13FirstCell = row13.querySelector('td');
      if (row13FirstCell) {
        let style13 = row13FirstCell.getAttribute('style') || '';
        let hasTopBorder = style13.includes('border-top');
        let hasBottomBorder = style13.includes('border-bottom');

        console.log('13행 1열 - 상단경계선: ' + hasTopBorder + ', 하단경계선: ' + hasBottomBorder);

        if (!hasTopBorder) {
          style13 = style13 + (style13 ? '; ' : '') + 'border-top: 1pt solid #7E7E7E;';
          console.log('13행 1열에 상단 경계선 추가');
        }
        if (!hasBottomBorder) {
          style13 = style13 + (style13 ? '; ' : '') + 'border-bottom: 1pt solid #7E7E7E;';
          console.log('13행 1열에 하단 경계선 추가');
        }
        if (!hasTopBorder || !hasBottomBorder) {
          row13FirstCell.setAttribute('style', style13);
        }
      }
    }

    // 4단계: 12행, 14행, 16행의 병합 셀 해제
    const rowsToUnmerge = [11, 13, 15]; // 0-based index: 12행=11, 14행=13, 16행=15

    rowsToUnmerge.forEach(function(rowIndex) {
      if (rowIndex < allRows.length) {
        const row = allRows[rowIndex];
        const cells = Array.from(row.querySelectorAll('td'));
        const cellsToProcess = [];

        // 병합된 셀 찾기 (rowspan 또는 colspan이 1보다 큰 셀)
        cells.forEach(function(cell) {
          const rowspan = parseInt(cell.getAttribute('rowspan') || '1', 10);
          const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);

          if (rowspan > 1 || colspan > 1) {
            cellsToProcess.push({
              cell: cell,
              rowspan: rowspan,
              colspan: colspan
            });
            console.log('행' + (rowIndex + 1) + '에서 병합 셀 발견: rowspan=' + rowspan + ', colspan=' + colspan);
          }
        });

        // 역순으로 처리하여 인덱스 문제 방지
        for (let i = cellsToProcess.length - 1; i >= 0; i--) {
          const item = cellsToProcess[i];
          const cell = item.cell;
          const rowspan = item.rowspan;
          const colspan = item.colspan;
          const cellStyle = cell.getAttribute('style') || '';
          const cellContent = cell.innerHTML;

          // rowspan이 있는 경우: 아래 행들에 셀 추가
          if (rowspan > 1) {
            const currentRow = cell.parentElement;
            const rowIdx = Array.from(currentRow.parentElement.children).indexOf(currentRow);

            // rowspan 제거
            cell.removeAttribute('rowspan');

            // 아래 행들에 빈 셀 추가
            for (let r = 1; r < rowspan; r++) {
              const targetRowIdx = rowIdx + r;
              if (targetRowIdx < allRows.length) {
                const targetRow = allRows[targetRowIdx];
                const newCell = document.createElement('td');
                newCell.setAttribute('style', cellStyle);
                if (colspan > 1) {
                  newCell.setAttribute('colspan', colspan.toString());
                }
                newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';

                // 같은 열 위치에 삽입
                const cellIndex = Array.from(currentRow.children).indexOf(cell);
                const targetCells = Array.from(targetRow.querySelectorAll('td'));
                if (cellIndex < targetCells.length) {
                  targetRow.insertBefore(newCell, targetCells[cellIndex]);
                } else {
                  targetRow.appendChild(newCell);
                }
              }
            }
          }

          // colspan이 있는 경우: 여러 개의 셀로 분리
          if (colspan > 1) {
            const nextSibling = cell.nextElementSibling;
            cell.remove();

            // 개별 셀들 생성
            for (let c = 0; c < colspan; c++) {
              const newCell = document.createElement('td');
              newCell.setAttribute('style', cellStyle);

              // 첫 번째 셀에만 원래 내용 유지
              if (c === 0) {
                newCell.innerHTML = cellContent;
              } else {
                newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
              }

              if (nextSibling) {
                row.insertBefore(newCell, nextSibling);
              } else {
                row.appendChild(newCell);
              }
            }
          }
        }

        console.log('행' + (rowIndex + 1) + ' 병합 해제 완료');
      }
    });

    // 5단계: 빨간선 추가 부분 제거 (디버깅용이었음)

    // 6단계: 12행 직접 삭제 (처음에 저장해둔 12행을 바로 삭제)
    if (row12ToDelete) {
      row12ToDelete.remove();
      console.log('12행 직접 삭제 완료');
    }

    // 7단계: 11행 2열의 텍스트 제거 (겹침 방지)
    const finalRowsAfterDelete = Array.from(purchaseTaxTable.querySelectorAll('tr'));
    const row11Index = 10; // 0-based index: 11행=10

    if (row11Index < finalRowsAfterDelete.length) {
      const row11 = finalRowsAfterDelete[row11Index];
      const cells = Array.from(row11.querySelectorAll('td'));

      // 실제 열 위치를 추적하여 2열 찾기
      let colPos = 0;

      for (let i = 0; i < cells.length; i++) {
        const cell = cells[i];
        const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);

        // 2열인지 확인 (colPos가 1이면 2열, 0-based이므로)
        if (colPos === 1) {
          // 텍스트만 제거 (입력 필드는 유지)
          const textNodes = [];
          const walker = document.createTreeWalker(
            cell,
            NodeFilter.SHOW_TEXT,
            null,
            false
          );

          let node;
          while (node = walker.nextNode()) {
            if (node.textContent.trim()) {
              textNodes.push(node);
            }
          }

          // 텍스트 노드 제거
          textNodes.forEach(function(textNode) {
            textNode.remove();
          });

          // <p> 태그 내의 텍스트도 제거
          const pTags = cell.querySelectorAll('p');
          pTags.forEach(function(p) {
            if (!p.querySelector('input, select, textarea')) {
              p.textContent = '';
              p.innerHTML = '<br/>';
            }
          });

          console.log('11행 2열 텍스트 제거 완료');
          break;
        }

        colPos += colspan;
      }
    }
  }*/

  // 매입세액 테이블 위에 7열 23행 새 테이블 생성
  let newPurchaseTaxTableCreated = false;
  function createNewPurchaseTaxTable() {
    if (newPurchaseTaxTableCreated) {
      console.log('새 매입세액 테이블은 이미 생성되었습니다.');
      return;
    }

    // "매입 세액" 텍스트가 포함된 테이블 찾기
    const allTables = document.querySelectorAll('table');
    let purchaseTaxTable = null;

    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const tableText = table.textContent || '';
      if (tableText.includes('매입 세액') || tableText.includes('매입세액')) {
        purchaseTaxTable = table;
        console.log('매입세액 테이블 발견');
        break;
      }
    }

    if (!purchaseTaxTable) {
      return;
    }

    // 새 테이블 생성
    const newTable = document.createElement('table');
    newTable.setAttribute('class', 'new-purchase-tax-table');
    newTable.setAttribute('style', 'width:624pt;border-collapse:collapse;margin:0;margin-top:0;table-layout:fixed;box-sizing:border-box;');
    newTable.setAttribute('cellspacing', '0');

    // 23행 생성
    for (let r = 0; r < 23; r++) {
      const newRow = document.createElement('tr');
      newRow.setAttribute('style', 'height:15pt');

      // 7열 생성 (열 폭: 1열 39.5pt, 2열 63pt, 3열 122.5pt, 4열 24pt, 5열 161pt, 6열 39.5pt, 7열 174.5pt)
      // 합계: 39.5+63+122.5+24+161+39.5+174.5 = 624pt
      const columnWidths = [39.5, 63, 122.5, 24, 161, 39.5, 174.5];

      for (let c = 0; c < 7; c++) {
        const newCell = document.createElement('td');

        // 셀 스타일 설정
        let cellStyle = 'vertical-align:middle;width:' + columnWidths[c] + 'pt;';

        // 외곽선: 상하는 검정
        if (r === 0) {
          cellStyle += 'border-top:1pt solid #000;';
        }

        // 외곽선: 하단은 검정
        if (r === 22) {
          cellStyle += 'border-bottom:1pt solid #000;';
        }

        // 내부 간선: 좌우는 #7E7E7E (첫 번째 열 제외, 좌우 외곽선 없음)
        if (c > 0) {
          cellStyle += 'border-left:1pt solid #7E7E7E;';
        }
        // 마지막 열의 우측 border 제거
        if (c === 6) {
          cellStyle += 'border-right:none;';
        }

        // 내부 간선: 상하는 #7E7E7E
        // 10행(r=9)의 상하 경계선은 1.5pt (#000)
        if (r === 9) {
          cellStyle += 'border-top:1.5pt solid #000;';
          cellStyle += 'border-bottom:1.5pt solid #000;';
        } else {
          if (r > 0) {
            cellStyle += 'border-top:1pt solid #7E7E7E;';
          }
          if (r < 22) {
            cellStyle += 'border-bottom:1pt solid #7E7E7E;';
          }
        }

        newCell.setAttribute('style', cellStyle);
        newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';

        newRow.appendChild(newCell);
      }

      newTable.appendChild(newRow);
    }

    // 특정 셀에 텍스트 추가 및 병합
    const allRows = newTable.querySelectorAll('tr');

    // 1열 1행~9행 병합: '매입 (줄바꿈) 세액' 중앙정렬
    const cell1_1 = allRows[0].querySelector('td:nth-child(1)');
    if (cell1_1) {
      cell1_1.setAttribute('rowspan', '9');
      let currentStyle = cell1_1.getAttribute('style') || '';
      // 기존 스타일에 중앙정렬 추가 (중복 방지)
      if (!currentStyle.includes('text-align')) {
        currentStyle += ';text-align:center;';
      } else {
        currentStyle = currentStyle.replace(/text-align[^;]*/gi, 'text-align:center');
      }
      cell1_1.setAttribute('style', currentStyle);
      cell1_1.innerHTML = '<p class="s3" style="text-indent: 0pt;line-height: 110%;text-align: center;font-size: 9pt;">매입<br/>세액</p>';

      // 2행~9행의 1열 셀 제거 (병합으로 인해)
      for (let r = 1; r < 9; r++) {
        const row = allRows[r];
        if (row) {
          const firstCell = row.querySelector('td:nth-child(1)');
          if (firstCell) {
            console.log('행 ' + (r + 1) + '의 1열 셀 제거');
            firstCell.remove();
          } else {
            console.log('행 ' + (r + 1) + '의 1열 셀을 찾을 수 없음');
          }
        }
      }
      console.log('1열 병합 완료 (1행~9행)');
    } else {
      console.log('1행 1열 셀을 찾을 수 없음');
    }

    // 2열 1행~3행 병합: '세금계산서 (줄바꿈) 수취분'
    const cell2_1 = allRows[0].querySelector('td:nth-child(2)');
    if (cell2_1) {
      cell2_1.setAttribute('rowspan', '3');
      let cell2Style = cell2_1.getAttribute('style') || '';
      // 기존 text-align 제거하고 가운데 맞춤으로 설정
      cell2Style = cell2Style.replace(/text-align[^;]*/gi, '');
      cell2Style = cell2Style.replace(/;;+/g, ';').replace(/^;|;$/g, '');
      if (cell2Style && !cell2Style.endsWith(';')) {
        cell2Style += ';';
      }
      cell2_1.setAttribute('style', cell2Style + 'text-align:center;');
      cell2_1.innerHTML = '<p class="s3" style="text-indent: 0pt;line-height: 100%;text-align: center;font-size: 9pt;">세금계산서<br/><span style="letter-spacing: 8pt;">수취</span>분</p>';

      // 2행~3행의 2열 셀 제거 (병합으로 인해)
      // 주의: 1행의 1열이 이미 병합되어 제거되었으므로, 2행~3행에서는 nth-child(1)이 2열이 됨
      for (let r = 1; r < 3; r++) {
        const row = allRows[r];
        const secondCell = row.querySelector('td:nth-child(1)');
        if (secondCell) {
          secondCell.remove();
        }
      }
    }

    // 3열 1행: '일반매입' 좌측정렬 (1행은 1열, 2열이 병합되어 있으므로 nth-child(3)이 맞음)
    const cell3_1 = allRows[0].querySelector('td:nth-child(3)');
    if (cell3_1) {
      cell3_1.innerHTML = '<p class="s3" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">일반매입</p>';
    }

    // 3열 2행: '수출기업 수입분 납부유예' 좌측정렬 (2행은 1열, 2열이 제거되어 있으므로 nth-child(1)이 3열)
    const cell3_2 = allRows[1].querySelector('td:nth-child(1)');
    if (cell3_2) {
      cell3_2.innerHTML = '<p class="s3" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">수출기업 수입분 납부유예</p>';
    }

    // 3열 3행: '고정자산 매입' 좌측정렬 (3행은 1열, 2열이 제거되어 있으므로 nth-child(1)이 3열)
    const cell3_3 = allRows[2].querySelector('td:nth-child(1)');
    if (cell3_3) {
      cell3_3.innerHTML = '<p class="s3" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">고정자산 매입</p>';
    }

    // 4열 1행~3행에 번호 추가: (10), (11), (12)
    // 1행: 1열(병합), 2열(병합), 3열, 4열, 5열, 6열, 7열 → 4열은 nth-child(4)
    // 2행~3행: 1열(병합), 2열(병합)이 제거되어 3열, 4열, 5열, 6열, 7열만 남음 → 4열은 nth-child(2)
    for (let r = 0; r < 3; r++) {
      const row = allRows[r];
      if (row) {
        let cell4;
        if (r === 0) {
          // 1행: 4열은 nth-child(4)
          cell4 = row.querySelector('td:nth-child(4)');
        } else {
          // 2행~3행: 1열, 2열이 병합되어 제거되었으므로 nth-child(2)가 4열
          cell4 = row.querySelector('td:nth-child(2)');
        }
        if (cell4) {
          const number = 10 + r;
          cell4.innerHTML = '<p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">(' + number + ')</p>';
        }
      }
    }

    // 5열 2행 셀에 배경색 #C0C0C0 추가
    // 2행은 0-based로 index 1, 1열과 2열이 병합되어 제거되었으므로 5열은 nth-child(3)
    const row2 = allRows[1];
    if (row2) {
      const cell5_2 = row2.querySelector('td:nth-child(3)');
      if (cell5_2) {
        let cell5Style = cell5_2.getAttribute('style') || '';
        cell5Style += 'background-color:#C0C0C0;';
        cell5_2.setAttribute('style', cell5Style);
      }
    }

    // 4행~9행: 2열과 3열 병합 및 텍스트 삽입
    // 4행~9행: 1열(병합)만 제거되어 있음 → nth-child(1)이 실제 2열, nth-child(2)가 실제 3열
    const rowTexts = [
      '예정신고 누락분',                    // 4행 (r=3)
      '매입자발행 세금계산서',              // 5행 (r=4)
      '그 밖의 공제매입세액',                // 6행 (r=5)
      '합계 (10)-(11)+(12)+(13)+(14)+(15)', // 7행 (r=6)
      '공제받지 못할 매입세액',              // 8행 (r=7)
      '차감계 (16)-(17)'                    // 9행 (r=8)
    ];

    for (let r = 3; r < 9; r++) {
      const row = allRows[r];
      if (row) {
        // 1열이 제거되었으므로 nth-child(1)이 실제 2열, nth-child(2)가 실제 3열
        const cell2 = row.querySelector('td:nth-child(1)');
        const cell3 = row.querySelector('td:nth-child(2)');

        if (cell2 && cell3) {
          // 2열 셀에 colspan="2" 추가
          cell2.setAttribute('colspan', '2');

          // 2열 셀 스타일에 너비 조정 (2열+3열 너비 합산: 65pt + 120.5pt = 185.5pt)
          let cell2Style = cell2.getAttribute('style') || '';
          cell2Style = cell2Style.replace(/width:[^;]*/gi, '');
          cell2Style += 'width:185.5pt;';
          cell2.setAttribute('style', cell2Style);

          // 텍스트 삽입 (좌측정렬)
          const textIndex = r - 3;
          cell2.innerHTML = '<p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">' + rowTexts[textIndex] + '</p>';

          // 3열 셀 제거
          cell3.remove();

          console.log('행 ' + (r + 1) + ': 2열과 3열 병합 완료');
        }
      }
    }

    // 병합 후 4행~9행의 4열에 번호 다시 추가: (13), (14), ..., (18)
    // 병합 후 구조: 1열(제거), 2열(병합 colspan=2), 4열(nth-child(2)), 5열(nth-child(3)), 6열(nth-child(4)), 7열(nth-child(5))
    for (let r = 3; r < 9; r++) {
      const row = allRows[r];
      if (row) {
        // 병합 후 4열은 nth-child(2)
        const cell4 = row.querySelector('td:nth-child(2)');
        if (cell4) {
          const number = 10 + r;
          cell4.innerHTML = '<p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">(' + number + ')</p>';
          console.log('행 ' + (r + 1) + ': 4열에 (' + number + ') 번호 삽입 완료');
        }
      }
    }

    // 9행 6열에 원문자 '㉯' 텍스트 삽입
    // 9행은 0-based index 8
    // 병합 후 구조: 1열(제거), 2열(병합 colspan=2), 4열(nth-child(2)), 5열(nth-child(3)), 6열(nth-child(4)), 7열(nth-child(5))
    const row9 = allRows[8];
    if (row9) {
      // 6열은 nth-child(4) (1열 제거, 2열+3열 병합 후)
      const cell6 = row9.querySelector('td:nth-child(4)');
      if (cell6) {
        // 기존 HTML의 '㉮' 텍스트 스타일 참조 (신고내용 테이블 10행 6열)
        // 원문자 텍스트는 중앙 정렬되고 특정 폰트 크기를 가짐 (폰트 크기 10pt로 설정)
        cell6.innerHTML = '<p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;font-size: 10pt;">㉯</p>';
        console.log('9행 6열에 원문자 \'㉯\' 텍스트 삽입 완료');
      }
    }

    // 10행 1~5열 병합 및 텍스트 삽입
    // 10행은 0-based index 9
    // 1열은 rowspan=9로 1~9행까지 병합되어 있으므로, 10행에는 1열이 다시 나타남
    // 10행 구조: 1열(nth-child(1)), 2열(nth-child(2)), 3열(nth-child(3)), 4열(nth-child(4)), 5열(nth-child(5)), 6열(nth-child(6)), 7열(nth-child(7))
    const row10 = allRows[9];
    if (row10) {
      // 1열~5열 병합: nth-child(1)부터 nth-child(5)까지
      const cell1 = row10.querySelector('td:nth-child(1)');
      const cell2 = row10.querySelector('td:nth-child(2)');
      const cell3 = row10.querySelector('td:nth-child(3)');
      const cell4 = row10.querySelector('td:nth-child(4)');
      const cell5 = row10.querySelector('td:nth-child(5)');

      if (cell1 && cell2 && cell3 && cell4 && cell5) {
        // 1열 셀에 colspan="5" 추가
        cell1.setAttribute('colspan', '5');

        // 1열 셀 스타일에 너비 조정 (1열+2열+3열+4열+5열 너비 합산: 40+65+121+25+161 = 412pt)
        let cell1Style = cell1.getAttribute('style') || '';
        cell1Style = cell1Style.replace(/width:[^;]*/gi, '');
        cell1Style += 'width:412pt;';
        cell1.setAttribute('style', cell1Style);

        // 텍스트 삽입 (좌측정렬, 굵게)
        cell1.innerHTML = '<p class="s6" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;font-weight: bold;">납부(환급)세액 (매출세액㉮-매입세액㉯)</p>';

        // 2열~5열 셀 제거
        cell2.remove();
        cell3.remove();
        cell4.remove();
        cell5.remove();

        console.log('10행 1~5열 병합 및 텍스트 삽입 완료');
      }

      // 6열에 원문자 '㉰' 텍스트 삽입 (병합 후 6열은 nth-child(2)가 됨)
      const cell6 = row10.querySelector('td:nth-child(2)');
      if (cell6) {
        // 원문자 텍스트는 중앙 정렬되고 폰트 크기 10pt로 설정
        cell6.innerHTML = '<p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;font-size: 10pt;">㉰</p>';
        console.log('10행 6열에 원문자 \'㉰\' 텍스트 삽입 완료');
      }
    }

    // 11행~13행 1열 병합 및 텍스트 삽입
    // 11행~13행은 0-based index 10, 11, 12
    // 1열은 nth-child(1)
    const row11 = allRows[10];
    if (row11) {
      const cell1_11 = row11.querySelector('td:nth-child(1)');
      if (cell1_11) {
        // 1열 셀에 rowspan="3" 추가 (11행~13행)
        cell1_11.setAttribute('rowspan', '3');

        // 1열 셀 스타일에 중앙정렬 추가
        let cell1Style = cell1_11.getAttribute('style') || '';
        if (!cell1Style.includes('text-align')) {
          cell1Style += ';text-align:center;';
        } else {
          cell1Style = cell1Style.replace(/text-align[^;]*/gi, 'text-align:center');
        }
        cell1_11.setAttribute('style', cell1Style);

        // 텍스트 삽입: 경감/·/공제/세액 (줄바꿈)
        cell1_11.innerHTML = '<p class="s3" style="text-indent: 0pt;line-height: 110%;text-align: center;font-size: 9pt;">경감<br/>·<br/>공제<br/>세액</p>';

        // 12행~13행의 1열 셀 제거 (병합으로 인해)
        for (let r = 11; r < 13; r++) {
          const row = allRows[r];
          if (row) {
            const firstCell = row.querySelector('td:nth-child(1)');
            if (firstCell) {
              console.log('행 ' + (r + 1) + '의 1열 셀 제거');
              firstCell.remove();
            }
          }
        }

        console.log('11행~13행 1열 병합 및 텍스트 삽입 완료');
      }
    }

    // 11행 2열과 3열 병합 및 텍스트 삽입
    // 11행은 0-based index 10, 1열이 rowspan으로 병합되어 있지만 11행 자체의 1열 셀은 존재하므로 2열은 nth-child(2), 3열은 nth-child(3)
    const row11_merge = allRows[10];
    if (row11_merge) {
      const cell2 = row11_merge.querySelector('td:nth-child(2)'); // 2열
      const cell3 = row11_merge.querySelector('td:nth-child(3)'); // 3열

      if (cell2 && cell3) {
        // 2열 셀에 colspan="2" 추가
        cell2.setAttribute('colspan', '2');

        // 2열 셀 스타일에 너비 조정 및 좌측정렬 (2열+3열 너비 합산: 65+121 = 186pt)
        let cell2Style = cell2.getAttribute('style') || '';
        cell2Style = cell2Style.replace(/width:[^;]*/gi, '');
        cell2Style = cell2Style.replace(/text-align[^;]*/gi, '');
        cell2Style += 'width:186pt;text-align:left;';
        cell2.setAttribute('style', cell2Style);

        // 텍스트 삽입 (좌측정렬)
        cell2.innerHTML = '<p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">그 밖의 경감·공제세액</p>';

        // 3열 셀 제거
        cell3.remove();

        console.log('11행 2열과 3열 병합 및 텍스트 삽입 완료');
      }
    }

    // 12행 2열과 3열 병합 및 텍스트 삽입
    // 12행은 0-based index 11, 1열이 제거되어 있으므로 2열은 nth-child(1), 3열은 nth-child(2)
    const row12_merge = allRows[11];
    if (row12_merge) {
      const cell2 = row12_merge.querySelector('td:nth-child(1)'); // 2열
      const cell3 = row12_merge.querySelector('td:nth-child(2)'); // 3열

      if (cell2 && cell3) {
        // 2열 셀에 colspan="2" 추가
        cell2.setAttribute('colspan', '2');

        // 2열 셀 스타일에 너비 조정 및 좌측정렬 (2열+3열 너비 합산: 65+121 = 186pt)
        let cell2Style = cell2.getAttribute('style') || '';
        cell2Style = cell2Style.replace(/width:[^;]*/gi, '');
        cell2Style = cell2Style.replace(/text-align[^;]*/gi, '');
        cell2Style += 'width:186pt;text-align:left;';
        cell2.setAttribute('style', cell2Style);

        // 텍스트 삽입 (좌측정렬)
        cell2.innerHTML = '<p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">신용카드매출전표등 발행공제 등</p>';

        // 3열 셀 제거
        cell3.remove();

        console.log('12행 2열과 3열 병합 및 텍스트 삽입 완료');
      }
    }

    // 13행 2열과 3열 병합 및 텍스트 삽입
    // 13행은 0-based index 12, 1열이 제거되어 있으므로 2열은 nth-child(1), 3열은 nth-child(2)
    const row13_merge = allRows[12];
    if (row13_merge) {
      const cell2 = row13_merge.querySelector('td:nth-child(1)'); // 2열
      const cell3 = row13_merge.querySelector('td:nth-child(2)'); // 3열

      if (cell2 && cell3) {
        // 2열 셀에 colspan="2" 추가
        cell2.setAttribute('colspan', '2');

        // 2열 셀 스타일에 너비 조정 및 좌측정렬 (2열+3열 너비 합산: 65+121 = 186pt)
        let cell2Style = cell2.getAttribute('style') || '';
        cell2Style = cell2Style.replace(/width:[^;]*/gi, '');
        cell2Style = cell2Style.replace(/text-align[^;]*/gi, '');
        cell2Style += 'width:186pt;text-align:left;';
        cell2.setAttribute('style', cell2Style);

        // 텍스트 삽입 (좌측정렬)
        cell2.innerHTML = '<p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">합계</p>';

        // 3열 셀 제거
        cell3.remove();

        console.log('13행 2열과 3열 병합 및 텍스트 삽입 완료');
      }
    }

    // 11행~21행 4열에 번호 추가: (19)~(29)
    for (let r = 10; r < 21; r++) {
      const row = allRows[r];
      if (row) {
        let cell4;
        if (r === 10) {
          // 11행: 1열(rowspan), 2열(colspan=2), 4열은 nth-child(3) (1열, 병합된2열, 4열)
          cell4 = row.querySelector('td:nth-child(3)');
        } else if (r === 11 || r === 12) {
          // 12행, 13행: 1열 제거, 2열(colspan=2), 4열은 nth-child(2) (병합된2열, 4열)
          cell4 = row.querySelector('td:nth-child(2)');
        } else {
          // 14행~21행: 정상 구조, 4열은 nth-child(4)
          cell4 = row.querySelector('td:nth-child(4)');
        }

        if (cell4) {
          const number = 19 + (r - 10);
          cell4.innerHTML = '<p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">(' + number + ')</p>';
          console.log('행 ' + (r + 1) + ': 4열에 (' + number + ') 번호 삽입 완료');

          // (19) 번 오른쪽 옆의 셀(5열)에 배경색 추가 (11행만 여기서 처리)
          if (number === 19 && r === 10) {
            // 11행: 1열(rowspan), 2열(colspan=2), 4열은 nth-child(3), 5열은 nth-child(4)
            const cell5 = row.querySelector('td:nth-child(4)');
            if (cell5) {
              let cell5Style = cell5.getAttribute('style') || '';
              if (!cell5Style.includes('background-color:#C0C0C0') && !cell5Style.includes('background-color: #C0C0C0')) {
                cell5Style += 'background-color:#C0C0C0;';
                cell5.setAttribute('style', cell5Style);
                console.log('행 ' + (r + 1) + ': 5열에 배경색 추가 완료 (' + number + ')');
              }
            }
          }
        }
      }
    }

    // 13행~21행 6열에 원문자 라~타 삽입
    const circleTexts = ['㉱', '㉲', '㉳', '㉴', '㉵', '㉶', '㉷', '㉸', '㉹'];
    for (let r = 12; r < 21; r++) {
      const row = allRows[r];
      if (row) {
        let cell6;
        if (r === 12) {
          // 13행: 1열 제거, 2열(colspan=2), 6열은 nth-child(4) (병합된2열, 4열, 5열, 6열)
          cell6 = row.querySelector('td:nth-child(4)');
        } else {
          // 14행~21행: 정상 구조, 6열은 nth-child(6)
          cell6 = row.querySelector('td:nth-child(6)');
        }

        if (cell6) {
          const textIndex = r - 12;
          const circleText = circleTexts[textIndex];
          // 원문자 텍스트는 중앙 정렬되고 폰트 크기 10pt로 설정
          cell6.innerHTML = '<p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;font-size: 10pt;">' + circleText + '</p>';
          console.log('행 ' + (r + 1) + ': 6열에 원문자 \'' + circleText + '\' 텍스트 삽입 완료');
        }
      }
    }

    // 14행~21행 1~3열 병합 및 텍스트 삽입
    const rowTexts_14to21 = [
      '소규모 개인사업자 부가가치세 감면세액',      // 14행
      '예정신고 미환급세액',                        // 15행
      '예정고지세액',                              // 16행
      '수시부과세액',                              // 17행
      '사업양수자가 대리납부한 세액',                // 18행
      '매입자 납부특례에 따라 납부한 세액',          // 19행
      '신용카드업자가 대리납부한 세액',              // 20행
      '가산세액 계'                                // 21행
    ];

    for (let r = 13; r < 21; r++) {
      const row = allRows[r];
      if (row) {
        // 14행~21행은 정상 구조이므로 1열은 nth-child(1), 2열은 nth-child(2), 3열은 nth-child(3)
        const cell1 = row.querySelector('td:nth-child(1)');
        const cell2 = row.querySelector('td:nth-child(2)');
        const cell3 = row.querySelector('td:nth-child(3)');

        if (cell1 && cell2 && cell3) {
          // 1열 셀에 colspan="3" 추가
          cell1.setAttribute('colspan', '3');

          // 1열 셀 스타일에 너비 조정 및 좌측정렬 (1열+2열+3열 너비 합산: 40+65+121 = 226pt)
          let cell1Style = cell1.getAttribute('style') || '';
          cell1Style = cell1Style.replace(/width:[^;]*/gi, '');
          cell1Style = cell1Style.replace(/text-align[^;]*/gi, '');
          cell1Style += 'width:226pt;text-align:left;';
          cell1.setAttribute('style', cell1Style);

          // 텍스트 삽입 (좌측정렬)
          const textIndex = r - 13;
          cell1.innerHTML = '<p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">' + rowTexts_14to21[textIndex] + '</p>';

          // 2열과 3열 셀 제거
          cell2.remove();
          cell3.remove();

          console.log('행 ' + (r + 1) + ': 1~3열 병합 및 텍스트 삽입 완료');

          // (26), (27), (28) 번 오른쪽 옆의 셀(5열)에 배경색 추가 (1~3열 병합 후)
          // 18행=(26), 19행=(27), 20행=(28)
          if (r === 17 || r === 18 || r === 19) {
            // 1~3열 병합 후 구조: 1열(colspan=3), 4열, 5열, 6열, 7열
            // 따라서 5열은 nth-child(3)
            const cell5 = row.querySelector('td:nth-child(3)');
            if (cell5) {
              let cell5Style = cell5.getAttribute('style') || '';
              if (!cell5Style.includes('background-color:#C0C0C0') && !cell5Style.includes('background-color: #C0C0C0')) {
                cell5Style += 'background-color:#C0C0C0;';
                cell5.setAttribute('style', cell5Style);
                const number = 19 + (r - 10); // 실제 번호 계산
                console.log('행 ' + (r + 1) + ': 5열에 배경색 추가 완료 (' + number + ') - 병합 후');
              }
            }
          }
        }
      }
    }

    // 22행 1~5열 병합 및 텍스트 삽입
    // 22행은 0-based index 21, 정상 구조이므로 1열은 nth-child(1), 2열은 nth-child(2), 3열은 nth-child(3), 4열은 nth-child(4), 5열은 nth-child(5)
    const row22 = allRows[21];
    if (row22) {
      const cell1 = row22.querySelector('td:nth-child(1)');
      const cell2 = row22.querySelector('td:nth-child(2)');
      const cell3 = row22.querySelector('td:nth-child(3)');
      const cell4 = row22.querySelector('td:nth-child(4)');
      const cell5 = row22.querySelector('td:nth-child(5)');

      if (cell1 && cell2 && cell3 && cell4 && cell5) {
        // 1열 셀에 colspan="5" 추가
        cell1.setAttribute('colspan', '5');

        // 1열 셀 스타일에 너비 조정 및 좌측정렬 (1열+2열+3열+4열+5열 너비 합산: 40+65+121+25+161 = 412pt)
        let cell1Style = cell1.getAttribute('style') || '';
        cell1Style = cell1Style.replace(/width:[^;]*/gi, '');
        cell1Style = cell1Style.replace(/text-align[^;]*/gi, '');
        cell1Style += 'width:412pt;text-align:left;';
        cell1.setAttribute('style', cell1Style);

        // 텍스트 삽입 (좌측정렬)
        cell1.innerHTML = '<p class="s3" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">차감ㆍ가감하여 납부할 세액(환급받을 세액)(㉰-㉱-㉲-㉳-㉴-㉵-㉶-㉷+㉸)</p>';

        // 2열~5열 셀 제거
        cell2.remove();
        cell3.remove();
        cell4.remove();
        cell5.remove();

        console.log('22행 1~5열 병합 및 텍스트 삽입 완료');

        // 22행 6열에 (30) 번호 삽입 (1~5열 병합 후 6열은 nth-child(2))
        const cell6 = row22.querySelector('td:nth-child(2)');
        if (cell6) {
          cell6.innerHTML = '<p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">(30)</p>';
          console.log('22행 6열에 (30) 번호 삽입 완료');
        }
      }
    }

    // 23행 1~6열 병합 및 텍스트 삽입
    // 23행은 0-based index 22, 정상 구조이므로 1열은 nth-child(1), 2열은 nth-child(2), ..., 6열은 nth-child(6)
    const row23 = allRows[22];
    if (row23) {
      const cell1 = row23.querySelector('td:nth-child(1)');
      const cell2 = row23.querySelector('td:nth-child(2)');
      const cell3 = row23.querySelector('td:nth-child(3)');
      const cell4 = row23.querySelector('td:nth-child(4)');
      const cell5 = row23.querySelector('td:nth-child(5)');
      const cell6 = row23.querySelector('td:nth-child(6)');

      if (cell1 && cell2 && cell3 && cell4 && cell5 && cell6) {
        // 1열 셀에 colspan="6" 추가
        cell1.setAttribute('colspan', '6');

        // 1열 셀 스타일에 너비 조정 및 좌측정렬 (1열+2열+3열+4열+5열+6열 너비 합산: 40+65+121+25+161+40 = 452pt)
        let cell1Style = cell1.getAttribute('style') || '';
        cell1Style = cell1Style.replace(/width:[^;]*/gi, '');
        cell1Style = cell1Style.replace(/text-align[^;]*/gi, '');
        cell1Style += 'width:452pt;text-align:left;';
        cell1.setAttribute('style', cell1Style);

        // 텍스트 삽입 (좌측정렬)
        cell1.innerHTML = '<p class="s6" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: center;">총괄 납부 사업자가 납부할 세액 (환급받을 세액)</p>';

        // 2열~6열 셀 제거
        cell2.remove();
        cell3.remove();
        cell4.remove();
        cell5.remove();
        cell6.remove();

        console.log('23행 1~6열 병합 및 텍스트 삽입 완료');
      }
    }

    // 매입세액 테이블 위에 삽입
    purchaseTaxTable.parentNode.insertBefore(newTable, purchaseTaxTable);

    newPurchaseTaxTableCreated = true;
    console.log('매입세액 테이블 위에 7열 23행 새 테이블 생성 완료');

    // 기존 매입세액 테이블 삭제
    purchaseTaxTable.remove();
    console.log('기존 매입세액 테이블 삭제 완료');

    // 매입세액 테이블 바로 아래에 새 테이블 추가
    createTableBelowPurchaseTax(newTable);
  }

  // 매입세액 테이블 바로 아래에 5열 1행 테이블 추가
  function createTableBelowPurchaseTax(purchaseTaxTable) {
    // 매입세액 테이블의 margin-bottom을 2pt로 설정
    if (purchaseTaxTable) {
      let tableStyle = purchaseTaxTable.getAttribute('style') || '';
      // 기존 margin-bottom 제거
      tableStyle = tableStyle.replace(/margin-bottom[^;]*/gi, '');
      // margin-bottom: 2pt 추가
      if (tableStyle && !tableStyle.endsWith(';') && tableStyle.trim() !== '') {
        tableStyle += ';';
      }
      tableStyle += 'margin-bottom:2pt;';
      purchaseTaxTable.setAttribute('style', tableStyle);
    }

    // 새 테이블 생성
    const newTable = document.createElement('table');
    newTable.setAttribute('class', 'below-purchase-tax-table');
    newTable.setAttribute('style', 'width:624pt;border-collapse:collapse;margin:0;margin-top:0;table-layout:fixed;box-sizing:border-box;');
    newTable.setAttribute('cellspacing', '0');

    // 1행 생성
    const newRow = document.createElement('tr');
    newRow.setAttribute('style', 'height:20pt');

    // 5열 생성 (열 폭: 1열 147pt, 2열 92pt, 3열 162pt, 4열 82pt, 5열 141pt) - 총 624pt
    const columnWidths = [147, 92, 162, 82, 141];

    console.log('5열 테이블 생성 시작, 열 폭:', columnWidths);

    for (let c = 0; c < 5; c++) {
      const newCell = document.createElement('td');

      // 셀 스타일 설정
      let cellStyle = 'vertical-align:middle;width:' + columnWidths[c] + 'pt;';

      // 상하 테두리: 검정
      cellStyle += 'border-top:1pt solid #000;';
      cellStyle += 'border-bottom:1pt solid #000;';

      // 좌우 테두리: 첫 번째 열과 마지막 열은 없음, 중간 열은 좌측만 #7E7E7E
      // c가 1, 2, 3, 4일 때 좌측 테두리 추가 (첫 번째 열 제외)
      if (c > 0) {
        cellStyle += 'border-left:1pt solid #7E7E7E;';
      }
      // 첫 번째 열과 마지막 열의 좌우 테두리 없음
      if (c === 0) {
        cellStyle += 'border-left:none;';
      }
      if (c === 4) {
        cellStyle += 'border-right:none;';
      }

      // 셀별 내용 설정
      if (c === 0) {
        // 1열: '② 국세환급금 계좌신고' 텍스트 (s3 폰트, 폰트 크기 11pt, 좌측 3pt 간격, 좌측정렬, '국세환급금 계좌신고'만 볼드)
        cellStyle += 'position:relative;padding:0;';
        newCell.setAttribute('style', cellStyle);
        newCell.innerHTML = '<p class="s3" style="padding-left: 3pt;text-indent: 0pt;line-height: 11pt;font-size: 11pt;text-align: left;">② <b>국세환급금 계좌신고</b></p>';
      } else if (c === 1) {
        // 2열: '거래은행' (본문 일반 폰트, 중앙맞춤)
        cellStyle += 'position:relative;padding:0;';
        newCell.setAttribute('style', cellStyle);
        newCell.innerHTML = '<p style="text-indent: 0pt;line-height: 9pt;text-align: center;">거래은행</p>';
      } else if (c === 2) {
        // 3열: [5자 텍스트 입력박스]은행 [5자 텍스트 입력박스]지점
        cellStyle += 'position:relative;padding:0;';
        newCell.setAttribute('style', cellStyle);

        // 입력박스와 텍스트를 포함한 구조 생성
        const input1 = document.createElement('input');
        input1.type = 'text';
        input1.className = 'text-input';
        input1.maxLength = 5;
        input1.style.position = 'absolute';
        input1.style.left = '0';
        input1.style.top = '0';
        input1.style.width = '50pt';
        input1.style.height = '100%';
        input1.style.border = 'none';
        input1.style.background = 'transparent';
        input1.style.fontSize = '9pt';
        input1.style.fontFamily = '돋움체, monospace';
        input1.style.textAlign = 'center';
        input1.style.outline = 'none';
        input1.style.padding = '0';
        input1.style.margin = '0';
        input1.style.boxSizing = 'border-box';

        const text1 = document.createElement('p');
        text1.style.position = 'absolute';
        text1.style.left = '55pt';
        text1.style.top = '0';
        text1.style.margin = '0';
        text1.style.padding = '0';
        text1.style.textIndent = '0';
        text1.style.lineHeight = '20pt';
        text1.style.textAlign = 'center';
        text1.style.fontSize = '9pt';
        text1.style.fontFamily = '돋움체, monospace';
        text1.textContent = '은행';

        const input2 = document.createElement('input');
        input2.type = 'text';
        input2.className = 'text-input';
        input2.maxLength = 5;
        input2.style.position = 'absolute';
        input2.style.left = '80pt';
        input2.style.top = '0';
        input2.style.width = '50pt';
        input2.style.height = '100%';
        input2.style.border = 'none';
        input2.style.background = 'transparent';
        input2.style.fontSize = '9pt';
        input2.style.fontFamily = '돋움체, monospace';
        input2.style.textAlign = 'center';
        input2.style.outline = 'none';
        input2.style.padding = '0';
        input2.style.margin = '0';
        input2.style.boxSizing = 'border-box';

        const text2 = document.createElement('p');
        text2.style.position = 'absolute';
        text2.style.left = '135pt';
        text2.style.top = '0';
        text2.style.margin = '0';
        text2.style.padding = '0';
        text2.style.textIndent = '0';
        text2.style.lineHeight = '20pt';
        text2.style.textAlign = 'center';
        text2.style.fontSize = '9pt';
        text2.style.fontFamily = '돋움체, monospace';
        text2.textContent = '지점';

        newCell.appendChild(input1);
        newCell.appendChild(text1);
        newCell.appendChild(input2);
        newCell.appendChild(text2);
      } else if (c === 3) {
        // 4열: '계좌번호'
        cellStyle += 'position:relative;padding:0;';
        newCell.setAttribute('style', cellStyle);
        newCell.innerHTML = '<p style="text-indent: 0pt;line-height: 9pt;text-align: center;">계좌번호</p>';
      } else if (c === 4) {
        // 5열: 다른 테이블과 동일 유형의 입력박스
        cellStyle += 'position:relative;padding:0;';
        newCell.setAttribute('style', cellStyle);

        const input = document.createElement('input');
        input.type = 'text';
        input.className = 'text-input';
        input.style.position = 'absolute';
        input.style.top = '0';
        input.style.left = '0';
        input.style.right = '0';
        input.style.bottom = '0';
        input.style.width = '100%';
        input.style.height = '100%';
        input.style.border = 'none';
        input.style.background = 'transparent';
        input.style.fontSize = '8pt';
        input.style.fontFamily = 'Arial, sans-serif';
        input.style.textAlign = 'center';
        input.style.paddingRight = '0';
        input.style.outline = 'none';
        input.style.padding = '0';
        input.style.margin = '0';
        input.style.boxSizing = 'border-box';

        newCell.innerHTML = '';
        newCell.appendChild(input);
      }

      newRow.appendChild(newCell);
      console.log('열 ' + (c + 1) + ' 생성 완료, 너비: ' + columnWidths[c] + 'pt');
    }

    newTable.appendChild(newRow);

    // 매입세액 테이블 바로 아래에 삽입 (2pt 간격)
    if (purchaseTaxTable && purchaseTaxTable.parentNode) {
      purchaseTaxTable.parentNode.insertBefore(newTable, purchaseTaxTable.nextSibling);
      console.log('매입세액 테이블 바로 아래에 5열 1행 테이블 추가 완료');

      // '② 국세환급금 계좌신고' 테이블 바로 아래에 4열 테이블 추가
      createTableBelowAccountReport(newTable);
    } else {
      console.log('매입세액 테이블을 찾을 수 없어 새 테이블을 추가할 수 없습니다.');
    }

  }

  // '② 국세환급금 계좌신고' 테이블 바로 아래에 4열 테이블 추가
  function createTableBelowAccountReport(accountReportTable) {
    // 위 테이블의 margin-bottom을 2pt로 설정
    if (accountReportTable) {
      let tableStyle = accountReportTable.getAttribute('style') || '';
      // 기존 margin-bottom 제거
      tableStyle = tableStyle.replace(/margin-bottom[^;]*/gi, '');
      // margin-bottom: 2pt 추가
      if (tableStyle && !tableStyle.endsWith(';') && tableStyle.trim() !== '') {
        tableStyle += ';';
      }
      tableStyle += 'margin-bottom:2pt;';
      accountReportTable.setAttribute('style', tableStyle);
    }

    // 새 테이블 생성
    const newTable = document.createElement('table');
    newTable.setAttribute('class', 'below-account-report-table');
    newTable.setAttribute('style', 'width:624pt;border-collapse:collapse;margin:0;margin-top:0;table-layout:fixed;box-sizing:border-box;');
    newTable.setAttribute('cellspacing', '0');

    // 1행 생성
    const newRow = document.createElement('tr');
    newRow.setAttribute('style', 'height:20pt');

    // 5열 생성 (1열: 150pt 고정, 나머지 4열: 각 118.5pt - 총 624pt)
    const columnWidths = [150, 118, 119, 118, 119];

    for (let c = 0; c < 5; c++) {
      const newCell = document.createElement('td');

      // 셀 스타일 설정
      let cellStyle = 'vertical-align:middle;width:' + columnWidths[c] + 'pt;';

      // 상하 테두리: 검정
      cellStyle += 'border-top:1pt solid #000;';
      cellStyle += 'border-bottom:1pt solid #000;';

      // 좌우 테두리: 첫 번째 열과 마지막 열은 없음, 중간 열은 좌측만 #7E7E7E
      if (c > 0) {
        cellStyle += 'border-left:1pt solid #7E7E7E;';
      }
      // 첫 번째 열과 마지막 열의 좌우 테두리 없음
      if (c === 0) {
        cellStyle += 'border-left:none;';
      }
      if (c === 4) {
        cellStyle += 'border-right:none;';
      }

      // 셀별 내용 설정
      if (c === 0) {
        // 1열: '③ 폐업신고' 텍스트 (s3 폰트, 폰트 크기 10pt, 좌측 3pt 간격, 좌측정렬)
        cellStyle += 'position:relative;padding:0;';
        newCell.setAttribute('style', cellStyle);
        newCell.innerHTML = '<p class="s3" style="padding-left: 3pt;text-indent: 0pt;line-height: 10pt;font-size: 10pt;text-align: left;">③ <b>폐업신고</b></p>';
      } else if (c === 1) {
        // 2열: '폐업일' (본문 텍스트, 중앙맞춤)
        cellStyle += 'position:relative;padding:0;';
        newCell.setAttribute('style', cellStyle);
        newCell.innerHTML = '<p style="text-indent: 0pt;line-height: 9pt;text-align: center;">폐업일</p>';
      } else if (c === 2) {
        // 3열: 입력박스
        cellStyle += 'position:relative;padding:0;';
        newCell.setAttribute('style', cellStyle);

        const input = document.createElement('input');
        input.type = 'text';
        input.className = 'text-input';
        input.style.position = 'absolute';
        input.style.top = '0';
        input.style.left = '0';
        input.style.right = '0';
        input.style.bottom = '0';
        input.style.width = '100%';
        input.style.height = '100%';
        input.style.border = 'none';
        input.style.background = 'transparent';
        input.style.fontSize = '8pt';
        input.style.fontFamily = 'Arial, sans-serif';
        input.style.textAlign = 'center';
        input.style.outline = 'none';
        input.style.padding = '0';
        input.style.margin = '0';
        input.style.boxSizing = 'border-box';

        newCell.innerHTML = '';
        newCell.appendChild(input);
      } else if (c === 3) {
        // 4열: '폐업사유' (본문 텍스트, 중앙맞춤)
        cellStyle += 'position:relative;padding:0;';
        newCell.setAttribute('style', cellStyle);
        newCell.innerHTML = '<p style="text-indent: 0pt;line-height: 9pt;text-align: center;">폐업사유</p>';
      } else if (c === 4) {
        // 5열: 입력박스
        cellStyle += 'position:relative;padding:0;';
        newCell.setAttribute('style', cellStyle);

        const input = document.createElement('input');
        input.type = 'text';
        input.className = 'text-input';
        input.style.position = 'absolute';
        input.style.top = '0';
        input.style.left = '0';
        input.style.right = '0';
        input.style.bottom = '0';
        input.style.width = '100%';
        input.style.height = '100%';
        input.style.border = 'none';
        input.style.background = 'transparent';
        input.style.fontSize = '8pt';
        input.style.fontFamily = 'Arial, sans-serif';
        input.style.textAlign = 'center';
        input.style.outline = 'none';
        input.style.padding = '0';
        input.style.margin = '0';
        input.style.boxSizing = 'border-box';

        newCell.innerHTML = '';
        newCell.appendChild(input);
      } else {
        cellStyle += 'position:relative;padding:0;';
        newCell.setAttribute('style', cellStyle);
        newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
      }

      newRow.appendChild(newCell);
    }

    newTable.appendChild(newRow);

    // '② 국세환급금 계좌신고' 테이블 바로 아래에 삽입 (2pt 간격)
    if (accountReportTable && accountReportTable.parentNode) {
      accountReportTable.parentNode.insertBefore(newTable, accountReportTable.nextSibling);
      console.log('② 국세환급금 계좌신고 테이블 바로 아래에 5열 1행 테이블 추가 완료');
    } else {
      console.log('② 국세환급금 계좌신고 테이블을 찾을 수 없어 새 테이블을 추가할 수 없습니다.');
    }

    // 테이블 생성 직후 5열 2행의 입력박스 제거 (입력박스가 추가되기 전에 미리 제거)
    setTimeout(function() {
      const allRows = newTable.querySelectorAll('tr');
      if (allRows.length > 1) {
        const row2 = allRows[1]; // 2행 (0-based index: 1)
        const cells = row2.querySelectorAll('td');
        let actualColIndex = 0;

        cells.forEach(function(cell) {
          const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);
          const startCol = actualColIndex + 1; // 1-based
          const endCol = actualColIndex + colspan;

          // 5열인지 확인 (정확히 5열인 경우만: startCol이 5이고 colspan이 1)
          if (startCol === 5 && colspan === 1) {
            const input = cell.querySelector('input');
            if (input) {
              input.remove();
              cell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
              console.log('createNewPurchaseTaxTable: 5열 2행의 입력박스 제거 완료 (startCol=' + startCol + ', colspan=' + colspan + ')');
            }
          }

          actualColIndex += colspan;
        });
      }
    }, 50);
  }

  // 매입세액 테이블의 5열 특정 행에 배경색 추가 및 입력박스 제거 (비활성화됨)
  /*function setBackgroundColorForColumn5() {
    const purchaseTaxTable = document.querySelector('table.new-purchase-tax-table');
    if (!purchaseTaxTable) {
      return;
    }

    const allRows = purchaseTaxTable.querySelectorAll('tr');
    const targetRows = [10, 17, 18, 19]; // 0-based index: 11행=10, 18행=17, 19행=18, 20행=19
    // 2행은 이미 배경색이 있으므로 제외 (입력박스만 제거하면 됨)

    targetRows.forEach(function(rowIdx) {
      if (allRows.length > rowIdx) {
        const row = allRows[rowIdx];
        const cells = row.querySelectorAll('td');
        let actualColIndex = 0;

        cells.forEach(function(cell) {
          const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);
          const startCol = actualColIndex + 1; // 1-based
          const endCol = actualColIndex + colspan;

          // 5열인지 확인 (정확히 5열인 경우만: startCol이 5이고 colspan이 1)
          const isColumn5 = (startCol === 5 && colspan === 1);

          if (isColumn5) {
            console.log('행' + (rowIdx + 1) + ', 5열 찾음: startCol=' + startCol + ', endCol=' + endCol + ', colspan=' + colspan);
            // 배경색 추가 (이미 있으면 스킵)
            let cellStyle = cell.getAttribute('style') || '';
            if (!cellStyle.includes('background-color:#C0C0C0') && !cellStyle.includes('background-color: #C0C0C0')) {
              cellStyle += 'background-color:#C0C0C0;';
              cell.setAttribute('style', cellStyle);
            }

            // 입력박스 제거
            const input = cell.querySelector('input');
            if (input) {
              input.remove();
              cell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
            }
          }

          actualColIndex += colspan;
        });
      }
    });
  }*/

  // 매입세액 테이블의 빈 셀에 입력박스 추가 (6열 제외)
  function addInputBoxesToPurchaseTaxTable() {
    const purchaseTaxTable = document.querySelector('table.new-purchase-tax-table');
    if (!purchaseTaxTable) {
      setTimeout(addInputBoxesToPurchaseTaxTable, 100);
      return;
    }

    const allRows = purchaseTaxTable.querySelectorAll('tr');
    let addedCount = 0;
    let removedCount = 0;

    // 먼저 5열 2행의 입력박스 제거 (정확히 5열만)
    if (allRows.length > 1) {
      const row2 = allRows[1]; // 2행 (0-based index: 1)
      const cells = row2.querySelectorAll('td');
      let actualColIndex = 0;

      cells.forEach(function(cell) {
        const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);
        const startCol = actualColIndex + 1; // 1-based
        const endCol = actualColIndex + colspan;

        // 5열인지 확인 (정확히 5열인 경우만: startCol이 5이고 colspan이 1)
        if (startCol === 5 && colspan === 1) {
          const input = cell.querySelector('input');
          if (input) {
            input.remove();
            cell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
            removedCount++;
            console.log('5열 2행의 입력박스 제거 완료 (startCol=' + startCol + ', colspan=' + colspan + ')');
          }
        }

        actualColIndex += colspan;
      });
    }

    // 먼저 6열의 특정 행에서 입력박스 제거 (2행~8행, 12행)
    // 병합을 고려하지 않고 실제 열 번호(1열, 2열, 3열...)로 인식
    // 7열은 제외 (7열은 무조건 입력박스가 있어야 함)
    const rowsToRemoveInput = [1, 2, 3, 4, 5, 6, 7, 11]; // 0-based index: 2행~8행, 12행

    rowsToRemoveInput.forEach(function(rowIndex) {
      if (allRows.length > rowIndex) {
        const row = allRows[rowIndex];
        const cells = row.querySelectorAll('td');
        let actualColIndex = 0;

        cells.forEach(function(cell) {
          const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);
          const startCol = actualColIndex + 1; // 1-based 열 번호
          const endCol = actualColIndex + colspan;

          // 실제 6열인지 확인 (6열이 이 셀의 범위에 포함되는지)
          // 7열은 제외 (7열은 무조건 입력박스가 있어야 함)
          if (startCol <= 6 && 6 <= endCol && !(startCol <= 7 && 7 <= endCol)) {
            const input = cell.querySelector('input');
            if (input) {
              input.remove();
              removedCount++;
              console.log('행' + (rowIndex + 1) + ', 실제 6열(열 ' + startCol + '~' + endCol + ')의 입력박스 제거');
            }
          }

          actualColIndex += colspan;
        });
      }
    });

    // 2행에서 "(11)" 다음의 바닥 색이 있는 셀 입력박스 제거, 색이 있는 열 바로 다음 열의 입력박스 제거 (먼저 실행)
    if (allRows.length > 1) {
      const row2 = allRows[1]; // 2행 (0-based index: 1) - "(11)"이 있는 행

      if (row2) {
        const cells2 = Array.from(row2.querySelectorAll('td'));

        // "(11)" 텍스트가 있는 셀 찾기
        let marker11CellIndex = -1;
        cells2.forEach(function(cell, idx) {
          const cellText = cell.textContent.trim();
          if (cellText.includes('(11)')) {
            marker11CellIndex = idx;
          }
        });

        if (marker11CellIndex >= 0) {
          // "(11)" 다음 셀 = 인덱스 + 1 (배경색이 있는 셀)
          const coloredCellIndex = marker11CellIndex + 1;

          if (coloredCellIndex < cells2.length) {
            const coloredCell = cells2[coloredCellIndex];
            const cellStyle = coloredCell.getAttribute('style') || '';

            // 배경색이 있는지 확인 (#C0C0C0)
            if (cellStyle.includes('background-color:#C0C0C0') || cellStyle.includes('background-color: #C0C0C0')) {
              // 배경색이 있는 셀의 입력박스 제거
              const input1 = coloredCell.querySelector('input');
              if (input1) {
                input1.remove();
                coloredCell.setAttribute('data-input-removed', 'true');
                coloredCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
                removedCount++;
                console.log('2행의 ' + (coloredCellIndex + 1) + '열((11) 다음의 배경색이 있는 셀) 입력박스 제거 완료');
              } else {
                coloredCell.setAttribute('data-input-removed', 'true');
                console.log('2행의 ' + (coloredCellIndex + 1) + '열에 입력박스가 없지만 마커 추가 완료');
              }

              // 배경색이 있는 열 바로 다음 열의 입력박스 제거
              const nextCellIndex = coloredCellIndex + 1;
              if (nextCellIndex < cells2.length) {
                const nextCell = cells2[nextCellIndex];
                const input2 = nextCell.querySelector('input');
                if (input2) {
                  input2.remove();
                  nextCell.setAttribute('data-input-removed', 'true');
                  nextCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
                  removedCount++;
                  console.log('2행의 ' + (nextCellIndex + 1) + '열(배경색이 있는 열(' + (coloredCellIndex + 1) + '열) 바로 다음 열) 입력박스 제거 완료');
                } else {
                  nextCell.setAttribute('data-input-removed', 'true');
                  console.log('2행의 ' + (nextCellIndex + 1) + '열에 입력박스가 없지만 마커 추가 완료');
                }
              } else {
                console.log('2행: 배경색이 있는 열(' + (coloredCellIndex + 1) + '열) 바로 다음 열(' + (nextCellIndex + 1) + '열)이 범위를 벗어났습니다. (셀 개수: ' + cells2.length + ')');
              }
            } else {
              console.log('2행: (11) 다음 셀(' + (coloredCellIndex + 1) + '열)에 배경색이 없습니다.');
            }
          } else {
            console.log('2행: (11)가 있는 열(' + (marker11CellIndex + 1) + '열)의 다음 열(' + (coloredCellIndex + 1) + '열)이 범위를 벗어났습니다. (셀 개수: ' + cells2.length + ')');
          }
        } else {
          console.log('2행에서 "(11)" 텍스트를 찾을 수 없습니다.');
        }
      }
    }

    // "(12)"가 있는 열의 다음다음 열에 있는 입력박스 제거 (먼저 실행)
    if (allRows.length > 2) {
      const row3 = allRows[2]; // 3행 (0-based index: 2) - "(12)"가 있는 행

      if (row3) {
        const cells3 = Array.from(row3.querySelectorAll('td'));

        // "(12)" 텍스트가 있는 셀 찾기
        let marker12CellIndex = -1;
        cells3.forEach(function(cell, idx) {
          const cellText = cell.textContent.trim();
          if (cellText.includes('(12)')) {
            marker12CellIndex = idx;
          }
        });

        if (marker12CellIndex >= 0) {
          // 다음다음 열 = 인덱스 + 2
          const targetCellIndex = marker12CellIndex + 2;

          if (targetCellIndex < cells3.length) {
            const targetCell = cells3[targetCellIndex];
            const input = targetCell.querySelector('input');
            if (input) {
              input.remove();
              targetCell.setAttribute('data-input-removed', 'true');
              targetCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
              removedCount++;
              console.log('3행의 ' + (targetCellIndex + 1) + '열((12)가 있는 열(' + (marker12CellIndex + 1) + '열)의 다음다음 열) 입력박스 제거 완료');
            } else {
              targetCell.setAttribute('data-input-removed', 'true');
              console.log('3행의 ' + (targetCellIndex + 1) + '열에 입력박스가 없지만 마커 추가 완료');
            }
          } else {
            console.log('3행: (12)가 있는 열(' + (marker12CellIndex + 1) + '열)의 다음다음 열(' + (targetCellIndex + 1) + '열)이 범위를 벗어났습니다. (셀 개수: ' + cells3.length + ')');
          }
        } else {
          console.log('3행에서 "(12)" 텍스트를 찾을 수 없습니다.');
        }
      }
    }

    // "(13)"이 있는 열의 다음다음 열에 있는 입력박스 제거 (먼저 실행)
    if (allRows.length > 3) {
      const row4 = allRows[3]; // 4행 (0-based index: 3) - "(13)"이 있는 행

      if (row4) {
        const cells4 = Array.from(row4.querySelectorAll('td'));

        // "(13)" 텍스트가 있는 셀 찾기
        let marker13CellIndex = -1;
        cells4.forEach(function(cell, idx) {
          const cellText = cell.textContent.trim();
          if (cellText.includes('(13)')) {
            marker13CellIndex = idx;
          }
        });

        if (marker13CellIndex >= 0) {
          // 다음다음 열 = 인덱스 + 2
          const targetCellIndex = marker13CellIndex + 2;

          if (targetCellIndex < cells4.length) {
            const targetCell = cells4[targetCellIndex];
            const input = targetCell.querySelector('input');
            if (input) {
              input.remove();
              targetCell.setAttribute('data-input-removed', 'true');
              targetCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
              removedCount++;
              console.log('4행의 ' + (targetCellIndex + 1) + '열((13)이 있는 열(' + (marker13CellIndex + 1) + '열)의 다음다음 열) 입력박스 제거 완료');
            } else {
              targetCell.setAttribute('data-input-removed', 'true');
              console.log('4행의 ' + (targetCellIndex + 1) + '열에 입력박스가 없지만 마커 추가 완료');
            }
          } else {
            console.log('4행: (13)이 있는 열(' + (marker13CellIndex + 1) + '열)의 다음다음 열(' + (targetCellIndex + 1) + '열)이 범위를 벗어났습니다. (셀 개수: ' + cells4.length + ')');
          }
        } else {
          console.log('4행에서 "(13)" 텍스트를 찾을 수 없습니다.');
        }
      }
    }

    // "(14)"가 있는 열의 다음다음 열에 있는 입력박스 제거 (먼저 실행)
    if (allRows.length > 4) {
      const row5 = allRows[4]; // 5행 (0-based index: 4) - "(14)"가 있는 행

      if (row5) {
        const cells5 = Array.from(row5.querySelectorAll('td'));

        // "(14)" 텍스트가 있는 셀 찾기
        let marker14CellIndex = -1;
        cells5.forEach(function(cell, idx) {
          const cellText = cell.textContent.trim();
          if (cellText.includes('(14)')) {
            marker14CellIndex = idx;
          }
        });

        if (marker14CellIndex >= 0) {
          // 다음다음 열 = 인덱스 + 2
          const targetCellIndex = marker14CellIndex + 2;

          if (targetCellIndex < cells5.length) {
            const targetCell = cells5[targetCellIndex];
            const input = targetCell.querySelector('input');
            if (input) {
              input.remove();
              targetCell.setAttribute('data-input-removed', 'true');
              targetCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
              removedCount++;
              console.log('5행의 ' + (targetCellIndex + 1) + '열((14)가 있는 열(' + (marker14CellIndex + 1) + '열)의 다음다음 열) 입력박스 제거 완료');
            } else {
              targetCell.setAttribute('data-input-removed', 'true');
              console.log('5행의 ' + (targetCellIndex + 1) + '열에 입력박스가 없지만 마커 추가 완료');
            }
          } else {
            console.log('5행: (14)가 있는 열(' + (marker14CellIndex + 1) + '열)의 다음다음 열(' + (targetCellIndex + 1) + '열)이 범위를 벗어났습니다. (셀 개수: ' + cells5.length + ')');
          }
        } else {
          console.log('5행에서 "(14)" 텍스트를 찾을 수 없습니다.');
        }
      }
    }

    // "(15)"가 있는 열의 다음다음 열에 있는 입력박스 제거 (먼저 실행)
    if (allRows.length > 5) {
      const row6 = allRows[5]; // 6행 (0-based index: 5) - "(15)"가 있는 행

      if (row6) {
        const cells6 = Array.from(row6.querySelectorAll('td'));

        // "(15)" 텍스트가 있는 셀 찾기
        let marker15CellIndex = -1;
        cells6.forEach(function(cell, idx) {
          const cellText = cell.textContent.trim();
          if (cellText.includes('(15)')) {
            marker15CellIndex = idx;
          }
        });

        if (marker15CellIndex >= 0) {
          // 다음다음 열 = 인덱스 + 2
          const targetCellIndex = marker15CellIndex + 2;

          if (targetCellIndex < cells6.length) {
            const targetCell = cells6[targetCellIndex];
            const input = targetCell.querySelector('input');
            if (input) {
              input.remove();
              targetCell.setAttribute('data-input-removed', 'true');
              targetCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
              removedCount++;
              console.log('6행의 ' + (targetCellIndex + 1) + '열((15)가 있는 열(' + (marker15CellIndex + 1) + '열)의 다음다음 열) 입력박스 제거 완료');
            } else {
              targetCell.setAttribute('data-input-removed', 'true');
              console.log('6행의 ' + (targetCellIndex + 1) + '열에 입력박스가 없지만 마커 추가 완료');
            }
          } else {
            console.log('6행: (15)가 있는 열(' + (marker15CellIndex + 1) + '열)의 다음다음 열(' + (targetCellIndex + 1) + '열)이 범위를 벗어났습니다. (셀 개수: ' + cells6.length + ')');
          }
        } else {
          console.log('6행에서 "(15)" 텍스트를 찾을 수 없습니다.');
        }
      }
    }

    // "(16)"가 있는 열의 다음다음 열에 있는 입력박스 제거 (먼저 실행)
    if (allRows.length > 6) {
      const row7 = allRows[6]; // 7행 (0-based index: 6) - "(16)"가 있는 행

      if (row7) {
        const cells7 = Array.from(row7.querySelectorAll('td'));

        // "(16)" 텍스트가 있는 셀 찾기
        let marker16CellIndex = -1;
        cells7.forEach(function(cell, idx) {
          const cellText = cell.textContent.trim();
          if (cellText.includes('(16)')) {
            marker16CellIndex = idx;
          }
        });

        if (marker16CellIndex >= 0) {
          // 다음다음 열 = 인덱스 + 2
          const targetCellIndex = marker16CellIndex + 2;

          if (targetCellIndex < cells7.length) {
            const targetCell = cells7[targetCellIndex];
            const input = targetCell.querySelector('input');
            if (input) {
              input.remove();
              targetCell.setAttribute('data-input-removed', 'true');
              targetCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
              removedCount++;
              console.log('7행의 ' + (targetCellIndex + 1) + '열((16)가 있는 열(' + (marker16CellIndex + 1) + '열)의 다음다음 열) 입력박스 제거 완료');
            } else {
              targetCell.setAttribute('data-input-removed', 'true');
              console.log('7행의 ' + (targetCellIndex + 1) + '열에 입력박스가 없지만 마커 추가 완료');
            }
          } else {
            console.log('7행: (16)가 있는 열(' + (marker16CellIndex + 1) + '열)의 다음다음 열(' + (targetCellIndex + 1) + '열)이 범위를 벗어났습니다. (셀 개수: ' + cells7.length + ')');
          }
        } else {
          console.log('7행에서 "(16)" 텍스트를 찾을 수 없습니다.');
        }
      }
    }

    // "㉯"가 있는 열의 바로 위 행(8행)부터 같은 열의 입력박스 7개 제거 (먼저 실행)
    if (allRows.length > 8) {
      const row9 = allRows[8]; // 9행 (0-based index: 8) - "㉯"가 있는 행

      if (row9) {
        const cells9 = Array.from(row9.querySelectorAll('td'));

        // "㉯" 텍스트가 있는 셀 찾기
        let circleCellIndex = -1;
        cells9.forEach(function(cell, idx) {
          const cellText = cell.textContent.trim();
          if (cellText.includes('㉯')) {
            circleCellIndex = idx;
          }
        });

        if (circleCellIndex >= 0) {
          // 8행부터 14행까지 (총 7개 행)의 같은 열에서 입력박스 제거
          const startRowIndex = 7; // 8행 (0-based index: 7)
          const endRowIndex = 13; // 14행 (0-based index: 13)

          for (let rowIdx = startRowIndex; rowIdx <= endRowIndex && rowIdx < allRows.length; rowIdx++) {
            const row = allRows[rowIdx];
            const cells = Array.from(row.querySelectorAll('td'));

            if (circleCellIndex < cells.length) {
              const targetCell = cells[circleCellIndex];
              const input = targetCell.querySelector('input');

              if (input) {
                input.remove();
                // 입력박스가 다시 생성되지 않도록 마커 추가
                targetCell.setAttribute('data-input-removed', 'true');
                targetCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
                removedCount++;
                console.log('행' + (rowIdx + 1) + '의 ' + (circleCellIndex + 1) + '열(㉯가 있는 열과 동일, 보이는 셀 기준 인덱스 ' + circleCellIndex + ') 입력박스 제거 완료');
              } else {
                // 입력박스가 없어도 마커 추가 (나중에 생성되지 않도록)
                targetCell.setAttribute('data-input-removed', 'true');
              }
            }
          }
        }
      }
    }

    allRows.forEach(function(row, rowIndex) {
      const cells = row.querySelectorAll('td');
      let actualColIndex = 0;

      cells.forEach(function(cell, cellIndex) {
        const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);
        const rowspan = parseInt(cell.getAttribute('rowspan') || '1', 10);

        // 실제 열 번호 계산 (colspan 고려)
        // actualColIndex는 0-based이므로, 5 = 6열
        // 6열은 정확히 6열인 경우만 제외 (colspan이 1이고 actualColIndex가 5인 경우)
        const isColumn6 = (actualColIndex === 5 && colspan === 1);

        // 5열인지 확인 (정확히 5열인 경우만: startCol이 5이고 colspan이 1)
        const startCol = actualColIndex + 1; // 1-based
        const isColumn5 = (startCol === 5 && colspan === 1);

        // 마지막 셀인지 확인 (현재 보이는 셀 구조 기준으로 마지막 셀을 7열로 간주)
        const isLastCell = (cellIndex === cells.length - 1);

        // 마지막 셀(7열로 간주)은 무조건 입력박스가 있어야 함
        if (isLastCell) {
          if (!cell.querySelector('input')) {
            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'number-input';
            input.style.textAlign = 'right';
            input.style.fontSize = '8pt';
            input.style.background = 'transparent';
            input.style.outline = 'none';
            input.oninput = function(e) { handleNumberInput(e); };

            const cellStyle = cell.getAttribute('style') || '';
            let newCellStyle = cellStyle.replace(/padding[^;]*/gi, '');
            if (!newCellStyle.includes('position')) {
              newCellStyle += 'position:relative;';
            }
            newCellStyle += 'padding:0;';
            cell.setAttribute('style', newCellStyle);
            cell.innerHTML = '';
            cell.appendChild(input);
            addedCount++;
            console.log('행' + (rowIndex + 1) + ', 마지막 셀(7열로 간주)에 입력박스 강제 추가');
          }
          actualColIndex += colspan;
          return; // 마지막 셀은 여기서 처리 완료
        }

        // 5열에 배경색 #C0C0C0가 있으면 입력박스 추가 안함 및 제거
        if (isColumn5) {
          const cellStyle = cell.getAttribute('style') || '';
          if (cellStyle.includes('background-color:#C0C0C0') || cellStyle.includes('background-color: #C0C0C0')) {
            // 입력박스 제거
            const input = cell.querySelector('input');
            if (input) {
              input.remove();
              cell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
              removedCount++;
            }
            actualColIndex += colspan;
            return;
          }
        }

        // 기존 입력박스가 있으면 스킵 (단, 7열은 예외 - 7열은 이미 위에서 처리됨)
        if (cell.querySelector('input')) {
          actualColIndex += colspan;
          return;
        }

        // 제거된 셀인지 확인 (data-input-removed 속성 체크)
        if (cell.getAttribute('data-input-removed') === 'true') {
          actualColIndex += colspan;
          return; // 제거된 셀에는 입력박스를 추가하지 않음
        }

        // 텍스트 내용 확인
        const cellText = cell.textContent.trim();

        // 원문자나 괄호 번호만 있는 경우는 제외 (실제 텍스트가 있는 것으로 간주)
        const hasOnlyMarker = cellText.match(/^[㉰-㉹]$/) || cellText.match(/^\(\d+\)$/);

        // 실제 의미있는 텍스트가 있는지 확인 (원문자, 괄호 번호, 빈 텍스트 제외)
        const hasRealText = cellText !== '' &&
                           !hasOnlyMarker &&
                           cellText.length > 2;

        // 빈 셀인지 확인 (더 포괄적으로)
        const isEmpty = !hasRealText &&
                      !hasOnlyMarker &&
                      (cell.innerHTML.trim() === '' ||
                       cell.innerHTML === '<p style="text-indent: 0pt;text-align: left;"><br/></p>' ||
                       cell.innerHTML === '<p style="text-indent: 0pt;text-align: left;"></p>' ||
                       cell.innerHTML === '<br/>' ||
                       (cell.children.length === 1 && cell.children[0].tagName === 'P' &&
                        (cell.children[0].innerHTML.trim() === '<br/>' ||
                         cell.children[0].innerHTML.trim() === '' ||
                         cell.children[0].textContent.trim() === '' ||
                         cell.children[0].textContent.trim().match(/^[㉰-㉹]$/) ||
                         cell.children[0].textContent.trim().match(/^\(\d+\)$/))) ||
                       cellText === '');

        // 5열 2행은 입력박스 추가 제외
        const isRow2Column5 = (rowIndex === 1 && isColumn5);

        // 7행(r=6, 합계 행)의 2, 3, 4열은 입력박스 추가 제외
        const isRow7Columns234 = (rowIndex === 6 && (actualColIndex >= 1 && actualColIndex <= 3));

        // 디버깅: 6열인 경우 로그 출력
        if (isColumn6) {
          console.log('행' + (rowIndex + 1) + ', 열' + (actualColIndex + 1) + ' (6열) - 입력박스 추가 제외');
        }

        // 6열이 아니고, 5열 2행이 아니고, 7행의 2,3,4열이 아니고, 빈 셀이고, 제거된 셀이 아니면 입력박스 추가
        if (!isColumn6 && !isRow2Column5 && !isRow7Columns234 && isEmpty && cell.getAttribute('data-input-removed') !== 'true') {
          const input = document.createElement('input');
          input.type = 'text';
          input.className = 'number-input';
          // CSS 스타일이 적용되도록 인라인 스타일 최소화 (CSS의 :focus 스타일이 적용되도록)
          input.style.textAlign = 'right';
          input.style.fontSize = '8pt';
          input.style.background = 'transparent';
          input.style.outline = 'none';
          input.oninput = function(e) { handleNumberInput(e); };

          // 셀의 padding 제거하고 position: relative 추가 (입력박스가 absolute로 위치하기 위해)
          const cellStyle = cell.getAttribute('style') || '';
          let newCellStyle = cellStyle.replace(/padding[^;]*/gi, '');
          if (!newCellStyle.includes('position')) {
            newCellStyle += 'position:relative;';
          }
          newCellStyle += 'padding:0;';
          cell.setAttribute('style', newCellStyle);
          cell.innerHTML = '';
          cell.appendChild(input);
          addedCount++;

          console.log('행' + (rowIndex + 1) + ', 열' + (actualColIndex + 1) + '에 입력박스 추가');
        } else if (!isColumn6 && !isEmpty) {
          // 디버깅: 입력박스가 추가되지 않은 경우
          const cellText = cell.textContent.trim();
          console.log('행' + (rowIndex + 1) + ', 열' + (actualColIndex + 1) + ' - 입력박스 추가 안함 (텍스트: "' + cellText + '")');
        }

        actualColIndex += colspan;
      });
    });

    // 모든 행의 마지막 셀을 7열로 간주하여 입력박스 추가 (현재 보이는 셀 구조 기준)
    allRows.forEach(function(row, rowIdx) {
      const cells = row.querySelectorAll('td');

      if (cells.length === 0) {
        return; // 셀이 없으면 스킵
      }

      // 마지막 셀을 7열로 간주
      const cell7 = cells[cells.length - 1];

      // 이미 입력박스가 있으면 스킵
      if (!cell7.querySelector('input')) {
        const input = document.createElement('input');
        input.type = 'text';
        input.className = 'number-input';
        input.style.textAlign = 'right';
        input.style.fontSize = '8pt';
        input.style.background = 'transparent';
        input.style.outline = 'none';
        input.oninput = function(e) { handleNumberInput(e); };

        // 셀의 padding 제거하고 position: relative 추가
        const cellStyle = cell7.getAttribute('style') || '';
        let newCellStyle = cellStyle.replace(/padding[^;]*/gi, '');
        if (!newCellStyle.includes('position')) {
          newCellStyle += 'position:relative;';
        }
        newCellStyle += 'padding:0;';
        cell7.setAttribute('style', newCellStyle);
        cell7.innerHTML = '';
        cell7.appendChild(input);
        addedCount++;

        console.log('행' + (rowIdx + 1) + ', 마지막 셀(7열로 간주)에 입력박스 추가');
      }
    });

    // 모든 입력박스 추가 후 5열 2행의 입력박스 강제 제거 (정확히 5열만)
    if (allRows.length > 1) {
      const row2 = allRows[1]; // 2행 (0-based index: 1)
      const cells = row2.querySelectorAll('td');
      let actualColIndex = 0;

      cells.forEach(function(cell) {
        const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);
        const startCol = actualColIndex + 1; // 1-based
        const endCol = actualColIndex + colspan;

        // 5열인지 확인 (정확히 5열인 경우만: startCol이 5이고 colspan이 1)
        if (startCol === 5 && colspan === 1) {
          const input = cell.querySelector('input');
          if (input) {
            input.remove();
            cell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
            removedCount++;
            console.log('5열 2행의 입력박스 최종 제거 완료 (startCol=' + startCol + ', colspan=' + colspan + ')');
          }
        }

        actualColIndex += colspan;
      });
    }

    if (addedCount > 0) {
      console.log('매입세액 테이블에 ' + addedCount + '개의 입력박스 추가 완료');
    }
    if (removedCount > 0) {
      console.log('매입세액 테이블에서 ' + removedCount + '개의 입력박스 제거 완료');
    }

    // 7열 입력박스 최종 확인 및 강제 추가 (다른 로직에 의해 제거되었을 수 있으므로)
    ensureColumn7InputBoxes();
  }

  // 7열 입력박스를 강제로 보장하는 함수 (더 강력한 버전)
  function ensureColumn7InputBoxes() {
    const purchaseTaxTable = document.querySelector('table.new-purchase-tax-table');
    if (!purchaseTaxTable) {
      setTimeout(ensureColumn7InputBoxes, 100);
      return;
    }

    const allRows = purchaseTaxTable.querySelectorAll('tr');
    let ensuredCount = 0;

    // 모든 행의 7열에 입력박스 강제 추가
    allRows.forEach(function(row, rowIdx) {
      const cells = row.querySelectorAll('td');
      let actualColIndex = 0; // 병합 전 실제 열 번호 (0-based, 원본 테이블 기준)
      let cell7 = null;
      let totalCols = 0; // 실제 열의 총 개수

      // 실제 열 번호를 계산하여 7열 찾기 (colspan 고려)
      cells.forEach(function(cell) {
        const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);
        totalCols += colspan;
      });

      // 실제 열 번호를 계산 (원본 테이블 기준으로 7열 찾기)
      cells.forEach(function(cell) {
        const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);
        const startCol = actualColIndex + 1; // 1-based 실제 열 번호
        const endCol = actualColIndex + colspan; // 1-based 실제 열 번호

        // 7열인지 확인 (7열이 이 셀의 범위에 포함되는지)
        if (startCol <= 7 && 7 <= endCol) {
          cell7 = cell;
        }

        actualColIndex += colspan;
      });

      // 7열을 찾지 못했지만, 마지막 셀이 7열일 가능성이 높은 경우 (1열이 제거된 행들)
      // 4행~9행: 1열 제거되어 실제로는 2~7열만 있음 → 마지막 셀이 7열
      if (!cell7 && (rowIdx >= 3 && rowIdx <= 8)) {
        // 마지막 셀이 7열일 가능성
        if (cells.length > 0) {
          const lastCell = cells[cells.length - 1];
          const lastColspan = parseInt(lastCell.getAttribute('colspan') || '1', 10);
          // 마지막 셀의 시작 열이 7이거나, 마지막 셀이 7열을 포함하는지 확인
          let lastStartCol = 0;
          for (let i = 0; i < cells.length - 1; i++) {
            lastStartCol += parseInt(cells[i].getAttribute('colspan') || '1', 10);
          }
          lastStartCol += 1; // 1-based
          if (lastStartCol <= 7 && 7 <= lastStartCol + lastColspan - 1) {
            cell7 = lastCell;
            console.log('행' + (rowIdx + 1) + ': 마지막 셀을 7열로 인식 (시작열=' + lastStartCol + ')');
          }
        }
      }

      // 여전히 못 찾았으면 마지막 셀을 7열로 간주 (대부분의 경우 마지막 셀이 7열)
      if (!cell7 && cells.length > 0) {
        cell7 = cells[cells.length - 1];
        console.log('행' + (rowIdx + 1) + ': 7열을 찾지 못해 마지막 셀을 7열로 간주 (총 실제 열 수: ' + totalCols + ')');
      }

      if (cell7) {
        // 입력박스가 없으면 강제로 추가 (있어도 다시 확인)
        const existingInput = cell7.querySelector('input');
        if (!existingInput) {
          const input = document.createElement('input');
          input.type = 'text';
          input.className = 'number-input';
          input.style.textAlign = 'right';
          input.style.fontSize = '8pt';
          input.style.background = 'transparent';
          input.style.outline = 'none';
          input.oninput = function(e) { handleNumberInput(e); };

          // 셀의 padding 제거하고 position: relative 추가
          const cellStyle = cell7.getAttribute('style') || '';
          let newCellStyle = cellStyle.replace(/padding[^;]*/gi, '');
          if (!newCellStyle.includes('position')) {
            newCellStyle += 'position:relative;';
          }
          newCellStyle += 'padding:0;';
          cell7.setAttribute('style', newCellStyle);

          // 기존 내용 제거하고 입력박스만 추가
          cell7.innerHTML = '';
          cell7.appendChild(input);
          ensuredCount++;

          console.log('행' + (rowIdx + 1) + ', 실제 7열에 입력박스 추가 (보호 로직)');
        }
      } else {
        notFoundCount++;
        console.log('행' + (rowIdx + 1) + '에서 실제 7열을 찾을 수 없습니다. (셀 개수: ' + cells.length + ', 총 실제 열 수: ' + totalCols + ')');
      }
    });

    if (ensuredCount > 0) {
      console.log('7열 입력박스 보호 완료: ' + ensuredCount + '개 추가');
      // 추가로 한 번 더 실행 (DOM 렌더링 후)
      setTimeout(ensureColumn7InputBoxes, 200);
    }
  }

  // 테이블 폭을 624pt로 설정하고 좌측 정렬하는 헬퍼 함수
  function setTableWidthAndAlign(table) {
    // 과세표준명세 테이블은 제외 (흔들림 방지)
    const tableText = table.textContent || '';
    const normalizedText = tableText.replace(/\s+/g, '');
    const textWithoutSpaces = tableText.replace(/\s/g, '');
    if ((tableText.includes('⑤') && tableText.includes('과세표준명세')) ||
        textWithoutSpaces.includes('⑤과세표준명세') ||
        (tableText.includes('과세표준명세'))) {
      // 과세표준명세 테이블은 처리하지 않음 (HTML에 이미 스타일이 설정되어 있음)
      return;
    }

    let tableStyle = table.getAttribute('style') || '';

    // 기존 width 속성 제거
    tableStyle = tableStyle.replace(/width\s*:\s*[^;]+;?/gi, '');
    tableStyle = tableStyle.replace(/width\s*:\s*[^"']+/gi, '');

    // 폭 추가 (매입세액 테이블의 경우 border 고려)
    if (tableStyle && !tableStyle.endsWith(';') && tableStyle.trim() !== '') {
      tableStyle += ';';
    }
    // 모든 테이블을 624pt로 통일
    tableStyle += 'width:624pt;';

    // 좌측 정렬을 위한 margin 설정
    // 폐업신고 관련 테이블은 margin을 보존
    const isClosureTable = table.classList.contains('inserted-between-tables') ||
                           table.classList.contains('closure-report-detail-table');

    if (!isClosureTable) {
      tableStyle = tableStyle.replace(/margin\s*:\s*[^;]+;?/gi, '');
      tableStyle = tableStyle.replace(/margin-left\s*:\s*[^;]+;?/gi, '');
      tableStyle = tableStyle.replace(/margin-right\s*:\s*[^;]+;?/gi, '');
      tableStyle = tableStyle.replace(/margin-top\s*:\s*[^;]+;?/gi, '');
      tableStyle = tableStyle.replace(/margin-bottom\s*:\s*[^;]+;?/gi, '');
    } else {
      // 폐업신고 관련 테이블은 좌우 margin만 조정
      tableStyle = tableStyle.replace(/margin-left\s*:\s*[^;]+;?/gi, '');
      tableStyle = tableStyle.replace(/margin-right\s*:\s*[^;]+;?/gi, '');
    }

    // box-sizing:border-box 추가 (모든 테이블에 통일)
    tableStyle = tableStyle.replace(/box-sizing\s*:\s*[^;]+;?/gi, '');

    if (tableStyle && !tableStyle.endsWith(';') && tableStyle.trim() !== '') {
      tableStyle += ';';
    }

    // 매입세액 테이블인 경우 margin-top을 0으로 설정
    if (table.classList.contains('new-purchase-tax-table')) {
      tableStyle += 'margin-left:0;margin-right:auto;margin-top:0;margin-bottom:0;box-sizing:border-box;';
    } else if (!isClosureTable) {
      tableStyle += 'margin-left:0;margin-right:auto;box-sizing:border-box;';
    } else {
      // 폐업신고 관련 테이블은 좌우 margin만 설정
      tableStyle += 'margin-left:0;margin-right:auto;box-sizing:border-box;';
    }

    table.setAttribute('style', tableStyle);
  }

  // 특정 텍스트로 시작하는 테이블 및 아래 테이블들의 폭을 624pt로 설정하고 좌측 정렬
  function adjustTablesByKeyword(keyword, description) {
    const allTables = document.querySelectorAll('table');
    let targetTable = null;
    let targetTableIndex = -1;

    // 키워드 텍스트가 포함된 테이블 찾기
    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const tableText = table.textContent || '';
      if (tableText.includes(keyword)) {
        targetTable = table;
        targetTableIndex = i;
        console.log(description + ' 테이블 발견 (인덱스: ' + i + ')');
        break;
      }
    }

    if (!targetTable) {
      return;
    }

    // 해당 테이블 자체도 폭 및 정렬 설정
    setTableWidthAndAlign(targetTable);
    console.log(description + ' 테이블 폭 및 정렬 설정 완료');

    // 해당 테이블 아래의 모든 테이블 찾기
    const tablesBelow = [];
    for (let i = targetTableIndex + 1; i < allTables.length; i++) {
      tablesBelow.push(allTables[i]);
    }

    console.log(description + ' 테이블 아래 테이블 개수: ' + tablesBelow.length);

    // 각 테이블의 폭을 624pt로 설정하고 좌측 정렬
    tablesBelow.forEach(function(table, index) {
      setTableWidthAndAlign(table);
      console.log(description + ' 아래 테이블 ' + (index + 1) + ' 폭 및 정렬 설정 완료');
    });

    console.log(description + ' 테이블 및 아래 테이블 폭 및 정렬 설정 완료');
  }

  // 마지막 테이블의 폭을 624pt로 설정
  function setLastTableWidth() {
    const allTables = document.querySelectorAll('table');
    if (allTables.length > 0) {
      const lastTable = allTables[allTables.length - 1];
      // 매입세액 테이블이 아닌 경우에만 624pt로 설정
      if (!lastTable.classList.contains('new-purchase-tax-table')) {
        // 마지막 테이블이 after-below-zero-rate-table 클래스를 가진 경우 margin-top 보존
        const isAfterBelowZeroRate = lastTable.classList.contains('after-below-zero-rate-table');
        const preservedMarginTop = isAfterBelowZeroRate ? 'margin-top:0 !important;' : '';

        // 마지막 테이블의 폭을 624pt로 강제 설정
        let tableStyle = lastTable.getAttribute('style') || '';
        // 기존 width 속성 제거
        tableStyle = tableStyle.replace(/width\s*:\s*[^;]+;?/gi, '');
        tableStyle = tableStyle.replace(/width\s*:\s*[^"']+/gi, '');
        // margin-left도 제거하고 좌측 정렬
        tableStyle = tableStyle.replace(/margin-left\s*:\s*[^;]+;?/gi, '');

        // margin-top 보존
        if (isAfterBelowZeroRate) {
          tableStyle = tableStyle.replace(/margin-top[^;]*;?/gi, '');
        }

        if (tableStyle && !tableStyle.endsWith(';') && tableStyle.trim() !== '') {
          tableStyle += ';';
        }
        tableStyle += 'width:624pt;margin-left:0;margin-right:auto;';

        // margin-top 추가
        if (isAfterBelowZeroRate) {
          tableStyle += preservedMarginTop;
        }

        lastTable.setAttribute('style', tableStyle);
        console.log('마지막 테이블(세무대리인 테이블) 폭을 624pt로 설정 완료');
      }
    }
  }

  // 모든 테이블의 오른쪽 끝을 맞추기 위해 모든 테이블의 스타일을 통일
  function alignAllTables() {
    const allTables = document.querySelectorAll('table');

    allTables.forEach(function(table) {
      // below-zero-rate-table의 margin-bottom은 보존
      const isBelowZeroRateTable = table.classList.contains('below-zero-rate-table') &&
                                    table.getAttribute('data-below-zero-rate') === 'true';
      const preservedMarginBottom = isBelowZeroRateTable ? 'margin-bottom:2pt !important;' : '';

      let tableStyle = table.getAttribute('style') || '';

      // width를 624pt로 통일
      tableStyle = tableStyle.replace(/width\s*:\s*[^;]+;?/gi, '');

      // margin-left를 0으로 통일
      tableStyle = tableStyle.replace(/margin-left\s*:\s*[^;]+;?/gi, '');

      // margin을 제거하되, below-zero-rate-table의 margin-bottom은 보존
      if (!isBelowZeroRateTable) {
        tableStyle = tableStyle.replace(/margin\s*:\s*[^;]+;?/gi, '');
        tableStyle = tableStyle.replace(/margin-bottom\s*:\s*[^;]+;?/gi, '');
      } else {
        // below-zero-rate-table의 경우 margin-bottom만 제거하고 나중에 다시 추가
        tableStyle = tableStyle.replace(/margin\s*:\s*[^;]+;?/gi, '');
        tableStyle = tableStyle.replace(/margin-bottom[^;]*;?/gi, '');
      }

      // box-sizing을 border-box로 통일
      tableStyle = tableStyle.replace(/box-sizing\s*:\s*[^;]+;?/gi, '');

      // 테이블 자체의 border 제거 (셀 border는 유지)
      tableStyle = tableStyle.replace(/border\s*:\s*[^;]+;?/gi, '');
      tableStyle = tableStyle.replace(/border-top\s*:\s*[^;]+;?/gi, '');
      tableStyle = tableStyle.replace(/border-bottom\s*:\s*[^;]+;?/gi, '');
      tableStyle = tableStyle.replace(/border-left\s*:\s*[^;]+;?/gi, '');
      tableStyle = tableStyle.replace(/border-right\s*:\s*[^;]+;?/gi, '');

      if (tableStyle && !tableStyle.endsWith(';') && tableStyle.trim() !== '') {
        tableStyle += ';';
      }

      // 필수 스타일 추가 (테이블 border 없음)
      tableStyle += 'width:624pt;margin-left:0;margin-right:auto;box-sizing:border-box;border:none;';

      // below-zero-rate-table의 margin-bottom 추가
      if (isBelowZeroRateTable) {
        tableStyle += preservedMarginBottom;
      }

      // border-collapse가 없으면 추가
      if (!tableStyle.includes('border-collapse')) {
        tableStyle += 'border-collapse:collapse;';
      }

      // table-layout이 없으면 추가
      if (!tableStyle.includes('table-layout')) {
        tableStyle += 'table-layout:fixed;';
      }

      table.setAttribute('style', tableStyle);
    });

    console.log('모든 테이블 정렬 완료 (width:624pt, margin-left:0, box-sizing:border-box, border:none)');

    // alignAllTables 실행 후 간격 재설정
    setTimeout(function() {
      const belowZeroRateTable = document.querySelector('table.below-zero-rate-table[data-below-zero-rate="true"]');
      if (belowZeroRateTable) {
        // setTableSpacing 함수 제거됨 (오늘 만든 테이블 간격 조절 기능 제거)
        // ensureRowspanForColumn6 함수 호출 비활성화 (6열 병합 보호)
        // if (typeof window.ensureRowspanForColumn6 === 'function') {
        //   window.ensureRowspanForColumn6(belowZeroRateTable);
        // }
      }
    }, 10);
  }

  // 세무대리인 텍스트를 상하 중앙 정렬
  function alignTaxAgentTextCenter() {
    const allTables = document.querySelectorAll('table');
    if (allTables.length > 0) {
      const lastTable = allTables[allTables.length - 1];
      // 매입세액 테이블이 아닌 경우에만 처리
      if (!lastTable.classList.contains('new-purchase-tax-table')) {
        const rows = lastTable.querySelectorAll('tr');
        rows.forEach(function(row) {
          const cells = row.querySelectorAll('td');
          cells.forEach(function(cell) {
            const cellText = cell.textContent.trim();
            // "세무대리인" 텍스트가 있는 셀 찾기
            if (cellText.includes('세무대리인')) {
              let cellStyle = cell.getAttribute('style') || '';
              // padding-top 제거
              cellStyle = cellStyle.replace(/padding-top[^;]*/gi, '');
              cellStyle = cellStyle.replace(/padding[^;]*/gi, '');
              // vertical-align을 middle로 설정
              cellStyle = cellStyle.replace(/vertical-align[^;]*/gi, '');
              // text-align을 center로 설정
              cellStyle = cellStyle.replace(/text-align[^;]*/gi, '');
              if (cellStyle && !cellStyle.endsWith(';') && cellStyle.trim() !== '') {
                cellStyle += ';';
              }
              cellStyle += 'padding:0;vertical-align:middle;text-align:center;';
              cell.setAttribute('style', cellStyle);

              // 내부 p 태그의 padding-top도 제거하고 text-align도 center로 설정
              const pTags = cell.querySelectorAll('p');
              pTags.forEach(function(p) {
                let pStyle = p.getAttribute('style') || '';
                pStyle = pStyle.replace(/padding-top[^;]*/gi, '');
                pStyle = pStyle.replace(/padding[^;]*/gi, '');
                pStyle = pStyle.replace(/text-align[^;]*/gi, '');
                if (pStyle && !pStyle.endsWith(';') && pStyle.trim() !== '') {
                  pStyle += ';';
                }
                pStyle += 'padding:0;margin:0;text-align:center;';
                p.setAttribute('style', pStyle);
              });

              console.log('세무대리인 텍스트 상하좌우 중앙 정렬 완료 (padding 제거)');
            }
          });
        });
      }
    }
  }

  // 세무대리인 테이블의 1열에서 입력박스 제거 (세무대리인 텍스트 유지)
  function removeInputBoxFromFirstColumn() {
    const allTables = document.querySelectorAll('table');
    if (allTables.length > 0) {
      const lastTable = allTables[allTables.length - 1];
      // 매입세액 테이블이 아닌 경우에만 처리
      if (!lastTable.classList.contains('new-purchase-tax-table')) {
        const rows = lastTable.querySelectorAll('tr');
        rows.forEach(function(row) {
          const firstCell = row.querySelector('td:first-child');
          if (firstCell) {
            const cellText = firstCell.textContent.trim();
            // "세무대리인" 텍스트가 있는 셀인 경우
            if (cellText.includes('세무대리인')) {
              const input = firstCell.querySelector('input');
              if (input) {
                // 입력박스 제거 (텍스트는 유지)
                input.remove();
                console.log('세무대리인 테이블 1열의 입력박스 제거 완료');
              }
            }
          }
        });
      }
    }
  }

  // 세무대리인 테이블의 빈 셀에 입력박스 추가
  function addInputBoxesToLastTable() {
    const allTables = document.querySelectorAll('table');
    if (allTables.length > 0) {
      const lastTable = allTables[allTables.length - 1];
      // 매입세액 테이블이 아닌 경우에만 처리
      if (!lastTable.classList.contains('new-purchase-tax-table')) {
        const rows = lastTable.querySelectorAll('tr');
        let addedCount = 0;

        rows.forEach(function(row) {
          const cells = row.querySelectorAll('td');
          cells.forEach(function(cell, cellIndex) {
            // 1열(첫 번째 셀)은 스킵 (세무대리인 텍스트가 있는 열)
            if (cellIndex === 0) {
              return;
            }

            // 이미 입력박스가 있으면 스킵
            if (cell.querySelector('input')) {
              return;
            }

            // 셀 내용 확인
            const cellText = cell.textContent.trim();
            const cellHTML = cell.innerHTML.trim();

            // 빈 셀인지 확인 (텍스트가 없거나 <br/>만 있는 경우)
            // 텍스트가 없고, 입력박스도 없으면 빈 셀로 간주
            const hasText = cellText && cellText.length > 0;
            const hasInput = cell.querySelector('input');
            const isEmpty = !hasText && !hasInput;

            if (isEmpty) {
              // 셀 스타일 설정 (position: relative, padding: 0)
              const cellStyle = cell.getAttribute('style') || '';
              let newCellStyle = cellStyle.replace(/padding[^;]*/gi, '');
              newCellStyle = newCellStyle.replace(/position[^;]*/gi, '');
              if (newCellStyle && !newCellStyle.endsWith(';') && newCellStyle.trim() !== '') {
                newCellStyle += ';';
              }
              newCellStyle += 'position:relative;padding:0;';
              cell.setAttribute('style', newCellStyle);

              // 입력박스 생성 (매입세액 테이블과 동일한 스타일)
              const input = document.createElement('input');
              input.type = 'text';
              input.className = 'text-input';
              // 인라인 스타일은 제거하고 CSS 클래스만 사용

              cell.innerHTML = '';
              cell.appendChild(input);
              addedCount++;
            }
          });
        });

        if (addedCount > 0) {
          console.log('세무대리인 테이블에 ' + addedCount + '개의 입력박스 추가 완료');
        }
      }
    }
  }

  // 특정 텍스트의 폰트 크기를 10pt로 설정하는 함수
  function setTextFontSize10pt(searchTexts, description) {
    const allTables = document.querySelectorAll('table');

    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const cells = table.querySelectorAll('td');

      for (let j = 0; j < cells.length; j++) {
        const cell = cells[j];
        const cellText = cell.textContent || '';

        // 검색 텍스트 중 하나라도 포함되어 있는지 확인
        let found = false;
        for (let k = 0; k < searchTexts.length; k++) {
          if (cellText.includes(searchTexts[k])) {
            found = true;
            break;
          }
        }

        if (found) {
          // 셀 내부의 모든 p 태그와 span 태그의 폰트 크기를 10pt로 설정
          const textElements = cell.querySelectorAll('p, span');
          textElements.forEach(function(element) {
            let elementStyle = element.getAttribute('style') || '';
            // 기존 font-size 제거
            elementStyle = elementStyle.replace(/font-size\s*:\s*[^;]+;?/gi, '');
            if (elementStyle && !elementStyle.endsWith(';') && elementStyle.trim() !== '') {
              elementStyle += ';';
            }
            elementStyle += 'font-size:10pt;';
            element.setAttribute('style', elementStyle);
          });

          // p 태그가 없으면 직접 텍스트 노드가 있을 수 있으므로 셀 자체에도 설정
          if (textElements.length === 0) {
            let cellStyle = cell.getAttribute('style') || '';
            cellStyle = cellStyle.replace(/font-size\s*:\s*[^;]+;?/gi, '');
            if (cellStyle && !cellStyle.endsWith(';') && cellStyle.trim() !== '') {
              cellStyle += ';';
            }
            cellStyle += 'font-size:10pt;';
            cell.setAttribute('style', cellStyle);
          }

          console.log(description + ' 텍스트 폰트 크기 10pt 설정 완료');
          return; // 첫 번째 매칭 셀만 처리
        }
      }
    }
  }

  // 국세환급금 계좌신고 텍스트 좌측 정렬 및 좌측 여백 3pt 설정
  function adjustAccountReportTextAlignment() {
    const allTables = document.querySelectorAll('table');

    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const cells = table.querySelectorAll('td');

      for (let j = 0; j < cells.length; j++) {
        const cell = cells[j];
        const cellText = cell.textContent || '';

        // "국세환급금 계좌신고" 또는 "② 국세환급금 계좌신고" 또는 "2.국세환급금 계좌신고" 텍스트가 포함된 셀 찾기
        if (cellText.includes('국세환급금 계좌신고') ||
            (cellText.includes('②') && cellText.includes('국세환급금')) ||
            (cellText.includes('2.') && cellText.includes('국세환급금'))) {

          // 셀 스타일 수정
          let cellStyle = cell.getAttribute('style') || '';

          // 기존 padding-left 제거
          cellStyle = cellStyle.replace(/padding-left\s*:\s*[^;]+;?/gi, '');
          // 기존 text-align 제거
          cellStyle = cellStyle.replace(/text-align\s*:\s*[^;]+;?/gi, '');

          // padding-left: 3pt 추가
          if (cellStyle && !cellStyle.endsWith(';') && cellStyle.trim() !== '') {
            cellStyle += ';';
          }
          cellStyle += 'padding-left:3pt;';

          // text-align: left 추가
          cellStyle += 'text-align:left;';

          cell.setAttribute('style', cellStyle);

          // 셀 내부의 p 태그도 정렬
          const pTags = cell.querySelectorAll('p');
          pTags.forEach(function(p) {
            let pStyle = p.getAttribute('style') || '';
            pStyle = pStyle.replace(/text-align\s*:\s*[^;]+;?/gi, '');
            pStyle = pStyle.replace(/padding-left\s*:\s*[^;]+;?/gi, '');
            if (pStyle && !pStyle.endsWith(';') && pStyle.trim() !== '') {
              pStyle += ';';
            }
            pStyle += 'text-align:left;padding-left:0;';
            p.setAttribute('style', pStyle);
          });

          console.log('국세환급금 계좌신고 텍스트 좌측 정렬 및 여백 설정 완료');
          return; // 첫 번째 매칭 셀만 처리
        }
      }
    }
  }

  // 영세율 상호주의 테이블의 첫 번째 행 내용 확인
  function checkZeroRateTableFirstRow() {
    const allTables = document.querySelectorAll('table');

    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const tableText = table.textContent || '';

      // "영세율 상호주의" 텍스트가 포함된 테이블 찾기
      if (tableText.includes('영세율 상호주의') ||
          (tableText.includes('④') && tableText.includes('영세율')) ||
          (tableText.includes('4.') && tableText.includes('영세율'))) {

        const rows = table.querySelectorAll('tr');

        if (rows.length > 0) {
          const firstRow = rows[0];
          const cells = firstRow.querySelectorAll('td');

          console.log('=== 영세율 상호주의 테이블 첫 번째 행 내용 ===');
          console.log('첫 번째 행의 셀 개수: ' + cells.length);

          cells.forEach(function(cell, cellIdx) {
            const cellText = cell.textContent || '';
            const rowspan = cell.getAttribute('rowspan') || '1';
            const colspan = cell.getAttribute('colspan') || '1';
            const cellHTML = cell.innerHTML.substring(0, 100); // 처음 100자만

            console.log('셀 ' + (cellIdx + 1) + ':');
            console.log('  - 텍스트: "' + cellText.trim() + '"');
            console.log('  - rowspan: ' + rowspan);
            console.log('  - colspan: ' + colspan);
            console.log('  - HTML 샘플: ' + cellHTML);
          });

          // "영세율 상호주의" 텍스트가 있는 셀 찾기
          let foundCell = null;
          let foundCellIndex = -1;
          cells.forEach(function(cell, cellIdx) {
            const cellText = cell.textContent || '';
            if (cellText.includes('영세율 상호주의') ||
                (cellText.includes('④') && cellText.includes('영세율')) ||
                (cellText.includes('4.') && cellText.includes('영세율'))) {
              foundCell = cell;
              foundCellIndex = cellIdx;
            }
          });

          if (foundCell) {
            console.log('"영세율 상호주의" 텍스트가 있는 셀: ' + (foundCellIndex + 1) + '번째 셀');
            console.log('이 셀의 텍스트: "' + foundCell.textContent.trim() + '"');

            // 이 셀 위에 무엇이 있는지 확인 (테이블 앞의 요소들)
            const previousSibling = table.previousElementSibling;
            if (previousSibling) {
              console.log('테이블 위의 요소: ' + previousSibling.tagName + ', 텍스트: "' + (previousSibling.textContent || '').substring(0, 50) + '"');
            } else {
              console.log('테이블 위에 요소가 없습니다.');
            }
          } else {
            console.log('첫 번째 행에서 "영세율 상호주의" 텍스트를 찾지 못했습니다.');
          }
        }

        return table;
      }
    }

    console.log('영세율 상호주의 테이블을 찾지 못했습니다.');
    return null;
  }

  // 영세율 상호주의 테이블의 행과 열 개수 확인
  function checkZeroRateTableDimensions() {
    const allTables = document.querySelectorAll('table');

    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const tableText = table.textContent || '';

      // "영세율 상호주의" 텍스트가 포함된 테이블 찾기
      if (tableText.includes('영세율 상호주의') ||
          (tableText.includes('④') && tableText.includes('영세율')) ||
          (tableText.includes('4.') && tableText.includes('영세율'))) {

        const rows = table.querySelectorAll('tr');
        let maxCols = 0;

        // 각 행의 열 개수 확인 (colspan 고려)
        rows.forEach(function(row, rowIdx) {
          const cells = row.querySelectorAll('td');
          let colCount = 0;

          cells.forEach(function(cell) {
            const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);
            colCount += colspan;
          });

          if (colCount > maxCols) {
            maxCols = colCount;
          }

          console.log('행 ' + (rowIdx + 1) + ': ' + cells.length + '개 셀 (실제 열 수: ' + colCount + ')');
        });

        console.log('=== 영세율 상호주의 테이블 정보 ===');
        console.log('총 행 수: ' + rows.length);
        console.log('최대 열 수: ' + maxCols);
        console.log('테이블 인덱스: ' + i);

        return {
          rows: rows.length,
          cols: maxCols,
          table: table
        };
      }
    }

    console.log('영세율 상호주의 테이블을 찾지 못했습니다.');
    return null;
  }

  // 업태 텍스트 좌측 정렬, 좌측 여백 3pt 설정 및 글자 간격 제거
  let businessTypeTextAlignmentAdjusted = false;

  function adjustBusinessTypeTextAlignment() {
    // 이미 처리되었으면 실행하지 않음
    if (businessTypeTextAlignmentAdjusted) {
      return;
    }

    // 과세표준명세 테이블이 삭제되었으면 실행하지 않음
    if (taxBaseDetailTableRemoved) {
      console.log('과세표준명세 테이블이 삭제되었으므로 업태 텍스트 정렬을 건너뜁니다.');
      businessTypeTextAlignmentAdjusted = true;
      return;
    }

    const allTables = document.querySelectorAll('table');
    let targetTable = null;

    // 과세표준명세 테이블 찾기 (업태가 이 테이블에 있을 가능성이 높음)
    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const tableText = table.textContent || '';
      const normalizedText = tableText.replace(/\s+/g, '');
      const textWithoutSpaces = tableText.replace(/\s/g, '');

      if (tableText.includes('과세표준명세') ||
          tableText.includes('과세표준') ||
          normalizedText.includes('과세표준명세') ||
          textWithoutSpaces.includes('⑤과세표준명세') ||
          textWithoutSpaces.includes('⑤과세표준') ||
          (tableText.includes('⑤') && (tableText.includes('과세') || tableText.includes('표준')))) {
        targetTable = table;
        console.log('과세표준명세 테이블 발견 (업태 텍스트 검색 대상)');
        break;
      }
    }

    // 과세표준명세 테이블을 찾지 못했으면 모든 테이블에서 검색
    if (!targetTable) {
      console.log('과세표준명세 테이블을 찾지 못했습니다. 모든 테이블에서 검색합니다.');
      targetTable = document.body; // body 전체에서 검색
    }

    // "업" 또는 "태" 텍스트가 있는 모든 셀 찾기
    const allCells = targetTable.querySelectorAll('td');
    let foundCells = [];

    for (let j = 0; j < allCells.length; j++) {
      const cell = allCells[j];
      const cellText = cell.textContent || '';
      const normalizedText = cellText.replace(/\s+/g, '').trim();

      // "업" 또는 "태" 텍스트가 있는 셀 찾기 (정확히 일치하거나 포함)
      if (normalizedText === '업' || normalizedText === '태' ||
          cellText.trim() === '업' || cellText.trim() === '태' ||
          (cellText.includes('업') && cellText.includes('태')) ||
          normalizedText.includes('업태')) {
        foundCells.push(cell);
        console.log('업태 관련 셀 발견: "' + cellText.trim() + '"');
      }
    }

    if (foundCells.length === 0) {
      // 재시도하지 않음 (무한 루프 방지)
      console.log('업태 텍스트가 있는 셀을 찾지 못했습니다. (과세표준명세 테이블이 삭제되었을 수 있음)');
      businessTypeTextAlignmentAdjusted = true; // 플래그 설정하여 더 이상 시도하지 않음
      return;
    }

    // 찾은 모든 셀에 스타일 적용
    foundCells.forEach(function(cell) {
      // 셀 스타일 수정 (좌측 정렬, 좌측 여백 3pt, 글자 간격 제거)
      let cellStyle = cell.getAttribute('style') || '';
      cellStyle = cellStyle.replace(/padding-left\s*:\s*[^;]+;?/gi, '');
      cellStyle = cellStyle.replace(/text-align\s*:\s*[^;]+;?/gi, '');
      cellStyle = cellStyle.replace(/letter-spacing\s*:\s*[^;]+;?/gi, '');
      if (cellStyle && !cellStyle.endsWith(';') && cellStyle.trim() !== '') {
        cellStyle += ';';
      }
      cellStyle += 'padding-left:3pt !important;text-align:left !important;letter-spacing:0 !important;';
      cell.setAttribute('style', cellStyle);

      // 셀 내부의 텍스트 요소(p, span)에도 스타일 적용
      const textElements = cell.querySelectorAll('p, span');
      if (textElements.length > 0) {
        textElements.forEach(function(element) {
          let elementStyle = element.getAttribute('style') || '';
          elementStyle = elementStyle.replace(/text-align\s*:\s*[^;]+;?/gi, '');
          elementStyle = elementStyle.replace(/padding-left\s*:\s*[^;]+;?/gi, '');
          elementStyle = elementStyle.replace(/letter-spacing\s*:\s*[^;]+;?/gi, '');
          if (elementStyle && !elementStyle.endsWith(';') && elementStyle.trim() !== '') {
            elementStyle += ';';
          }
          elementStyle += 'text-align:left !important;padding-left:0 !important;letter-spacing:0 !important;';
          element.setAttribute('style', elementStyle);
        });
      } else {
        // p, span이 없으면 직접 텍스트 노드가 있을 수 있으므로 셀에 직접 스타일 적용
        console.log('셀 내부에 p, span 요소가 없습니다. 셀에 직접 스타일 적용');
      }
    });

    businessTypeTextAlignmentAdjusted = true; // 플래그 설정
    console.log('업태 텍스트 좌측 정렬 및 글자 간격 제거 설정 완료 (' + foundCells.length + '개 셀 처리)');
  }

  // 영세율 상호주의 텍스트 좌측 정렬 및 좌측 여백 3pt 설정
  function adjustZeroRateTextAlignment() {
    const allTables = document.querySelectorAll('table');

    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const cells = table.querySelectorAll('td');

      for (let j = 0; j < cells.length; j++) {
        const cell = cells[j];
        const cellText = cell.textContent || '';

        // "영세율 상호주의" 또는 "④ 영세율 상호주의" 또는 "4.영세율 상호주의" 텍스트가 포함된 셀 찾기
        if (cellText.includes('영세율 상호주의') ||
            (cellText.includes('④') && cellText.includes('영세율')) ||
            (cellText.includes('4.') && cellText.includes('영세율'))) {

          // 셀 스타일 수정
          let cellStyle = cell.getAttribute('style') || '';

          // 기존 padding-left 제거
          cellStyle = cellStyle.replace(/padding-left\s*:\s*[^;]+;?/gi, '');
          // 기존 text-align 제거
          cellStyle = cellStyle.replace(/text-align\s*:\s*[^;]+;?/gi, '');

          // padding-left: 3pt 추가
          if (cellStyle && !cellStyle.endsWith(';') && cellStyle.trim() !== '') {
            cellStyle += ';';
          }
          cellStyle += 'padding-left:3pt;';

          // text-align: left 추가
          cellStyle += 'text-align:left;';

          cell.setAttribute('style', cellStyle);

          // 셀 내부의 p 태그도 정렬
          const pTags = cell.querySelectorAll('p');
          pTags.forEach(function(p) {
            let pStyle = p.getAttribute('style') || '';
            pStyle = pStyle.replace(/text-align\s*:\s*[^;]+;?/gi, '');
            pStyle = pStyle.replace(/padding-left\s*:\s*[^;]+;?/gi, '');
            if (pStyle && !pStyle.endsWith(';') && pStyle.trim() !== '') {
              pStyle += ';';
            }
            pStyle += 'text-align:left;padding-left:0;';
            p.setAttribute('style', pStyle);
          });

          console.log('영세율 상호주의 텍스트 좌측 정렬 및 여백 설정 완료');
          return; // 첫 번째 매칭 셀만 처리
        }
      }
    }
  }

  // 잘못된 위치에 있는 폐업신고 테이블 정리
  function cleanupMisplacedClosureTables() {
    const allTables = document.querySelectorAll('table');

    // 영세율 상호주의 테이블 찾기
    let zeroRateTable = null;
    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const tableText = table.textContent || '';
      if (tableText.includes('영세율 상호주의') ||
          (tableText.includes('④') && tableText.includes('영세율'))) {
        zeroRateTable = table;
        break;
      }
    }

    // 영세율 상호주의 테이블 아래에 있는 신버전 폐업신고 테이블 삭제
    if (zeroRateTable) {
      let nextSibling = zeroRateTable.nextElementSibling;
      while (nextSibling) {
        if (nextSibling.nodeType === 1 && nextSibling.tagName === 'TABLE') {
          const table = nextSibling;
          if (table.classList && table.classList.contains('inserted-between-tables')) {
            const tableText = table.textContent || '';
            if (tableText.includes('폐업신고')) {
              console.log('영세율 상호주의 테이블 아래에 있는 잘못된 위치의 폐업신고 테이블 삭제');
              const toRemove = nextSibling;
              nextSibling = nextSibling.nextElementSibling;
              toRemove.remove();
              continue;
            }
          }
        }
        nextSibling = nextSibling.nextElementSibling;
      }
    }
  }

  // 위쪽에 있는 수정 전 폐업신고 테이블 삭제 (원본 HTML에 있던 테이블만 삭제)
  function removeOldClosureReportTable() {
    // 삭제 함수는 일시적으로 비활성화
    // 원본 HTML에 폐업신고 테이블이 있는지 확인 후 필요시 수동으로 삭제
    console.log('removeOldClosureReportTable 호출됨 (현재 비활성화됨)');
    return;

    /* 비활성화된 코드
    const allTables = document.querySelectorAll('table');
    let deletedCount = 0;

    // 국세환급금 계좌신고 테이블 찾기
    let accountReportTable = null;
    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const tableText = table.textContent || '';
      if (tableText.includes('국세환급금 계좌신고') ||
          (tableText.includes('②') && tableText.includes('국세환급금'))) {
        accountReportTable = table;
        break;
      }
    }

    if (!accountReportTable) {
      return;
    }

    // 국세환급금 계좌신고 테이블 다음에 있는 테이블들 확인
    let nextSibling = accountReportTable.nextElementSibling;
    while (nextSibling) {
      if (nextSibling.nodeType === 1 && nextSibling.tagName === 'TABLE') {
        const table = nextSibling;
        const tableText = table.textContent || '';

        // 폐업신고 텍스트가 있고, inserted-between-tables 클래스가 없는 테이블 삭제
        if (tableText.includes('폐업신고') &&
            (tableText.includes('③') || tableText.includes('3.'))) {
          if (!table.classList || !table.classList.contains('inserted-between-tables')) {
            console.log('위쪽 폐업신고 테이블 삭제');
            const toRemove = nextSibling;
            nextSibling = nextSibling.nextElementSibling;
            toRemove.remove();
            deletedCount++;
            continue;
          }
        }

        // 영세율 상호주의 테이블을 만나면 중단
        if (tableText.includes('영세율 상호주의')) {
          break;
        }
      }
      nextSibling = nextSibling.nextElementSibling;
    }

    if (deletedCount > 0) {
      console.log('총 ' + deletedCount + '개의 위쪽 폐업신고 테이블 삭제 완료');
    }
    */
  }

  // 국세환급금 계좌신고 테이블과 영세율 상호주의 테이블 사이에 1행 5열 테이블 삽입
  function insertTableBetweenAccountReportAndZeroRate() {
    const allTables = document.querySelectorAll('table');
    let accountReportTable = null;
    let zeroRateTable = null;
    let accountReportTableIndex = -1;
    let zeroRateTableIndex = -1;

    // "국세환급금 계좌신고" 테이블 찾기
    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const tableText = table.textContent || '';
      if (tableText.includes('국세환급금 계좌신고') ||
          (tableText.includes('②') && tableText.includes('국세환급금')) ||
          (tableText.includes('2.') && tableText.includes('국세환급금'))) {
        accountReportTable = table;
        accountReportTableIndex = i;
        console.log('국세환급금 계좌신고 테이블 발견 (인덱스: ' + i + ')');
        break;
      }
    }

    // "영세율 상호주의" 테이블 찾기
    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const tableText = table.textContent || '';
      if (tableText.includes('영세율 상호주의') ||
          (tableText.includes('④') && tableText.includes('영세율')) ||
          (tableText.includes('4.') && tableText.includes('영세율'))) {
        zeroRateTable = table;
        zeroRateTableIndex = i;
        console.log('영세율 상호주의 테이블 발견 (인덱스: ' + i + ')');
        break;
      }
    }

    // 국세환급금 계좌신고 테이블이 없으면 종료
    if (!accountReportTable) {
      console.log('국세환급금 계좌신고 테이블을 찾을 수 없습니다.');
      return;
    }

    // 국세환급금 계좌신고 테이블 바로 다음에 있는 구버전 폐업신고 테이블 삭제
    let nextSibling = accountReportTable.nextElementSibling;
    let deletedOldTable = false;
    let foundNewTable = false;

    while (nextSibling) {
      if (nextSibling.nodeType === 1 && nextSibling.tagName === 'TABLE') {
        const table = nextSibling;
        const tableText = table.textContent || '';

        // 폐업신고 텍스트가 있는 테이블 확인
        if (tableText.includes('폐업신고') &&
            (tableText.includes('③') || tableText.includes('3.'))) {
          // inserted-between-tables 클래스가 있는 테이블은 신버전
          if (table.classList && table.classList.contains('inserted-between-tables')) {
            console.log('이미 신버전 폐업신고 테이블이 있습니다.');
            foundNewTable = true;
            break;
          } else {
            // inserted-between-tables 클래스가 없는 테이블은 구버전이므로 삭제
            console.log('구버전 폐업신고 테이블 삭제');
            const toRemove = nextSibling;
            nextSibling = nextSibling.nextElementSibling;
            toRemove.remove();
            deletedOldTable = true;
            continue;
          }
        }

        // 영세율 상호주의 테이블을 만나면 중단
        if (tableText.includes('영세율 상호주의')) {
          break;
        }
      }
      nextSibling = nextSibling.nextElementSibling;
    }

    if (deletedOldTable) {
      console.log('구버전 폐업신고 테이블 삭제 완료');
    }

    // 이미 신버전 테이블이 있으면 생성하지 않음
    if (foundNewTable) {
      return;
    }

    // 이미 테이블이 삽입되었는지 다시 확인 (중복 방지)
    const checkNext = accountReportTable.nextElementSibling;
    if (checkNext &&
        checkNext.tagName === 'TABLE' &&
        checkNext.classList &&
        checkNext.classList.contains('inserted-between-tables')) {
      const checkText = checkNext.textContent || '';
      if (checkText.includes('폐업신고')) {
        console.log('이미 신버전 폐업신고 테이블이 삽입되어 있습니다.');
        return;
      }
    }

    // 위쪽 폐업신고 테이블 삭제는 비활성화 (테이블이 사라지는 문제 방지)
    // removeOldClosureReportTable();

    // 영세율 상호주의 테이블이 있는 경우 두 테이블이 인접한지 확인
    if (zeroRateTable && zeroRateTableIndex !== accountReportTableIndex + 1) {
      console.log('국세환급금 계좌신고 테이블과 영세율 상호주의 테이블이 인접하지 않습니다.');
    }

    // 새 테이블 생성 (1행 5열)
    const newTable = document.createElement('table');
    newTable.setAttribute('class', 'inserted-between-tables');
    newTable.setAttribute('style', 'width:624pt;border-collapse:collapse;margin:0;margin-top:2pt;margin-bottom:2pt;table-layout:fixed;box-sizing:border-box;');
    newTable.setAttribute('cellspacing', '0');

    // 1행 생성
    const newRow = document.createElement('tr');
    newRow.setAttribute('style', 'height:20pt');

    // 5열 생성 (1열: 150pt - 국세환급금 테이블과 동일, 나머지 4열: 118, 118, 119, 119)
    const columnWidths = [150, 118, 118, 119, 119]; // 합계: 624pt

    for (let c = 0; c < 5; c++) {
      const newCell = document.createElement('td');

      // 셀 스타일 설정
      let cellStyle = 'vertical-align:middle;width:' + columnWidths[c] + 'pt;';

      // 외곽선: 상하만 검정 (좌우 세로 테두리 제거)
      cellStyle += 'border-top:1pt solid #000;';
      cellStyle += 'border-bottom:1pt solid #000;';

      // 내부 간선: 좌우는 #7E7E7E (모든 열에 적용)
      if (c > 0) {
        cellStyle += 'border-left:1pt solid #7E7E7E;';
      }

      // 입력박스가 있는 셀은 position:relative로 설정
      if (c === 2 || c === 4) {
        cellStyle += 'position:relative;padding:0;margin:0;';
      }

      newCell.setAttribute('style', cellStyle);

      // 각 열에 맞는 내용 추가
      if (c === 0) {
        // 1열: ③ 폐업신고 (③는 일반, 폐업신고만 굵게, 10pt)
        newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;font-size: 10pt;padding-left: 3pt;">③ <span style="font-weight: bold;">폐업신고</span></p>';
      } else if (c === 1) {
        // 2열: 폐업일 (9pt, 중앙정렬)
        newCell.innerHTML = '<p style="text-indent: 0pt;text-align: center;font-size: 9pt;">폐업일</p>';
      } else if (c === 2) {
        // 3열: 입력박스
        newCell.innerHTML = '<input type="text" class="closure-date-input" />';
      } else if (c === 3) {
        // 4열: 폐업 사유 (중앙정렬)
        newCell.innerHTML = '<p style="text-indent: 0pt;text-align: center;font-size: 9pt;">폐업 사유</p>';
      } else if (c === 4) {
        // 5열: 입력박스
        newCell.innerHTML = '<input type="text" class="closure-reason-input" />';
      }

      newRow.appendChild(newCell);
    }

    newTable.appendChild(newRow);

    // 국세환급금 계좌신고 테이블 다음에 삽입
    if (accountReportTable.parentNode) {
      // 잘못된 위치에 있는 폐업신고 테이블 정리
      cleanupMisplacedClosureTables();

      // 이미 영세율 상호주의 밑에 있는 신버전 폐업신고 테이블이 있는지 확인하고 삭제
      const existingNewTables = document.querySelectorAll('table.inserted-between-tables');
      existingNewTables.forEach(function(existingTable) {
        if (existingTable !== newTable) {
          const tableText = existingTable.textContent || '';
          if (tableText.includes('폐업신고')) {
            console.log('잘못된 위치의 폐업신고 테이블 삭제');
            existingTable.remove();
          }
        }
      });

      accountReportTable.parentNode.insertBefore(newTable, accountReportTable.nextSibling);
      console.log('국세환급금 계좌신고 테이블 다음에 폐업신고 테이블 삽입 완료');

      // 폐업신고 테이블과 영세율 상호주의 테이블 사이 간격을 2pt로 설정
      setTimeout(function() {
        // 폐업신고 테이블과 영세율 상호주의 테이블 사이의 모든 요소 확인
        console.log('=== 폐업신고 테이블과 영세율 상호주의 테이블 사이 요소 확인 ===');
        let currentNode = newTable.nextSibling;
        let elementCount = 0;

        while (currentNode && currentNode !== zeroRateTable) {
          elementCount++;
          if (currentNode.nodeType === 1) {
            // 요소 노드
            console.log('요소 발견: ' + currentNode.tagName + ', 클래스: ' + (currentNode.className || '없음') + ', 스타일: ' + (currentNode.getAttribute('style') || '없음'));
            const computedStyle = window.getComputedStyle(currentNode);
            console.log('  - margin-top: ' + computedStyle.marginTop);
            console.log('  - margin-bottom: ' + computedStyle.marginBottom);
            console.log('  - height: ' + computedStyle.height);
            console.log('  - display: ' + computedStyle.display);
          } else if (currentNode.nodeType === 3) {
            // 텍스트 노드
            const text = currentNode.textContent.trim();
            if (text) {
              console.log('텍스트 노드 발견: "' + text.substring(0, 50) + '"');
            }
          }
          currentNode = currentNode.nextSibling;
        }

        if (elementCount === 0) {
          console.log('폐업신고 테이블과 영세율 상호주의 테이블 사이에 다른 요소가 없습니다.');
        } else {
          console.log('총 ' + elementCount + '개의 요소/노드가 사이에 있습니다.');
        }

        let tableStyle = newTable.getAttribute('style') || '';
        // margin-bottom을 2pt로 명시적으로 설정
        tableStyle = tableStyle.replace(/margin-bottom\s*:\s*[^;]+;?/gi, '');
        if (tableStyle && !tableStyle.endsWith(';') && tableStyle.trim() !== '') {
          tableStyle += ';';
        }
        tableStyle += 'margin-bottom:2pt;';
        newTable.setAttribute('style', tableStyle);

        // 영세율 상호주의 테이블의 margin-top도 확인 (필요시 설정)
        if (zeroRateTable) {
          let zeroRateStyle = zeroRateTable.getAttribute('style') || '';
          const computedStyle = window.getComputedStyle(zeroRateTable);
          console.log('영세율 상호주의 테이블 스타일:');
          console.log('  - margin-top: ' + computedStyle.marginTop);
          console.log('  - margin-bottom: ' + computedStyle.marginBottom);

          // margin-top이 없거나 0이면 설정하지 않음 (폐업신고 테이블의 margin-bottom으로 간격 조절)
          // 만약 margin-top이 설정되어 있다면 제거하여 폐업신고 테이블의 margin-bottom만 사용
          zeroRateStyle = zeroRateStyle.replace(/margin-top\s*:\s*[^;]+;?/gi, '');
          zeroRateTable.setAttribute('style', zeroRateStyle);
        }

        // 폐업신고 테이블의 실제 margin-bottom 확인
        const computedStyle = window.getComputedStyle(newTable);
        console.log('폐업신고 테이블 실제 스타일:');
        console.log('  - margin-bottom: ' + computedStyle.marginBottom);
        console.log('  - margin-top: ' + computedStyle.marginTop);

        console.log('폐업신고 테이블과 영세율 상호주의 테이블 사이 간격 2pt 설정 완료');

        // 폐업신고 테이블 아래에 1행 8열 테이블 추가 (테이블 객체 직접 전달)
        insertTableBelowClosureReport(newTable);
      }, 10);
    } else {
      console.log('테이블의 부모 노드를 찾을 수 없습니다.');
    }
  }

  // 영세율 상호주의 테이블 아래에 6열 7행 테이블 추가
  // 테이블 생성 완료 플래그 (병합 보호를 위해)
  let belowZeroRateTableCreated = false;

  // 6열 1행에 텍스트 삽입 함수 (전역 함수로 이동)
  window.insertTextToColumn6Global = function() {
    console.log('=== insertTextToColumn6Global 함수 실행 시작 ===');
    const newTable = document.querySelector('table.below-zero-rate-table[data-below-zero-rate="true"]');
    console.log('newTable:', newTable);

    if (!newTable) {
      console.log('텍스트 삽입: newTable을 찾을 수 없음');
      return false;
    }

    // 브라우저가 자동으로 tbody를 추가할 수 있으므로 여러 방법으로 시도
    let firstRow = newTable.querySelector('tbody tr:first-child') ||
                   newTable.querySelector('tr:first-child') ||
                   newTable.querySelector('tr') ||
                   (newTable.rows && newTable.rows.length > 0 ? newTable.rows[0] : null) ||
                   null;

    console.log('firstRow:', firstRow);
    console.log('테이블 구조 확인:', {
      hasTbody: !!newTable.querySelector('tbody'),
      tbodyTrCount: newTable.querySelector('tbody') ? newTable.querySelector('tbody').querySelectorAll('tr').length : 0,
      allTrCount: newTable.querySelectorAll('tr').length,
      rowsLength: newTable.rows ? newTable.rows.length : 0
    });

    if (!firstRow) {
      console.log('텍스트 삽입: 첫 번째 행을 찾을 수 없음');
      // 테이블 구조를 더 자세히 출력
      console.log('테이블 HTML:', newTable.outerHTML.substring(0, 500));
      return false;
    }
    const cells = firstRow.querySelectorAll('td');
    console.log('첫 번째 행의 셀 개수:', cells.length);
    console.log('첫 번째 행의 모든 셀:', cells);

    if (cells.length < 1) {
      console.log('텍스트 삽입: 셀 개수가 부족함');
      console.log('firstRow.innerHTML:', firstRow.innerHTML);
      console.log('firstRow.children:', firstRow.children);
      return false;
    }

    // 6열 셀 변수 선언
    let col6Cell = null;

    // 1행 1열~5열 병합 강제 설정 (colspan="5")
    // 중요: 셀 개수가 2개 이상이면 무조건 병합을 다시 실행해야 함
    if (cells.length > 0) {
      const firstCell = cells[0];
      const currentColspan = firstCell.getAttribute('colspan');

      // 셀 개수가 2개보다 많으면 병합이 깨진 것이므로 무조건 재병합
      if (cells.length > 2 || currentColspan !== '5') {
        console.log('1행 1열~5열 병합 강제 설정: colspan="5" (현재 값: ' + currentColspan + ', 셀 개수: ' + cells.length + ')');
        firstCell.setAttribute('colspan', '5');
        firstCell.removeAttribute('rowspan');

        // 1행에서 2~5열 셀 제거 (colspan 병합을 위해)
        // 단순화: 첫 번째 셀(colspan=5)과 마지막 셀(6열)만 남기고 나머지 모두 제거
        const cellsArray = Array.from(cells);
        let removedCount = 0;

        // 첫 번째 셀(colspan=5)과 마지막 셀(6열)을 제외한 모든 셀 제거
        // 인덱스 0: 첫 번째 셀 (colspan=5, 유지)
        // 인덱스 1~length-2: 중간 셀들 (제거)
        // 인덱스 length-1: 마지막 셀 (6열, 유지)
        for (let i = cellsArray.length - 2; i >= 1; i--) {
          const cell = cellsArray[i];
          console.log('1행에서 셀 제거: 인덱스 ' + i);
          cell.remove();
          removedCount++;
        }
        console.log('1행에서 제거된 셀 개수: ' + removedCount + ' (예상: ' + (cellsArray.length - 2) + ')');

        // 셀 목록 다시 가져오기
        const updatedCells = firstRow.querySelectorAll('td');
        console.log('병합 후 첫 번째 행의 셀 개수:', updatedCells.length);
        console.log('병합 후 첫 번째 행의 모든 셀:', updatedCells);

        // 병합 후에도 셀 개수가 2개보다 많으면 다시 제거 시도
        if (updatedCells.length > 2) {
          console.log('경고: 병합 후에도 셀 개수가 2개보다 많습니다. 추가 제거 시도...');
          const cellsArray2 = Array.from(updatedCells);
          for (let i = cellsArray2.length - 2; i >= 1; i--) {
            const cell = cellsArray2[i];
            console.log('추가 제거: 인덱스 ' + i);
            cell.remove();
          }
          // 셀 목록 다시 가져오기
          const finalCells = firstRow.querySelectorAll('td');
          console.log('추가 제거 후 첫 번째 행의 셀 개수:', finalCells.length);

          if (finalCells.length >= 1) {
            col6Cell = finalCells[finalCells.length - 1];
            console.log('6열 셀을 찾았습니다 (추가 제거 후 마지막 셀, 인덱스: ' + (finalCells.length - 1) + ')');
          } else {
            console.log('경고: 추가 제거 후 셀 개수가 부족합니다.');
            return false;
          }
        } else if (updatedCells.length >= 1) {
          // 마지막 셀이 6열
          col6Cell = updatedCells[updatedCells.length - 1];
          console.log('6열 셀을 찾았습니다 (병합 후 마지막 셀, 인덱스: ' + (updatedCells.length - 1) + ')');

          // 6열 셀인지 확인 (실제 열 위치 계산)
          let colIndex = 0;
          for (let i = 0; i < updatedCells.length - 1; i++) {
            colIndex += parseInt(updatedCells[i].getAttribute('colspan') || '1');
          }
          console.log('6열 셀의 실제 열 위치:', colIndex, '(첫 번째 셀 colspan: ' + (updatedCells[0] ? updatedCells[0].getAttribute('colspan') : 'null') + ')');

          if (colIndex !== 5) {
            console.log('경고: 마지막 셀이 6열이 아닙니다! 실제 열 위치: ' + colIndex);
          }
        } else {
          console.log('경고: 병합 후 셀 개수가 부족합니다.');
          return false;
        }
      } else {
        // 이미 병합되어 있으면 마지막 셀이 6열
        console.log('1행 1열~5열은 이미 병합되어 있습니다.');
        if (cells.length >= 1) {
          // 마지막 셀이 6열
          col6Cell = cells[cells.length - 1];
          console.log('6열 셀을 찾았습니다 (이미 병합됨, 마지막 셀, 인덱스: ' + (cells.length - 1) + ')');

          // 6열 셀인지 확인 (실제 열 위치 계산)
          let colIndex = 0;
          for (let i = 0; i < cells.length - 1; i++) {
            colIndex += parseInt(cells[i].getAttribute('colspan') || '1');
          }
          console.log('6열 셀의 실제 열 위치:', colIndex);

          if (colIndex !== 5) {
            console.log('경고: 마지막 셀이 6열이 아닙니다! 실제 열 위치: ' + colIndex);
            // 각 셀의 실제 열 위치 계산하여 6열 찾기
            let currentColIndex = 0;
            for (let i = 0; i < cells.length; i++) {
              const cell = cells[i];
              const cellColspan = parseInt(cell.getAttribute('colspan') || '1');
              const cellStartCol = currentColIndex;
              const cellEndCol = currentColIndex + cellColspan - 1;

              console.log(`셀 ${i}: colspan=${cellColspan}, 시작열=${cellStartCol}, 끝열=${cellEndCol}, rowspan=${cell.getAttribute('rowspan') || 'null'}`);

              // 6열(인덱스 5)이 이 셀의 범위에 포함되는지 확인
              if (cellStartCol <= 5 && cellEndCol >= 5) {
                col6Cell = cell;
                console.log(`6열 셀을 찾았습니다! 셀 인덱스: ${i}, 실제 열 위치: ${cellStartCol}-${cellEndCol}`);
                break;
              }

              currentColIndex += cellColspan;
            }
          }
        } else {
          // 각 셀의 실제 열 위치 계산
          let currentColIndex = 0;
          for (let i = 0; i < cells.length; i++) {
            const cell = cells[i];
            const cellColspan = parseInt(cell.getAttribute('colspan') || '1');
            const cellStartCol = currentColIndex;
            const cellEndCol = currentColIndex + cellColspan - 1;

            console.log(`셀 ${i}: colspan=${cellColspan}, 시작열=${cellStartCol}, 끝열=${cellEndCol}, rowspan=${cell.getAttribute('rowspan') || 'null'}`);

            // 6열(인덱스 5)이 이 셀의 범위에 포함되는지 확인
            if (cellStartCol <= 5 && cellEndCol >= 5) {
              col6Cell = cell;
              console.log(`6열 셀을 찾았습니다! 셀 인덱스: ${i}, 실제 열 위치: ${cellStartCol}-${cellEndCol}`);
              break;
            }

            currentColIndex += cellColspan;
          }
        }
      }
    }

    console.log('col6Cell:', col6Cell);
    console.log('col6Cell rowspan:', col6Cell ? col6Cell.getAttribute('rowspan') : 'null');
    console.log('col6Cell colspan:', col6Cell ? col6Cell.getAttribute('colspan') : 'null');

    if (!col6Cell) {
      console.log('텍스트 삽입: 6열 셀을 찾을 수 없음');
      return false;
    }

    // rowspan="6" 강제 설정 (텍스트 삽입 전)
    if (col6Cell.getAttribute('rowspan') !== '6') {
      console.log('6열 셀에 rowspan="6" 강제 설정');
      col6Cell.setAttribute('rowspan', '6');
      col6Cell.removeAttribute('colspan');

      // 2~6행에서 6열 셀 제거
      const allRowsForRowspan = newTable.querySelectorAll('tr');
      for (let r = 1; r <= 5 && r < allRowsForRowspan.length; r++) {
        const row = allRowsForRowspan[r];
        const rowCells = Array.from(row.querySelectorAll('td'));
        let currentColIndex = 0;

        for (let j = 0; j < rowCells.length; j++) {
          const cell = rowCells[j];
          const cellColspan = parseInt(cell.getAttribute('colspan') || '1');
          const cellStartCol = currentColIndex;
          const cellEndCol = currentColIndex + cellColspan - 1;

          if (cellStartCol <= 5 && cellEndCol >= 5) {
            console.log(`2~6행에서 6열 셀 제거: 행 ${r+1}, 셀 인덱스 ${j}`);
            cell.remove();
            break;
          }

          currentColIndex += cellColspan;
        }
      }
    }

    // 이미 텍스트가 있는지 확인 (더 관대한 조건)
    const existingText = col6Cell.querySelector('div[style*="font-size: 9pt"]');
    if (existingText) {
      console.log('텍스트 삽입: 이미 텍스트가 있음');
      // 텍스트가 있어도 rowspan 확인 및 재설정
      if (col6Cell.getAttribute('rowspan') !== '6') {
        console.log('텍스트는 있지만 rowspan이 깨졌습니다. 재설정합니다.');
        col6Cell.setAttribute('rowspan', '6');
        col6Cell.removeAttribute('colspan');
      }
      return true;
    }

    console.log('6열 1행에 텍스트 삽입 시작');

    // 텍스트 구조 생성
    const container = document.createElement('div');
    container.setAttribute('style', 'font-size: 9pt;padding: 3pt;padding-left: 5pt;line-height: 0.9;');

    // 첫 번째 문단
    const p1 = document.createElement('p');
    p1.setAttribute('style', 'text-indent: 0pt;text-align: left;margin: 0;padding-left: 6pt;letter-spacing: -0.05em;');
    p1.appendChild(document.createTextNode('「부가가치세법」 제48조ㆍ제49조 또는 제59조와 「국세기본법」 제45조 의3에 따라 위의 내용을 신고하며, '));
    const boldSpan1 = document.createElement('span');
    boldSpan1.setAttribute('style', 'font-weight: bold;');
    boldSpan1.textContent = '위 내용을 충분히 검토하였고 신고인이 알고 있는 사실 그대로를 정확하게 적었음을 확인합니다.';
    p1.appendChild(boldSpan1);
    container.appendChild(p1);

    // 년월일 입력 행
    const dateRow = document.createElement('div');
    dateRow.setAttribute('style', 'text-align: right;margin: 2pt 0;');

    const yearInput = document.createElement('input');
    yearInput.setAttribute('type', 'text');
    yearInput.setAttribute('maxLength', '4');
    yearInput.className = 'cell-input';
    yearInput.setAttribute('style', 'width: 24pt; height: 9pt; border: 1pt solid transparent; outline: none; padding: 0; margin: 0; font-size: 9pt; font-family: Arial, sans-serif; text-align: center; background: transparent; box-sizing: border-box; display: inline-block; vertical-align: middle; line-height: 1em;');
    yearInput.addEventListener('focus', function(e) { e.target.style.border = '1pt solid #808080'; });
    yearInput.addEventListener('blur', function(e) { e.target.style.border = '1pt solid transparent'; });
    dateRow.appendChild(yearInput);
    dateRow.appendChild(document.createTextNode('년 '));

    const monthInput = document.createElement('input');
    monthInput.setAttribute('type', 'text');
    monthInput.setAttribute('maxLength', '2');
    monthInput.className = 'cell-input';
    monthInput.setAttribute('style', 'width: 16pt; height: 9pt; border: 1pt solid transparent; outline: none; padding: 0; margin: 0; font-size: 9pt; font-family: Arial, sans-serif; text-align: center; background: transparent; box-sizing: border-box; display: inline-block; vertical-align: middle; line-height: 1em;');
    monthInput.addEventListener('focus', function(e) { e.target.style.border = '1pt solid #808080'; });
    monthInput.addEventListener('blur', function(e) { e.target.style.border = '1pt solid transparent'; });
    dateRow.appendChild(monthInput);
    dateRow.appendChild(document.createTextNode('월 '));

    const dayInput = document.createElement('input');
    dayInput.setAttribute('type', 'text');
    dayInput.setAttribute('maxLength', '2');
    dayInput.className = 'cell-input';
    dayInput.setAttribute('style', 'width: 16pt; height: 9pt; border: 1pt solid transparent; outline: none; padding: 0; margin: 0; font-size: 9pt; font-family: Arial, sans-serif; text-align: center; background: transparent; box-sizing: border-box; display: inline-block; vertical-align: middle; line-height: 1em;');
    dayInput.addEventListener('focus', function(e) { e.target.style.border = '1pt solid #808080'; });
    dayInput.addEventListener('blur', function(e) { e.target.style.border = '1pt solid transparent'; });
    dateRow.appendChild(dayInput);
    dateRow.appendChild(document.createTextNode('일'));
    container.appendChild(dateRow);

    // 신고인 행
    const p2 = document.createElement('p');
    p2.setAttribute('style', 'text-indent: 0pt;text-align: right;margin: 0;margin-left: 10pt;position: relative;');
    p2.appendChild(document.createTextNode('신고인: '));
    const signInput1 = document.createElement('input');
    signInput1.setAttribute('type', 'text');
    signInput1.className = 'cell-input';
    signInput1.setAttribute('style', 'width: 80pt; height: 20pt; border: 1pt solid transparent; outline: none; padding: 0; margin: 0 20pt; font-size: 9pt; font-family: Arial, sans-serif; text-align: center; background: transparent; box-sizing: border-box; display: inline-block; vertical-align: middle; line-height: 1em;');
    signInput1.addEventListener('focus', function(e) { e.target.style.border = '1pt solid #808080'; });
    signInput1.addEventListener('blur', function(e) { e.target.style.border = '1pt solid transparent'; });
    p2.appendChild(signInput1);

    // (서명 또는 인) 텍스트를 클릭 가능한 span으로 감싸기
    const signTextSpan1 = document.createElement('span');
    signTextSpan1.style.cursor = 'pointer';
    signTextSpan1.style.position = 'relative';
    signTextSpan1.appendChild(document.createTextNode(' (서명 또는 인)'));
    signTextSpan1.addEventListener('click', function(e) {
      e.stopPropagation(); // 이벤트 전파 방지
      e.preventDefault(); // 기본 동작 방지

      // 기존 입력박스가 있으면 제거
      const existingBox1 = p2.querySelector('.stamp-input-box');
      if (existingBox1) {
        existingBox1.remove();
        return;
      }

      // 텍스트 span의 위치를 기준으로 박스 위치 계산 (60pt = 약 80px, 1pt ≈ 1.33px)
      const spanRect = signTextSpan1.getBoundingClientRect();
      const pRect = p2.getBoundingClientRect();
      const spanTop = spanRect.top - pRect.top;
      const spanRight = pRect.right - spanRect.right;
      const spanHeight = spanRect.height;
      const boxSize = 80; // 60pt ≈ 80px

      // 새로운 입력박스 생성 (박스의 바닥선이 텍스트의 바닥에 걸치게)
      const stampBox1 = document.createElement('div');
      stampBox1.className = 'stamp-input-box';
      // 텍스트의 오른쪽 끝을 기준으로 좌측으로 60pt, 박스의 bottom이 텍스트의 bottom과 맞춤
      stampBox1.setAttribute('style', 'position: absolute; display: block; width: 60pt; height: 60pt; min-width: 60pt; min-height: 60pt; max-width: 60pt; max-height: 60pt; background: transparent; border: none; outline: none; right: ' + spanRight + 'px; top: ' + (spanTop + spanHeight - boxSize) + 'px; cursor: pointer; box-sizing: border-box;');

      // hover 시 테두리 표시
      stampBox1.addEventListener('mouseenter', function(e) {
        e.target.style.border = '0.5pt solid #808080';
      });
      stampBox1.addEventListener('mouseleave', function(e) {
        e.target.style.border = 'none';
      });

      // 이미지를 표시할 영역 (백엔드에서 이미지를 뿌려줄 수 있도록)
      const stampImg1 = document.createElement('img');
      stampImg1.setAttribute('style', 'width: 100%; height: 100%; object-fit: contain; display: none;');
      stampImg1.className = 'stamp-image';
      stampBox1.appendChild(stampImg1);

      p2.appendChild(stampBox1);
    });
    p2.appendChild(signTextSpan1);
    container.appendChild(p2);

    const line1 = document.createElement('div');
    line1.setAttribute('style', 'height: 2pt; background-color: #808080; margin: 0; margin-left: 4pt; margin-right: 0;');
    container.appendChild(line1);

    // 세무대리인 문단
    const p3 = document.createElement('p');
    p3.setAttribute('style', 'text-indent: 0pt;text-align: left;margin: 0;padding-left: 6pt;');
    const boldSpan2 = document.createElement('span');
    boldSpan2.setAttribute('style', 'font-weight: bold;');
    boldSpan2.textContent = '세무대리인은 조세전문자격자로서 위 신고서를 성실하고 공정하게 작성 하였음을 확인합니다.';
    p3.appendChild(boldSpan2);
    container.appendChild(p3);

    // 세무대리인 행
    const p4 = document.createElement('p');
    p4.setAttribute('style', 'text-indent: 0pt;text-align: right;margin: 0;margin-left: 10pt;position: relative;');
    p4.appendChild(document.createTextNode('세무대리인: '));
    const signInput2 = document.createElement('input');
    signInput2.setAttribute('type', 'text');
    signInput2.className = 'cell-input';
    signInput2.setAttribute('style', 'width: 80pt; height: 20pt; border: 1pt solid transparent; outline: none; padding: 0; margin: 0 20pt; font-size: 9pt; font-family: Arial, sans-serif; text-align: center; background: transparent; box-sizing: border-box; display: inline-block; vertical-align: middle; line-height: 1em;');
    signInput2.addEventListener('focus', function(e) { e.target.style.border = '1pt solid #808080'; });
    signInput2.addEventListener('blur', function(e) { e.target.style.border = '1pt solid transparent'; });
    p4.appendChild(signInput2);

    // (서명 또는 인) 텍스트를 클릭 가능한 span으로 감싸기
    const signTextSpan2 = document.createElement('span');
    signTextSpan2.style.cursor = 'pointer';
    signTextSpan2.style.position = 'relative';
    signTextSpan2.appendChild(document.createTextNode(' (서명 또는 인)'));
    signTextSpan2.addEventListener('click', function(e) {
      e.stopPropagation(); // 이벤트 전파 방지
      e.preventDefault(); // 기본 동작 방지

      // 기존 입력박스가 있으면 제거
      const existingBox2 = p4.querySelector('.stamp-input-box');
      if (existingBox2) {
        existingBox2.remove();
        return;
      }

      // 텍스트 span의 위치를 기준으로 박스 위치 계산 (60pt = 약 80px, 1pt ≈ 1.33px)
      const spanRect = signTextSpan2.getBoundingClientRect();
      const pRect = p4.getBoundingClientRect();
      const spanTop = spanRect.top - pRect.top;
      const spanRight = pRect.right - spanRect.right;
      const spanHeight = spanRect.height;
      const offset10pt = 13.3; // 10pt ≈ 13.3px

      // 새로운 입력박스 생성 (박스의 위쪽이 텍스트에 걸쳐지게, 10pt 위로 올림)
      const stampBox2 = document.createElement('div');
      stampBox2.className = 'stamp-input-box';
      // 텍스트의 오른쪽 끝을 기준으로 좌측으로 60pt, 박스의 top이 텍스트의 top에서 10pt 위로
      stampBox2.setAttribute('style', 'position: absolute; display: block; width: 60pt; height: 60pt; min-width: 60pt; min-height: 60pt; max-width: 60pt; max-height: 60pt; background: transparent; border: none; outline: none; right: ' + spanRight + 'px; top: ' + (spanTop - offset10pt) + 'px; cursor: pointer; box-sizing: border-box;');

      // hover 시 테두리 표시
      stampBox2.addEventListener('mouseenter', function(e) {
        e.target.style.border = '0.5pt solid #808080';
      });
      stampBox2.addEventListener('mouseleave', function(e) {
        e.target.style.border = 'none';
      });

      // 이미지를 표시할 영역 (백엔드에서 이미지를 뿌려줄 수 있도록)
      const stampImg2 = document.createElement('img');
      stampImg2.setAttribute('style', 'width: 100%; height: 100%; object-fit: contain; display: none;');
      stampImg2.className = 'stamp-image';
      stampBox2.appendChild(stampImg2);

      p4.appendChild(stampBox2);
    });
    p4.appendChild(signTextSpan2);
    container.appendChild(p4);

    const line2 = document.createElement('div');
    line2.setAttribute('style', 'height: 2pt; background-color: #808080; margin: 0; margin-left: 4pt; margin-right: 0;');
    container.appendChild(line2);

    // 세무서장 행
    const p5 = document.createElement('p');
    p5.setAttribute('style', 'text-indent: 0pt;text-align: left;margin: 0;padding-left: 10pt;font-size: 12pt;font-weight: bold;');
    p5.appendChild(document.createTextNode('세무서장 '));
    const span3 = document.createElement('span');
    span3.setAttribute('style', 'font-size: 10pt;font-weight: normal;');
    span3.textContent = '귀하';
    p5.appendChild(span3);
    container.appendChild(p5);

    // 텍스트 삽입 전에 rowspan 재확인 및 강제 설정
    // MutationObserver가 방해하지 않도록 플래그 설정
    if (typeof window !== 'undefined') {
      window.isInsertingTextToCol6 = true;
    }

    console.log('텍스트 삽입 전 col6Cell 상태:', {
      innerHTML: col6Cell.innerHTML.substring(0, 100),
      childrenCount: col6Cell.children.length,
      rowspan: col6Cell.getAttribute('rowspan'),
      colspan: col6Cell.getAttribute('colspan'),
      containerChildren: container.children.length
    });

    // rowspan을 먼저 강제 설정 (텍스트 삽입 전)
    col6Cell.setAttribute('rowspan', '6');
    col6Cell.removeAttribute('colspan');
    console.log('rowspan 설정 완료: ' + col6Cell.getAttribute('rowspan'));

    // 2~6행에서 6열 셀 제거 (rowspan 병합을 위해)
    const allRows = newTable.querySelectorAll('tr');
    for (let r = 1; r <= 5 && r < allRows.length; r++) {
      const row = allRows[r];
      const rowCells = Array.from(row.querySelectorAll('td'));
      let currentColIndex = 0;

      for (let j = 0; j < rowCells.length; j++) {
        const cell = rowCells[j];
        const cellColspan = parseInt(cell.getAttribute('colspan') || '1');
        const cellStartCol = currentColIndex;
        const cellEndCol = currentColIndex + cellColspan - 1;

        if (cellStartCol <= 5 && cellEndCol >= 5) {
          console.log(`2~6행에서 6열 셀 제거: 행 ${r+1}, 셀 인덱스 ${j}`);
          cell.remove();
          break;
        }

        currentColIndex += cellColspan;
      }
    }

    // 텍스트 삽입
    console.log('innerHTML 초기화 전');
    col6Cell.innerHTML = '';
    console.log('innerHTML 초기화 후, appendChild 전');
    col6Cell.appendChild(container);
    console.log('appendChild 완료');

    // 텍스트 삽입 후 rowspan 재설정 (중요!)
    col6Cell.setAttribute('rowspan', '6');
    col6Cell.removeAttribute('colspan');
    console.log('텍스트 삽입 후 rowspan 재설정: ' + col6Cell.getAttribute('rowspan'));

    console.log('텍스트 삽입 직후 col6Cell 상태:', {
      innerHTML: col6Cell.innerHTML.substring(0, 200),
      childrenCount: col6Cell.children.length,
      hasContainer: !!col6Cell.querySelector('div[style*="font-size: 9pt"]'),
      firstChild: col6Cell.firstChild ? col6Cell.firstChild.tagName : 'null',
      rowspan: col6Cell.getAttribute('rowspan')
    });

    // 플래그 해제
    if (typeof window !== 'undefined') {
      setTimeout(function() {
        window.isInsertingTextToCol6 = false;
      }, 100);
    }

    // 최종 확인
    const finalCheck = col6Cell.querySelector('div[style*="font-size: 9pt"]');
    console.log('6열 1행에 텍스트 삽입 완료. 최종 확인:', {
      hasText: !!finalCheck,
      containerChildren: container.children.length,
      col6CellChildren: col6Cell.children.length,
      col6CellInnerHTML: col6Cell.innerHTML.substring(0, 300)
    });

    // 2~6행에서 6열 셀 제거 확인
    const allRowsForCheck = newTable.querySelectorAll('tr');
    for (let r = 1; r <= 5 && r < allRowsForCheck.length; r++) {
      const row = allRowsForCheck[r];
      const rowCells = Array.from(row.querySelectorAll('td'));
      let currentColIndex = 0;

      for (let j = 0; j < rowCells.length; j++) {
        const cell = rowCells[j];
        const cellColspan = parseInt(cell.getAttribute('colspan') || '1');
        const cellStartCol = currentColIndex;
        const cellEndCol = currentColIndex + cellColspan - 1;

        if (cellStartCol <= 5 && cellEndCol >= 5) {
          cell.remove();
          break;
        }

        currentColIndex += cellColspan;
      }
    }

    return true;
  }

  function insertTableBelowZeroRate() {
    console.log('=== insertTableBelowZeroRate 함수 실행 시작 ===');
    // 이미 테이블이 생성되었고 올바른 위치에 있으면 재생성하지 않음 (병합 보호)
    // 플래그가 설정되어 있으면 무조건 재생성하지 않음
    if (belowZeroRateTableCreated) {
      const existingTable = document.querySelector('table.below-zero-rate-table[data-below-zero-rate="true"]');
      if (existingTable) {
        // 테이블이 존재하면 재생성하지 않음 (6열 병합 보호)
        console.log('insertTableBelowZeroRate: 테이블이 이미 생성되어 있습니다. 재생성하지 않습니다. (6열 병합 보호)');
        // 테이블이 이미 있으면 텍스트 삽입만 시도
        console.log('기존 테이블에 텍스트 삽입 시도');
        if (typeof window.insertTextToColumn6Global === 'function') {
          window.insertTextToColumn6Global();
          setTimeout(function() { window.insertTextToColumn6Global(); }, 100);
          setTimeout(function() { window.insertTextToColumn6Global(); }, 500);
        }
        return;
      } else {
        // 테이블이 삭제되었을 수 있으므로 플래그 리셋
        belowZeroRateTableCreated = false;
      }
    }

    // 영세율 상호주의 테이블 찾기 (여러 방법으로 시도)
    let zeroRateTable = null;

    // 방법 1: closure-report-detail-table 클래스로 찾기
    zeroRateTable = document.querySelector('table.closure-report-detail-table');

    // 방법 2: 텍스트로 찾기
    if (!zeroRateTable) {
      const allTables = document.querySelectorAll('table');
      for (let i = 0; i < allTables.length; i++) {
        const table = allTables[i];
        const tableText = table.textContent || '';
        if (tableText.includes('영세율 상호주의') ||
            (tableText.includes('④') && tableText.includes('영세율')) ||
            (tableText.includes('4.') && tableText.includes('영세율'))) {
          zeroRateTable = table;
          console.log('영세율 상호주의 테이블을 텍스트로 찾았습니다.');
          break;
        }
      }
    }

    // 방법 3: 셀 내부 텍스트로 찾기
    if (!zeroRateTable) {
      const allTables = document.querySelectorAll('table');
      for (let i = 0; i < allTables.length; i++) {
        const table = allTables[i];
        const cells = table.querySelectorAll('td');
        for (let j = 0; j < cells.length; j++) {
          const cellText = cells[j].textContent || '';
          if (cellText.includes('영세율 상호주의') ||
              (cellText.includes('④') && cellText.includes('영세율'))) {
            zeroRateTable = table;
            console.log('영세율 상호주의 테이블을 셀 텍스트로 찾았습니다.');
            break;
          }
        }
        if (zeroRateTable) break;
      }
    }

    if (!zeroRateTable) {
      console.log('영세율 상호주의 테이블을 찾을 수 없습니다. 잠시 후 다시 시도합니다.');
      // 1초 후 다시 시도
      setTimeout(function() {
        insertTableBelowZeroRate();
      }, 1000);
      return;
    }

    // 이미 테이블이 올바른 위치에 있는지 확인 (중복 방지)
    const existingTables = document.querySelectorAll('table.below-zero-rate-table');
    if (existingTables.length > 0) {
      // 영세율 상호주의 테이블 바로 다음에 올바르게 위치한 테이블이 있는지 확인
      let correctlyPlacedTable = null;
      for (let i = 0; i < existingTables.length; i++) {
        const existingTable = existingTables[i];
        // 이전 형제가 영세율 상호주의 테이블인지 확인
        if (existingTable.previousElementSibling === zeroRateTable) {
          correctlyPlacedTable = existingTable;
          console.log('영세율 상호주의 테이블 아래 테이블이 이미 올바른 위치에 있습니다.');
          break;
        }
      }

      // 올바른 위치에 테이블이 있으면 그대로 유지하고 종료
      // 6열 병합이 이미 설정되어 있으므로 재생성하지 않음 (병합 해제 방지)
      if (correctlyPlacedTable) {
        console.log('영세율 상호주의 테이블 아래 테이블이 이미 올바른 위치에 있습니다. 재생성하지 않습니다. (6열 병합 보호)');
        // 플래그 설정하여 이후 호출에서도 재생성하지 않도록 함
        belowZeroRateTableCreated = true;
        return;
      }

      // 잘못된 위치에 있는 테이블들만 삭제
      // 하지만 올바른 위치에 있는 테이블이 있으면 삭제하지 않음
      if (!correctlyPlacedTable) {
        console.log('잘못된 위치의 테이블 발견 (' + existingTables.length + '개). 삭제 후 재생성합니다.');
        existingTables.forEach(function(table) {
          table.remove();
        });
      }
    }

    // 새 테이블 생성 (6열 7행)
    const newTable = document.createElement('table');
    newTable.setAttribute('class', 'below-zero-rate-table');

    // 영세율 상호주의 테이블의 margin-left와 width를 확인하여 동일하게 설정
    const zeroRateTableStyle = zeroRateTable.getAttribute('style') || '';
    const zeroRateMarginLeft = zeroRateTableStyle.match(/margin-left\s*:\s*([^;]+)/i);
    const marginLeftValue = zeroRateMarginLeft ? zeroRateMarginLeft[1].trim() : '0';

    // 영세율 상호주의 테이블의 실제 width를 읽어옴
    const zeroRateWidthMatch = zeroRateTableStyle.match(/width\s*:\s*([^;]+)/i);
    let zeroRateTableWidth = 624; // 기본값
    if (zeroRateWidthMatch) {
      const widthValue = zeroRateWidthMatch[1].trim();
      zeroRateTableWidth = parseFloat(widthValue) || 624;
    } else {
      const zeroRateComputedStyle = window.getComputedStyle(zeroRateTable);
      zeroRateTableWidth = parseFloat(zeroRateComputedStyle.width) || 624;
    }

    newTable.setAttribute('style', 'width:' + zeroRateTableWidth + 'pt;border-collapse:collapse;margin:0;margin-top:2pt;margin-bottom:2pt !important;margin-left:' + marginLeftValue + ';table-layout:fixed;box-sizing:border-box;display:table !important;visibility:visible !important;');
    newTable.setAttribute('cellspacing', '0');

    // 6열 생성 (열 폭: 80, 50.33, 50.33, 50.34, 70, 나머지) - 2-4열 동일 폭
    const columnWidths = [80, 50.33, 50.33, 50.34, 70, 323]; // 합계: 624pt (80+50.33+50.33+50.34+70+323=624)

    // colgroup을 추가하여 각 열의 너비를 명시적으로 설정 (1행 병합과 관계없이 원래 폭 유지)
    // 6개 열로 설정 (7행에서도 6열은 분할하지 않음)
    const colgroup = document.createElement('colgroup');
    for (let i = 0; i < 6; i++) {
      const col = document.createElement('col');
      col.setAttribute('style', 'width:' + columnWidths[i] + 'pt;');
      colgroup.appendChild(col);
    }
    newTable.appendChild(colgroup);

    // 7행 생성
    for (let r = 0; r < 7; r++) {
      const newRow = document.createElement('tr');
      // 1행은 20pt, 나머지는 15pt
      // 6열 병합 셀의 높이 조절을 위해 1행의 높이를 min-height로 설정하여 자유롭게 조절 가능하도록
      const rowHeight = r === 0 ? '20pt' : '15pt';
      // 1행도 height로 고정하여 rowspan 병합 시 높이 계산이 정확하도록
      // min-height는 rowspan 셀의 높이 계산에 문제를 일으킬 수 있음
      newRow.setAttribute('style', 'height:' + rowHeight);

      for (let c = 0; c < 6; c++) {
        // 1행의 경우: 1열부터 5열까지 병합
        // 1행에서는 2열부터 5열 셀을 생성하지 않음
        if (r === 0 && c >= 1 && c <= 4) {
          continue; // 이 셀은 건너뜀 (colspan으로 병합됨)
        }

        // 6열(인덱스 5)의 경우: 1행부터 6행까지 병합
        // 2행부터 6행(r >= 1 && r <= 5)에서는 6열 셀을 생성하지 않음
        // rowspan을 사용하여 병합하되, 다른 열들의 위치는 변경하지 않음
        if (c === 5 && r >= 1 && r <= 5) {
          continue; // 이 셀은 건너뜀 (rowspan으로 병합됨)
        }

        const newCell = document.createElement('td');

        // 1행 1열에 colspan="5" 추가
        if (r === 0 && c === 0) {
          newCell.setAttribute('colspan', '5');
        }

        // 셀 스타일 설정
        let cellStyle = 'vertical-align:middle;';

        // colgroup으로 열 너비를 설정했으므로 셀 너비는 설정하지 않음
        // 병합된 셀도 colgroup의 설정을 따름

        // 외곽선: 상하는 검정
        if (r === 0) {
          cellStyle += 'border-top:1pt solid #000;';
        }
        // 7행(r=6)의 바닥선은 검정
        if (r === 6) {
          cellStyle += 'border-bottom:1pt solid #000;';
        }

        // 내부 간선: 좌우는 #7E7E7E (첫 번째 열 제외)
        if (c > 0) {
          cellStyle += 'border-left:1pt solid #7E7E7E;';
        }

        // 첫 번째 열과 마지막 열의 좌우 테두리 없음
        if (c === 0) {
          cellStyle += 'border-left:none;';
        }
        if (c === 5) {
          cellStyle += 'border-right:none;';
        }

        // 1행 1열의 경우: 오른쪽 테두리도 제거 (5열까지 병합했으므로)
        if (r === 0 && c === 0) {
          cellStyle += 'border-right:none;';
        }

        // 내부 간선: 상하는 #7E7E7E
        if (r > 0) {
          cellStyle += 'border-top:1pt solid #7E7E7E;';
        }

        // 6행(r=5, "(34)수입금액 제외" 행)의 바닥선 설정
        // 다른 열들(1~5열)에 border-bottom 추가
        if (r === 5 && c !== 5) {
          cellStyle += 'border-bottom:1pt solid #7E7E7E;';
        }

        // 6열 1행에 rowspan 추가 (1-6행까지 병합, colspan 없음 - 6열 하나만 차지)
        // 병합된 셀의 바닥선이 다른 열의 6행 바닥선과 일치하도록 rowspan="6" 설정
        // 중요: rowspan="6"은 1행부터 6행까지 정확히 병합 (총 6개 행)
        // 테이블 생성 시점에 바로 설정하여 나중에 함수가 간섭하지 않도록 함
        if (c === 5 && r === 0) {
          // rowspan="6" 강제 설정
          newCell.setAttribute('rowspan', '6');
          newCell.removeAttribute('colspan'); // colspan이 있으면 제거
          // 6열 병합 셀의 스타일: 높이 조절을 위한 제약 제거
          cellStyle = cellStyle.replace(/vertical-align[^;]*;?/gi, '');
          cellStyle += 'vertical-align:top !important;';
          // border-bottom을 명시적으로 설정
          cellStyle = cellStyle.replace(/border-bottom[^;]*;?/gi, '');
          cellStyle += 'border-bottom:1pt solid #7E7E7E !important;';
          // 높이 관련 제약 제거
          cellStyle = cellStyle.replace(/height[^;]*;?/gi, '');
          cellStyle = cellStyle.replace(/max-height[^;]*;?/gi, '');
          cellStyle = cellStyle.replace(/min-height[^;]*;?/gi, '');
        }

        // 2열~5열 3행부터 7행까지 입력박스를 추가할 셀은 padding 제거 및 position 설정 (테두리에 딱 붙이기)
        if ((c >= 1 && c <= 4) && (r >= 2 && r <= 6)) {
          cellStyle += 'padding: 0;position: relative;';
        }

        newCell.setAttribute('style', cellStyle);

        // 1열에 내용 추가
        if (c === 0) {
          if (r === 0) {
            // 1행: ⑤ 과세표준명세
            newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;font-size: 10pt;padding-left: 3pt;">⑤ <span style="font-weight: bold;">과세표준명세</span></p>';
          } else if (r === 1) {
            // 2행: 업태 (가운데 정렬)
            newCell.innerHTML = '<p style="text-indent: 0pt;text-align: center;font-size: 9pt;">업태</p>';
          } else if (r === 2) {
            // 3행: (31) 숫자 옆에 텍스트 입력창 추가
            const p31 = document.createElement('p');
            p31.setAttribute('style', 'text-indent: 0pt;text-align: left;font-size: 9pt;padding-left: 3pt;margin: 0;display: flex;align-items: center;');
            p31.appendChild(document.createTextNode('(31)'));
            const input31 = document.createElement('input');
            input31.setAttribute('type', 'text');
            input31.className = 'cell-input';
            input31.setAttribute('style', 'margin-left: 5pt;border: 1pt solid transparent;outline: none;padding: 0;font-size: 9pt;font-family: Arial, sans-serif;background: transparent;box-sizing: border-box;width: 50pt;');
            input31.addEventListener('focus', function(e) {
              e.target.style.border = '1pt solid #808080';
            });
            input31.addEventListener('blur', function(e) {
              e.target.style.border = '1pt solid transparent';
            });
            p31.appendChild(input31);
            newCell.appendChild(p31);
          } else if (r === 3) {
            // 4행: (32) 숫자 옆에 텍스트 입력창 추가
            const p32 = document.createElement('p');
            p32.setAttribute('style', 'text-indent: 0pt;text-align: left;font-size: 9pt;padding-left: 3pt;margin: 0;display: flex;align-items: center;');
            p32.appendChild(document.createTextNode('(32)'));
            const input32 = document.createElement('input');
            input32.setAttribute('type', 'text');
            input32.className = 'cell-input';
            input32.setAttribute('style', 'margin-left: 5pt;border: 1pt solid transparent;outline: none;padding: 0;font-size: 9pt;font-family: Arial, sans-serif;background: transparent;box-sizing: border-box;width: 50pt;');
            input32.addEventListener('focus', function(e) {
              e.target.style.border = '1pt solid #808080';
            });
            input32.addEventListener('blur', function(e) {
              e.target.style.border = '1pt solid transparent';
            });
            p32.appendChild(input32);
            newCell.appendChild(p32);
          } else if (r === 4) {
            // 5행: (33) 숫자 옆에 텍스트 입력창 추가
            const p33 = document.createElement('p');
            p33.setAttribute('style', 'text-indent: 0pt;text-align: left;font-size: 9pt;padding-left: 3pt;margin: 0;display: flex;align-items: center;');
            p33.appendChild(document.createTextNode('(33)'));
            const input33 = document.createElement('input');
            input33.setAttribute('type', 'text');
            input33.className = 'cell-input';
            input33.setAttribute('style', 'margin-left: 5pt;border: 1pt solid transparent;outline: none;padding: 0;font-size: 9pt;font-family: Arial, sans-serif;background: transparent;box-sizing: border-box;width: 50pt;');
            input33.addEventListener('focus', function(e) {
              e.target.style.border = '1pt solid #808080';
            });
            input33.addEventListener('blur', function(e) {
              e.target.style.border = '1pt solid transparent';
            });
            p33.appendChild(input33);
            newCell.appendChild(p33);
          } else if (r === 5) {
            // 6행: (34)수입금액제외 (수입금액만 자간 70%로 좁게, 제와 외 사이 간격 없음)
            newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;font-size: 9pt;padding-left: 3pt;">(34)<span style="letter-spacing: -0.3em;">수입금액</span> <span style="letter-spacing: -0.3em;">제외</span></p>';
          } else if (r === 6) {
            // 7행: (35) 합 계
            newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;font-size: 9pt;padding-left: 3pt;">(35) 합 계</p>';
          }
        } else if (c === 1 && r === 1) {
          // 2열 2행에 '종목' 텍스트 삽입
          newCell.innerHTML = '<p style="text-indent: 0pt;text-align: center;font-size: 9pt;">종목</p>';
        } else if (c === 2 && r === 1) {
          // 3열 2행에 '생산요소' 텍스트 삽입
          newCell.innerHTML = '<p style="text-indent: 0pt;text-align: center;font-size: 9pt;">생산요소</p>';
        } else if (c === 3 && r === 1) {
          // 4열 2행에 '업종 코드' 텍스트 삽입
          newCell.innerHTML = '<p style="text-indent: 0pt;text-align: center;font-size: 9pt;">업종 코드</p>';
        } else if (c === 4 && r === 1) {
          // 5열 2행에 '금액' 텍스트 삽입
          newCell.innerHTML = '<p style="text-indent: 0pt;text-align: center;font-size: 9pt;">금액</p>';
        } else if ((c >= 1 && c <= 4) && (r >= 2 && r <= 6)) {
          // 2열~5열 3행부터 7행까지 입력박스 삽입
          const input = document.createElement('input');
          // 5열은 숫자 입력박스 (콤마 표시), 나머지는 텍스트 입력박스
          if (c === 4) {
            input.setAttribute('type', 'text');
            input.className = 'cell-input number-input-comma';
            // 5열은 우측 정렬, 숫자만 입력, 콤마 표시
            input.setAttribute('style', 'position: absolute; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; border: 1pt solid transparent; outline: none; padding: 0; margin: 0; font-size: 7pt; font-family: Arial, sans-serif; text-align: right; background: transparent; box-sizing: border-box; line-height: 1em;');
            // 숫자만 입력받고 콤마 자동 추가
            input.addEventListener('input', function(e) {
              let value = e.target.value.replace(/[^0-9]/g, '');
              if (value) {
                value = parseInt(value).toLocaleString('ko-KR');
              }
              e.target.value = value;
            });
            // 포커스 아웃 시에도 콤마 적용
            input.addEventListener('blur', function(e) {
              let value = e.target.value.replace(/[^0-9]/g, '');
              if (value) {
                e.target.value = parseInt(value).toLocaleString('ko-KR');
              }
            });
          } else {
            input.setAttribute('type', 'text');
            input.className = 'cell-input';
            input.setAttribute('style', 'position: absolute; top: 0; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; border: 1pt solid transparent; outline: none; padding: 0; margin: 0; font-size: 7pt; font-family: Arial, sans-serif; text-align: center; background: transparent; box-sizing: border-box; line-height: 1em;');
          }
          newCell.appendChild(input);
        } else if (c === 5 && r === 0) {
          // 6열 1행: rowspan만 설정하고 텍스트는 나중에 삽입 (테이블이 DOM에 삽입된 후)
          // rowspan을 명시적으로 설정
          newCell.setAttribute('rowspan', '6');
          newCell.removeAttribute('colspan');

          // 텍스트는 나중에 삽입하므로 여기서는 빈 셀로 설정
          newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
        } else if (c === 5 && r === 6) {
          // 6열 7행: 마지막 행 마지막 열에 '첨부서류 뒤쪽참조' 텍스트 삽입
          newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;font-size: 9pt;font-family: 돋움, Dotum, sans-serif;padding-left: 15pt;margin: 0;"><span style="margin-right: 15pt;">첨부서류</span><span>뒤쪽참조</span></p>';
        } else {
          // 위의 모든 조건에 해당하지 않는 셀만 빈 셀로 설정
          // 이미 내용이 설정된 셀(1열, 2~5열 2행, 2~5열 3~7행 입력박스 등)은 건너뜀
          if (!newCell.innerHTML || newCell.innerHTML.trim() === '' || newCell.innerHTML === '<p style="text-indent: 0pt;text-align: left;"><br/></p>') {
            // 내용이 없거나 빈 셀인 경우에만 설정
            // appendChild로 추가된 요소가 있는 경우는 innerHTML이 비어있을 수 있으므로 확인 필요
            if (newCell.children.length === 0) {
              newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
            }
          }
        }

        newRow.appendChild(newCell);
      }

      newTable.appendChild(newRow);
    }

      // 영세율 상호주의 테이블 다음에 삽입
      if (zeroRateTable.parentNode) {
        // 테이블을 즉시 삽입하여 깜빡임 방지
        zeroRateTable.parentNode.insertBefore(newTable, zeroRateTable.nextSibling);
        console.log('영세율 상호주의 테이블 아래에 6열 7행 테이블 삽입 완료');

        // 테이블이 삭제되지 않도록 보호 (다른 코드에서 삭제하는 것을 방지)
        newTable.setAttribute('data-protected', 'true');
        newTable.setAttribute('data-below-zero-rate', 'true');

        // 과세표준명세 테이블 스타일 즉시 고정 (흔들림 방지)
        let tableStyle = newTable.getAttribute('style') || '';
        if (!tableStyle.includes('table-layout:fixed')) {
          tableStyle = (tableStyle ? tableStyle + ';' : '') + 'table-layout:fixed !important;';
        }
        if (!tableStyle.includes('width:624pt')) {
          tableStyle += 'width:624pt !important;';
        }
        if (!tableStyle.includes('border-collapse:collapse')) {
          tableStyle += 'border-collapse:collapse !important;';
        }
        if (!tableStyle.includes('visibility:visible')) {
          tableStyle += 'visibility:visible !important;';
        }
        if (!tableStyle.includes('opacity:1')) {
          tableStyle += 'opacity:1 !important;';
        }
        if (!tableStyle.includes('display:table')) {
          tableStyle += 'display:table !important;';
        }
        newTable.setAttribute('style', tableStyle);

      // 테이블 생성 완료 플래그 설정 (병합 보호를 위해 재생성 방지)
      belowZeroRateTableCreated = true;

      // 여러 시점에서 텍스트 삽입 시도 (전역 함수 사용)
      console.log('텍스트 삽입 함수 호출 예약 시작');
      insertTextToColumn6Global(); // 즉시 실행
      setTimeout(function() { console.log('50ms 후 텍스트 삽입 시도'); insertTextToColumn6Global(); }, 50);
      setTimeout(function() { console.log('100ms 후 텍스트 삽입 시도'); insertTextToColumn6Global(); }, 100);
      setTimeout(function() { console.log('200ms 후 텍스트 삽입 시도'); insertTextToColumn6Global(); }, 200);
      setTimeout(function() { console.log('500ms 후 텍스트 삽입 시도'); insertTextToColumn6Global(); }, 500);
      setTimeout(function() { console.log('1000ms 후 텍스트 삽입 시도'); insertTextToColumn6Global(); }, 1000);

      // 로컬 함수는 제거하고 전역 함수 사용 (아래 코드는 삭제됨)
      /*
      function insertTextToColumn6() {
        console.log('=== insertTextToColumn6 함수 실행 시작 ===');
        console.log('newTable:', newTable);

        if (!newTable) {
          console.log('텍스트 삽입: newTable이 없음');
          return false;
        }

        const firstRow = newTable.querySelector('tr:first-child');
        console.log('firstRow:', firstRow);
        if (!firstRow) {
          console.log('텍스트 삽입: 첫 번째 행을 찾을 수 없음');
          return false;
        }
        const cells = firstRow.querySelectorAll('td');
        console.log('첫 번째 행의 셀 개수:', cells.length);
        if (cells.length < 1) {
          console.log('텍스트 삽입: 셀 개수가 부족함');
          return false;
        }
        const col6Cell = cells[cells.length - 1]; // 6열 셀 (마지막 셀)
        console.log('col6Cell:', col6Cell);
        if (!col6Cell) {
          console.log('텍스트 삽입: 6열 셀을 찾을 수 없음');
          return false;
        }

        // 이미 텍스트가 있는지 확인 (더 관대한 조건)
        const existingText = col6Cell.querySelector('div[style*="font-size: 9pt"]') ||
                             col6Cell.querySelector('div') ||
                             (col6Cell.innerHTML && col6Cell.innerHTML.trim() !== '' &&
                              col6Cell.innerHTML !== '<p style="text-indent: 0pt;text-align: left;"><br/></p>');
        if (existingText && col6Cell.querySelector('div[style*="font-size: 9pt"]')) {
          console.log('텍스트 삽입: 이미 텍스트가 있음');
          return true;
        }

        console.log('6열 1행에 텍스트 삽입 시작');

        // 텍스트 구조 생성
        const container = document.createElement('div');
        container.setAttribute('style', 'font-size: 9pt;padding: 3pt;padding-left: 5pt;line-height: 0.9;');

        // 첫 번째 문단
        const p1 = document.createElement('p');
        p1.setAttribute('style', 'text-indent: 0pt;text-align: left;margin: 0;padding-left: 6pt;letter-spacing: -0.05em;');
        p1.appendChild(document.createTextNode('「부가가치세법」 제48조ㆍ제49조 또는 제59조와 「국세기본법」 제45조 의3에 따라 위의 내용을 신고하며, '));
        const boldSpan1 = document.createElement('span');
        boldSpan1.setAttribute('style', 'font-weight: bold;');
        boldSpan1.textContent = '위 내용을 충분히 검토하였고 신고인이 알고 있는 사실 그대로를 정확하게 적었음을 확인합니다.';
        p1.appendChild(boldSpan1);
        container.appendChild(p1);

        // 년월일 입력 행
        const dateRow = document.createElement('div');
        dateRow.setAttribute('style', 'text-align: right;margin: 2pt 0;');

        const yearInput = document.createElement('input');
        yearInput.setAttribute('type', 'text');
        yearInput.setAttribute('maxLength', '4');
        yearInput.className = 'cell-input';
        yearInput.setAttribute('style', 'width: 24pt; height: 9pt; border: 1pt solid transparent; outline: none; padding: 0; margin: 0; font-size: 9pt; font-family: Arial, sans-serif; text-align: center; background: transparent; box-sizing: border-box; display: inline-block; vertical-align: middle; line-height: 1em;');
        yearInput.addEventListener('focus', function(e) { e.target.style.border = '1pt solid #808080'; });
        yearInput.addEventListener('blur', function(e) { e.target.style.border = '1pt solid transparent'; });
        dateRow.appendChild(yearInput);
        dateRow.appendChild(document.createTextNode('년 '));

        const monthInput = document.createElement('input');
        monthInput.setAttribute('type', 'text');
        monthInput.setAttribute('maxLength', '2');
        monthInput.className = 'cell-input';
        monthInput.setAttribute('style', 'width: 16pt; height: 9pt; border: 1pt solid transparent; outline: none; padding: 0; margin: 0; font-size: 9pt; font-family: Arial, sans-serif; text-align: center; background: transparent; box-sizing: border-box; display: inline-block; vertical-align: middle; line-height: 1em;');
        monthInput.addEventListener('focus', function(e) { e.target.style.border = '1pt solid #808080'; });
        monthInput.addEventListener('blur', function(e) { e.target.style.border = '1pt solid transparent'; });
        dateRow.appendChild(monthInput);
        dateRow.appendChild(document.createTextNode('월 '));

        const dayInput = document.createElement('input');
        dayInput.setAttribute('type', 'text');
        dayInput.setAttribute('maxLength', '2');
        dayInput.className = 'cell-input';
        dayInput.setAttribute('style', 'width: 16pt; height: 9pt; border: 1pt solid transparent; outline: none; padding: 0; margin: 0; font-size: 9pt; font-family: Arial, sans-serif; text-align: center; background: transparent; box-sizing: border-box; display: inline-block; vertical-align: middle; line-height: 1em;');
        dayInput.addEventListener('focus', function(e) { e.target.style.border = '1pt solid #808080'; });
        dayInput.addEventListener('blur', function(e) { e.target.style.border = '1pt solid transparent'; });
        dateRow.appendChild(dayInput);
        dateRow.appendChild(document.createTextNode('일'));
        container.appendChild(dateRow);

        // 신고인 행
        const p2 = document.createElement('p');
        p2.setAttribute('style', 'text-indent: 0pt;text-align: right;margin: 0;margin-left: 10pt;position: relative;');
        p2.appendChild(document.createTextNode('신고인: '));
        const signInput1 = document.createElement('input');
        signInput1.setAttribute('type', 'text');
        signInput1.className = 'cell-input';
        signInput1.setAttribute('style', 'width: 80pt; height: 20pt; border: 1pt solid transparent; outline: none; padding: 0; margin: 0 20pt; font-size: 9pt; font-family: Arial, sans-serif; text-align: center; background: transparent; box-sizing: border-box; display: inline-block; vertical-align: middle; line-height: 1em;');
        signInput1.addEventListener('focus', function(e) { e.target.style.border = '1pt solid #808080'; });
        signInput1.addEventListener('blur', function(e) { e.target.style.border = '1pt solid transparent'; });
        p2.appendChild(signInput1);

        // (서명 또는 인) 텍스트를 클릭 가능한 span으로 감싸기
        const signTextSpan1 = document.createElement('span');
        signTextSpan1.style.cursor = 'pointer';
        signTextSpan1.style.position = 'relative';
        signTextSpan1.appendChild(document.createTextNode(' (서명 또는 인)'));
        signTextSpan1.addEventListener('click', function(e) {
          e.stopPropagation(); // 이벤트 전파 방지
          e.preventDefault(); // 기본 동작 방지

          // 기존 입력박스가 있으면 제거
          const existingBox1 = p2.querySelector('.stamp-input-box');
          if (existingBox1) {
            existingBox1.remove();
            return;
          }

          // 텍스트 span의 위치를 기준으로 박스 위치 계산 (60pt = 약 80px, 1pt ≈ 1.33px)
          const spanRect = signTextSpan1.getBoundingClientRect();
          const pRect = p2.getBoundingClientRect();
          const spanTop = spanRect.top - pRect.top;
          const spanRight = pRect.right - spanRect.right;
          const spanHeight = spanRect.height;
          const boxSize = 80; // 60pt ≈ 80px

          // 새로운 입력박스 생성 (박스의 바닥선이 텍스트의 바닥에 걸치게)
          const stampBox1 = document.createElement('div');
          stampBox1.className = 'stamp-input-box';
          // 텍스트의 오른쪽 끝을 기준으로 좌측으로 60pt, 박스의 bottom이 텍스트의 bottom과 맞춤
          stampBox1.setAttribute('style', 'position: absolute; display: block; width: 60pt; height: 60pt; min-width: 60pt; min-height: 60pt; max-width: 60pt; max-height: 60pt; background: transparent; border: none; outline: none; right: ' + spanRight + 'px; top: ' + (spanTop + spanHeight - boxSize) + 'px; cursor: pointer; box-sizing: border-box;');

          // hover 시 테두리 표시
          stampBox1.addEventListener('mouseenter', function(e) {
            e.target.style.border = '0.5pt solid #808080';
          });
          stampBox1.addEventListener('mouseleave', function(e) {
            e.target.style.border = 'none';
          });

          // 이미지를 표시할 영역 (백엔드에서 이미지를 뿌려줄 수 있도록)
          const stampImg1 = document.createElement('img');
          stampImg1.setAttribute('style', 'width: 100%; height: 100%; object-fit: contain; display: none;');
          stampImg1.className = 'stamp-image';
          stampBox1.appendChild(stampImg1);

          p2.appendChild(stampBox1);
        });
        p2.appendChild(signTextSpan1);
        container.appendChild(p2);

        const line1 = document.createElement('div');
        line1.setAttribute('style', 'height: 2pt; background-color: #808080; margin: 0; margin-left: 4pt; margin-right: 0;');
        container.appendChild(line1);

        // 세무대리인 문단
        const p3 = document.createElement('p');
        p3.setAttribute('style', 'text-indent: 0pt;text-align: left;margin: 0;padding-left: 6pt;');
        const boldSpan2 = document.createElement('span');
        boldSpan2.setAttribute('style', 'font-weight: bold;');
        boldSpan2.textContent = '세무대리인은 조세전문자격자로서 위 신고서를 성실하고 공정하게 작성 하였음을 확인합니다.';
        p3.appendChild(boldSpan2);
        container.appendChild(p3);

        // 세무대리인 행
        const p4 = document.createElement('p');
        p4.setAttribute('style', 'text-indent: 0pt;text-align: right;margin: 0;margin-left: 10pt;position: relative;');
        p4.appendChild(document.createTextNode('세무대리인: '));
        const signInput2 = document.createElement('input');
        signInput2.setAttribute('type', 'text');
        signInput2.className = 'cell-input';
        signInput2.setAttribute('style', 'width: 80pt; height: 20pt; border: 1pt solid transparent; outline: none; padding: 0; margin: 0 20pt; font-size: 9pt; font-family: Arial, sans-serif; text-align: center; background: transparent; box-sizing: border-box; display: inline-block; vertical-align: middle; line-height: 1em;');
        signInput2.addEventListener('focus', function(e) { e.target.style.border = '1pt solid #808080'; });
        signInput2.addEventListener('blur', function(e) { e.target.style.border = '1pt solid transparent'; });
        p4.appendChild(signInput2);

        // (서명 또는 인) 텍스트를 클릭 가능한 span으로 감싸기
        const signTextSpan2 = document.createElement('span');
        signTextSpan2.style.cursor = 'pointer';
        signTextSpan2.style.position = 'relative';
        signTextSpan2.appendChild(document.createTextNode(' (서명 또는 인)'));
        signTextSpan2.addEventListener('click', function(e) {
          e.stopPropagation(); // 이벤트 전파 방지
          e.preventDefault(); // 기본 동작 방지

          // 기존 입력박스가 있으면 제거
          const existingBox2 = p4.querySelector('.stamp-input-box');
          if (existingBox2) {
            existingBox2.remove();
            return;
          }

          // 텍스트 span의 위치를 기준으로 박스 위치 계산 (60pt = 약 80px, 1pt ≈ 1.33px)
          const spanRect = signTextSpan2.getBoundingClientRect();
          const pRect = p4.getBoundingClientRect();
          const spanTop = spanRect.top - pRect.top;
          const spanRight = pRect.right - spanRect.right;
          const spanHeight = spanRect.height;
          const offset10pt = 13.3; // 10pt ≈ 13.3px

          // 새로운 입력박스 생성 (박스의 위쪽이 텍스트에 걸쳐지게, 10pt 위로 올림)
          const stampBox2 = document.createElement('div');
          stampBox2.className = 'stamp-input-box';
          // 텍스트의 오른쪽 끝을 기준으로 좌측으로 60pt, 박스의 top이 텍스트의 top에서 10pt 위로
          stampBox2.setAttribute('style', 'position: absolute; display: block; width: 60pt; height: 60pt; min-width: 60pt; min-height: 60pt; max-width: 60pt; max-height: 60pt; background: transparent; border: none; outline: none; right: ' + spanRight + 'px; top: ' + (spanTop - offset10pt) + 'px; cursor: pointer; box-sizing: border-box;');

          // hover 시 테두리 표시
          stampBox2.addEventListener('mouseenter', function(e) {
            e.target.style.border = '0.5pt solid #808080';
          });
          stampBox2.addEventListener('mouseleave', function(e) {
            e.target.style.border = 'none';
          });

          // 이미지를 표시할 영역 (백엔드에서 이미지를 뿌려줄 수 있도록)
          const stampImg2 = document.createElement('img');
          stampImg2.setAttribute('style', 'width: 100%; height: 100%; object-fit: contain; display: none;');
          stampImg2.className = 'stamp-image';
          stampBox2.appendChild(stampImg2);

          p4.appendChild(stampBox2);
        });
        p4.appendChild(signTextSpan2);
        container.appendChild(p4);

        const line2 = document.createElement('div');
        line2.setAttribute('style', 'height: 2pt; background-color: #808080; margin: 0; margin-left: 4pt; margin-right: 0;');
        container.appendChild(line2);

        // 세무서장 행
        const p5 = document.createElement('p');
        p5.setAttribute('style', 'text-indent: 0pt;text-align: left;margin: 0;padding-left: 10pt;font-size: 12pt;font-weight: bold;');
        p5.appendChild(document.createTextNode('세무서장 '));
        const span3 = document.createElement('span');
        span3.setAttribute('style', 'font-size: 10pt;font-weight: normal;');
        span3.textContent = '귀하';
        p5.appendChild(span3);
        container.appendChild(p5);

        // 텍스트 삽입 전에 rowspan 재확인 및 강제 설정
        // MutationObserver가 방해하지 않도록 플래그 설정
        if (typeof window !== 'undefined' && window.isInsertingTextToCol6 !== undefined) {
          window.isInsertingTextToCol6 = true;
        }

        col6Cell.setAttribute('rowspan', '6');
        col6Cell.removeAttribute('colspan');

        // 텍스트 삽입
        col6Cell.innerHTML = '';
        col6Cell.appendChild(container);

        // 텍스트 삽입 후 rowspan 재설정
        col6Cell.setAttribute('rowspan', '6');
        col6Cell.removeAttribute('colspan');

        // 플래그 해제
        if (typeof window !== 'undefined' && window.isInsertingTextToCol6 !== undefined) {
          setTimeout(function() {
            window.isInsertingTextToCol6 = false;
          }, 100);
        }

        console.log('6열 1행에 텍스트 삽입 완료');

        // 2~6행에서 6열 셀 제거 확인
        const allRows = newTable.querySelectorAll('tr');
        for (let r = 1; r <= 5 && r < allRows.length; r++) {
          const row = allRows[r];
          const rowCells = Array.from(row.querySelectorAll('td'));
          let currentColIndex = 0;

          for (let j = 0; j < rowCells.length; j++) {
            const cell = rowCells[j];
            const cellColspan = parseInt(cell.getAttribute('colspan') || '1');
            const cellStartCol = currentColIndex;
            const cellEndCol = currentColIndex + cellColspan - 1;

            if (cellStartCol <= 5 && cellEndCol >= 5) {
              cell.remove();
              break;
            }

            currentColIndex += cellColspan;
          }
        }

        return true;
      }
      */

      // 7행(r=6, 합계 행)의 2, 3, 4열에 있는 입력 셀 제거
      setTimeout(function() {
        const allRows = newTable.querySelectorAll('tr');
        if (allRows.length > 6) {
          const row7 = allRows[6]; // 7행 (r=6, 인덱스 6)
          const row7Cells = Array.from(row7.querySelectorAll('td'));
          let currentColIndex = 0;

          for (let j = 0; j < row7Cells.length; j++) {
            const cell = row7Cells[j];
            const cellColspan = parseInt(cell.getAttribute('colspan') || '1');
            const cellStartCol = currentColIndex;
            const cellEndCol = currentColIndex + cellColspan - 1;

            // 2, 3, 4열 (인덱스 1, 2, 3)에 해당하는 셀에서 입력 셀 제거
            if ((cellStartCol <= 3 && cellEndCol >= 1) || (cellStartCol >= 1 && cellStartCol <= 3)) {
              const input = cell.querySelector('input');
              if (input) {
                console.log('7행 ' + (cellStartCol + 1) + '열에서 입력 셀 제거');
                input.remove();
                // 빈 셀로 복원
                if (!cell.innerHTML.trim() || cell.innerHTML.trim() === '') {
                  cell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
                }
              }
            }

            currentColIndex += cellColspan;
          }
        }
      }, 200);

      // 1행 1열~5열 병합 및 6열 병합 즉시 확인 및 강제 설정 (다른 코드 실행 전에 보호)
      setTimeout(function() {
        const firstRow = newTable.querySelector('tr:first-child');
        if (firstRow) {
          const cells = firstRow.querySelectorAll('td');

          // 1행 1열~5열 병합 확인 및 강제 설정
          if (cells.length > 0) {
            const firstCell = cells[0];
            const currentColspan = firstCell.getAttribute('colspan');
            if (currentColspan !== '5') {
              console.log('1행 1열~5열 병합 보호: colspan="5" 강제 설정 (현재 값: ' + currentColspan + ')');
              firstCell.setAttribute('colspan', '5');
              firstCell.removeAttribute('rowspan'); // rowspan이 있으면 제거

              // 1행에서 2~5열 셀 제거 (colspan 병합을 위해)
              for (let i = cells.length - 1; i >= 1; i--) {
                const cell = cells[i];
                // 1행의 2~5열 셀인지 확인 (colspan을 고려)
                let colIndex = 0;
                for (let j = 0; j < i; j++) {
                  colIndex += parseInt(cells[j].getAttribute('colspan') || '1');
                }
                if (colIndex >= 1 && colIndex <= 4) {
                  cell.remove();
                }
              }
            }
          }

          // 6열 병합 확인 및 강제 설정
          if (cells.length >= 2) {
            const col6Cell = cells[cells.length - 1];
            if (col6Cell) {
              const currentRowspan = col6Cell.getAttribute('rowspan');
              if (currentRowspan !== '6') {
                console.log('6열 병합 즉시 보호: rowspan="6" 강제 설정 (현재 값: ' + currentRowspan + ')');
                col6Cell.setAttribute('rowspan', '6');
                col6Cell.removeAttribute('colspan');

                // 2~6행에서 6열 셀 제거
                const allRows = newTable.querySelectorAll('tr');
                for (let r = 1; r <= 5 && r < allRows.length; r++) {
                  const row = allRows[r];
                  const rowCells = Array.from(row.querySelectorAll('td'));
                  let currentColIndex = 0;

                  for (let j = 0; j < rowCells.length; j++) {
                    const cell = rowCells[j];
                    const cellColspan = parseInt(cell.getAttribute('colspan') || '1');
                    const cellStartCol = currentColIndex;
                    const cellEndCol = currentColIndex + cellColspan - 1;

                    if (cellStartCol <= 5 && cellEndCol >= 5) {
                      cell.remove();
                      break;
                    }

                    currentColIndex += cellColspan;
                  }
                }
              }
            }
          }
        }
      }, 0); // 즉시 실행

      // 1행 1열~5열 병합 및 6열 병합 보호: MutationObserver 추가
      if (typeof MutationObserver !== 'undefined') {
        let isRestoringRowspan = false; // 무한 루프 방지 플래그
        const rowspanProtectionObserver = new MutationObserver(function(mutations) {
          // 무한 루프 방지: 이미 복원 중이면 건너뜀
          if (isRestoringRowspan) return;

          // 텍스트 삽입 중이면 건너뜀 (전역 플래그 확인)
          if (typeof window !== 'undefined' && window.isInsertingTextToCol6) {
            return;
          }

          // childList 변경만 감지 (텍스트 삽입 등) - 이 경우는 rowspan이 이미 설정되어 있으므로 건너뜀
          let hasOnlyChildListChanges = true;
          for (let i = 0; i < mutations.length; i++) {
            if (mutations[i].type === 'attributes' &&
                (mutations[i].attributeName === 'rowspan' || mutations[i].attributeName === 'colspan')) {
              hasOnlyChildListChanges = false;
              break;
            }
          }
          // childList 변경만 있고 attributes 변경이 없으면 건너뜀 (텍스트 삽입 등)
          if (hasOnlyChildListChanges && mutations.some(m => m.type === 'childList')) {
            return;
          }

          const firstRow = newTable.querySelector('tr:first-child');
          if (!firstRow) return;

          const cells = firstRow.querySelectorAll('td');
          if (cells.length === 0) return;

          // 1행 1열~5열 병합 보호
          const firstCell = cells[0];
          if (firstCell) {
            const currentColspan = firstCell.getAttribute('colspan');
            if (currentColspan !== '5') {
              console.log('1행 1열~5열 병합 보호: colspan="5" 복원 (현재 값: ' + currentColspan + ')');
              isRestoringRowspan = true;
              firstCell.setAttribute('colspan', '5');
              firstCell.removeAttribute('rowspan');

              // 1행에서 2~5열 셀 제거
              const cellsArray = Array.from(cells);
              for (let i = cellsArray.length - 1; i >= 1; i--) {
                const cell = cellsArray[i];
                let colIndex = 0;
                for (let j = 0; j < i; j++) {
                  colIndex += parseInt(cellsArray[j].getAttribute('colspan') || '1');
                }
                if (colIndex >= 1 && colIndex <= 4) {
                  cell.remove();
                }
              }
              setTimeout(function() { isRestoringRowspan = false; }, 10);
            }
          }

          // 6열 병합 보호
          if (cells.length >= 2) {
            const col6Cell = cells[cells.length - 1]; // 6열 셀
            if (col6Cell) {
              const currentRowspan = col6Cell.getAttribute('rowspan');
              // rowspan="6"이 없거나 변경되었으면 즉시 복원
              if (currentRowspan !== '6') {
                console.log('6열 병합 보호: rowspan="6" 복원 (현재 값: ' + currentRowspan + ')');
                isRestoringRowspan = true;
                col6Cell.setAttribute('rowspan', '6');
                col6Cell.removeAttribute('colspan');

                // 2~6행에서 6열 셀 제거
                const allRows = newTable.querySelectorAll('tr');
                for (let r = 1; r <= 5 && r < allRows.length; r++) {
                  const row = allRows[r];
                  const rowCells = Array.from(row.querySelectorAll('td'));
                  let currentColIndex = 0;

                  for (let j = 0; j < rowCells.length; j++) {
                    const cell = rowCells[j];
                    const cellColspan = parseInt(cell.getAttribute('colspan') || '1');
                    const cellStartCol = currentColIndex;
                    const cellEndCol = currentColIndex + cellColspan - 1;

                    if (cellStartCol <= 5 && cellEndCol >= 5) {
                      cell.remove();
                      break;
                    }

                    currentColIndex += cellColspan;
                  }
                }
                setTimeout(function() { isRestoringRowspan = false; }, 10);
              }
            }
          }
        });

        // 테이블의 rowspan, colspan 속성 변경 감지
        rowspanProtectionObserver.observe(newTable, {
          attributes: true,
          attributeFilter: ['rowspan', 'colspan'],
          childList: true,
          subtree: true
        });

        console.log('1행 1열~5열 병합 및 6열 병합 보호 MutationObserver 설정 완료');
      }

      // 6열 병합 셀의 border-bottom을 6행의 border-bottom과 정확히 일치시키기
      // DOM에 추가된 후 실행하여 실제 위치를 측정하고 조정
      setTimeout(function() {
        const allRows = newTable.querySelectorAll('tr');
        if (allRows.length >= 6) {
          // 6행(r=5, 인덱스 5, "(34)수입금액 제외" 행) 찾기
          const row6 = allRows[5];
          const row6Cells = row6.querySelectorAll('td');

          if (row6Cells.length > 0) {
            // 6행의 모든 셀의 border-bottom 위치 측정 (가장 낮은 위치 사용)
            let row6Bottom = 0;
            row6Cells.forEach(function(cell) {
              const rect = cell.getBoundingClientRect();
              const cellBottom = rect.bottom;
              if (cellBottom > row6Bottom) {
                row6Bottom = cellBottom;
              }
            });

            // 6열 병합 셀(1행의 6열) 찾기
            const row1 = allRows[0];
            const row1Cells = row1.querySelectorAll('td');
            let col6Cell = null;
            // 1행의 마지막 셀이 6열 셀 (rowspan="6"이 설정된 셀)
            if (row1Cells.length > 0) {
              col6Cell = row1Cells[row1Cells.length - 1];
              if (col6Cell && col6Cell.getAttribute('rowspan') === '6') {
                // 6열 병합 셀의 현재 위치 측정
                const col6Rect = col6Cell.getBoundingClientRect();
                const col6Bottom = col6Rect.bottom;

                console.log('6행 border-bottom 위치: ' + row6Bottom + 'px, 6열 병합 셀 border-bottom 위치: ' + col6Bottom + 'px, 차이: ' + Math.abs(row6Bottom - col6Bottom) + 'px');

                // 위치가 다르면 조정
                const diff = Math.abs(row6Bottom - col6Bottom);
                console.log('초기 측정: 6행=' + row6Bottom + 'px, 6열=' + col6Bottom + 'px, 차이=' + diff + 'px');

                // 각 행의 실제 높이 측정
                const row1Height = allRows[0].getBoundingClientRect().height;
                const row2Height = allRows[1].getBoundingClientRect().height;
                const row3Height = allRows[2].getBoundingClientRect().height;
                const row4Height = allRows[3].getBoundingClientRect().height;
                const row5Height = allRows[4].getBoundingClientRect().height;
                const row6Height = row6.getBoundingClientRect().height;
                const totalHeight = row1Height + row2Height + row3Height + row4Height + row5Height + row6Height;

                console.log('행 높이: 1행=' + row1Height + 'px, 2행=' + row2Height + 'px, 3행=' + row3Height + 'px, 4행=' + row4Height + 'px, 5행=' + row5Height + 'px, 6행=' + row6Height + 'px, 총=' + totalHeight + 'px');
                console.log('6열 병합 셀 높이: ' + col6Rect.height + 'px, 차이=' + Math.abs(totalHeight - col6Rect.height) + 'px');

                if (diff > 0.5 || Math.abs(totalHeight - col6Rect.height) > 1) {
                  console.log('6열 병합 셀의 높이 조정 필요');

                  // 6열 병합 셀의 모든 스타일 제약 제거
                  let col6Style = col6Cell.getAttribute('style') || '';

                  // 높이 관련 모든 제약 제거
                  col6Style = col6Style.replace(/height[^;]*;?/gi, '');
                  col6Style = col6Style.replace(/max-height[^;]*;?/gi, '');
                  col6Style = col6Style.replace(/min-height[^;]*;?/gi, '');

                  // border-bottom을 명시적으로 설정
                  col6Style = col6Style.replace(/border-bottom[^;]*;?/gi, '');
                  col6Style += 'border-bottom:1pt solid #7E7E7E !important;';

                  // vertical-align을 top으로
                  col6Style = col6Style.replace(/vertical-align[^;]*;?/gi, '');
                  col6Style += 'vertical-align:top !important;';

                  // padding과 margin 제거
                  col6Style = col6Style.replace(/padding[^;]*;?/gi, '');
                  col6Style = col6Style.replace(/margin[^;]*;?/gi, '');
                  col6Style += 'padding:0 !important;margin:0 !important;';

                  // box-sizing 설정
                  col6Style = col6Style.replace(/box-sizing[^;]*;?/gi, '');
                  col6Style += 'box-sizing:border-box !important;';

                  // line-height 제거
                  col6Style = col6Style.replace(/line-height[^;]*;?/gi, '');

                  col6Cell.setAttribute('style', col6Style);

                  // 높이를 명시적으로 설정 (실제 측정된 높이 사용)
                  // 하지만 rowspan이 있으면 높이를 직접 설정하면 안 됨
                  // 대신 border-bottom 위치를 조정

                  console.log('6열 병합 셀의 모든 높이 제약 제거 완료');

                  // 다시 측정하여 확인
                  setTimeout(function() {
                    const newCol6Rect = col6Cell.getBoundingClientRect();
                    const newCol6Bottom = newCol6Rect.bottom;
                    const newDiff = Math.abs(row6Bottom - newCol6Bottom);
                    console.log('재측정: 6행=' + row6Bottom + 'px, 6열=' + newCol6Bottom + 'px, 차이=' + newDiff + 'px');

                    // 여전히 차이가 있으면 추가 조정
                    if (newDiff > 0.5) {
                      // 6행의 border-bottom 위치를 기준으로 6열 병합 셀의 높이를 조정
                      const row6Top = row6.getBoundingClientRect().top;
                      const col6Top = col6Rect.top;
                      const targetHeight = row6Bottom - col6Top;

                      console.log('목표 높이: ' + targetHeight + 'px (6행 bottom - 6열 top)');
                      console.log('현재 높이: ' + newCol6Rect.height + 'px');

                      // 높이를 직접 설정하지 않고, border-bottom만 조정
                      // rowspan이 있으면 높이를 직접 설정하면 안 되므로
                      // 대신 1행의 높이를 조정하거나 다른 방법 사용
                    }
                  }, 100);
                } else {
                  console.log('6열 병합 셀의 border-bottom 위치 정확함 (차이=' + diff + 'px)');
                }
              }
            }
          }
        }
      }, 200);

      // 테이블이 항상 보이도록 강제 설정
      newTable.style.display = 'table';
      newTable.style.visibility = 'visible';
      newTable.style.opacity = '1';

      // 테이블이 삭제되지 않도록 MutationObserver로 보호
      if (typeof MutationObserver !== 'undefined') {
        const tableProtectionObserver = new MutationObserver(function(mutations) {
          mutations.forEach(function(mutation) {
            mutation.removedNodes.forEach(function(node) {
              if (node === newTable || (node.nodeType === 1 && node.getAttribute && node.getAttribute('data-below-zero-rate') === 'true')) {
                console.log('보호된 테이블이 삭제되었습니다. 재생성합니다.');
                // 테이블이 이미 올바른 위치에 있으면 재생성하지 않음 (6열 병합 보호)
                setTimeout(function() {
                  insertTableBelowZeroRate();
                }, 100);
              }
            });
          });
        });

        if (zeroRateTable.parentNode) {
          tableProtectionObserver.observe(zeroRateTable.parentNode, {
            childList: true,
            subtree: true
          });
        }
      }

      // 6열 1행의 rowspan을 강제로 유지하는 함수 (전역으로 노출)
      // enforceColumn6Rowspan과 동일한 로직 사용
      window.ensureRowspanForColumn6 = function(targetTable) {
        const target = targetTable || document.querySelector('table.below-zero-rate-table[data-below-zero-rate="true"]');
        if (!target) {
          // 테이블이 아직 준비되지 않았을 수 있으므로 조용히 반환
          return;
        }

        const firstRow = target.querySelector('tr:first-child');
        if (!firstRow) {
          // 1행이 아직 준비되지 않았을 수 있으므로 조용히 반환
          return;
        }

        const cells = firstRow.querySelectorAll('td');
        if (cells.length < 2) {
          return;
        }

        const col6Cell = cells[cells.length - 1]; // 6열 셀
        if (!col6Cell) {
          return;
        }

        // rowspan="6" 강제 설정
        col6Cell.setAttribute('rowspan', '6');
        col6Cell.removeAttribute('colspan');

        // 2~6행에서 6열 셀을 여러 번 반복하여 제거 (확실하게)
        const allRows = target.querySelectorAll('tr');
        let removedCount = 0;
        const maxIterations = 10;

        for (let iteration = 0; iteration < maxIterations; iteration++) {
          let foundAny = false;

          for (let r = 1; r <= 5 && r < allRows.length; r++) {
            const row = allRows[r];
            const rowCells = Array.from(row.querySelectorAll('td'));
            let currentColIndex = 0;
            let cellsToRemove = [];

            for (let j = 0; j < rowCells.length; j++) {
              const cell = rowCells[j];
              const cellColspan = parseInt(cell.getAttribute('colspan') || '1');
              const cellStartCol = currentColIndex;
              const cellEndCol = currentColIndex + cellColspan - 1;

              // 6열(인덱스 5)이 이 셀의 범위에 포함되는지 확인
              if (cellStartCol <= 5 && cellEndCol >= 5) {
                cellsToRemove.push(cell);
                foundAny = true;
              }

              currentColIndex += cellColspan;
            }

            // 찾은 셀들을 모두 제거
            cellsToRemove.forEach(function(cell) {
              cell.remove();
              removedCount++;
            });
          }

          if (!foundAny) break;
        }
      }

      // "⑤ 과세표준명세" 테이블의 6열을 1~6행까지 병합하는 함수 (전역으로 노출)
      window.ensureRowspanForTaxBaseDetailTableColumn6 = function() {
        // "⑤ 과세표준명세" 텍스트가 포함된 테이블 찾기
        const allTables = document.querySelectorAll('table');
        let taxBaseDetailTable = null;

        for (let i = 0; i < allTables.length; i++) {
          const table = allTables[i];
          const tableText = table.textContent || '';
          const normalizedText = tableText.replace(/\s+/g, '');
          const textWithoutSpaces = normalizedText;

          // "⑤"와 "과세표준명세"가 모두 있는 경우
          if ((tableText.includes('⑤') && tableText.includes('과세표준명세')) ||
              textWithoutSpaces.includes('⑤과세표준명세')) {
            taxBaseDetailTable = table;
            console.log('ensureRowspanForTaxBaseDetailTableColumn6: 과세표준명세 테이블 발견 (인덱스: ' + i + ')');
            break;
          }
        }

        if (!taxBaseDetailTable) {
          console.log('ensureRowspanForTaxBaseDetailTableColumn6: 과세표준명세 테이블을 찾을 수 없습니다.');
          return;
        }

        // 1행의 6열 셀 찾기
        const firstRow = taxBaseDetailTable.querySelector('tr:first-child');
        if (!firstRow) {
          console.log('ensureRowspanForTaxBaseDetailTableColumn6: 1행을 찾을 수 없습니다.');
          return;
        }

        // 6열 셀 찾기
        // 1행의 1~5열이 병합되어 있으므로, 1행에는 2개의 셀만 있음:
        // - 첫 번째 셀: 1열 (colspan="5")
        // - 두 번째 셀: 6열 (마지막 셀)
        const cells = firstRow.querySelectorAll('td');
        let col6Cell = null;

        if (cells.length >= 2) {
          // 1행의 마지막 셀이 6열 셀
          col6Cell = cells[cells.length - 1];
          console.log('ensureRowspanForTaxBaseDetailTableColumn6: 6열 셀을 마지막 셀으로 찾음');
        } else {
          // 대체 방법: colspan을 고려하여 찾기
          let colIndex = 0;
          for (let i = 0; i < cells.length; i++) {
            const cell = cells[i];
            const colspan = parseInt(cell.getAttribute('colspan') || '1');

            if (colIndex === 5) {
              col6Cell = cell;
              break;
            }

            colIndex += colspan;
          }
        }

        if (!col6Cell) {
          console.log('ensureRowspanForTaxBaseDetailTableColumn6: 6열 셀을 찾을 수 없습니다. cells.length:', cells.length);
          // 디버깅: 모든 셀 정보 출력
          cells.forEach(function(cell, idx) {
            console.log('셀 ' + idx + ':', {
              colspan: cell.getAttribute('colspan'),
              rowspan: cell.getAttribute('rowspan'),
              text: cell.textContent.substring(0, 50)
            });
          });
          return;
        }

        // rowspan="6" 강제 설정
        col6Cell.setAttribute('rowspan', '6');
        col6Cell.removeAttribute('colspan'); // colspan 제거

        // 2~6행에서 6열 셀이 있는지 확인하고 제거
        const allRows = taxBaseDetailTable.querySelectorAll('tr');
        let removedCount = 0;

        for (let r = 1; r <= 5 && r < allRows.length; r++) {
          const row = allRows[r];
          const rowCells = row.querySelectorAll('td');
          let currentColIndex = 0;

          for (let j = 0; j < rowCells.length; j++) {
            const cell = rowCells[j];
            const cellColspan = parseInt(cell.getAttribute('colspan') || '1');

            if (currentColIndex === 5) {
              // 6열 셀이면 제거 (rowspan으로 병합되어야 함)
              cell.remove();
              removedCount++;
              console.log('과세표준명세 테이블 6열 ' + (r + 1) + '행 셀 제거 완료 (rowspan 병합)');
              break;
            }

            currentColIndex += cellColspan;
          }
        }

        console.log('과세표준명세 테이블 6열 1행 rowspan="6" 강제 설정 완료. 제거된 셀:', removedCount + '개');
      };

      // 6열 1~6행 병합을 강제로 적용하는 함수
      function enforceColumn6Rowspan() {
        const firstRow = newTable.querySelector('tr:first-child');
        if (!firstRow) return;

        const cells = firstRow.querySelectorAll('td');
        if (cells.length < 2) return;

        const col6Cell = cells[cells.length - 1]; // 6열 셀
        if (!col6Cell) return;

        // 2행의 6열 셀에서 텍스트를 가져와서 1행으로 이동
        const allRowsForContent = newTable.querySelectorAll('tr');
        if (allRowsForContent.length >= 2) {
          const secondRow = allRowsForContent[1];
          const secondRowCells = Array.from(secondRow.querySelectorAll('td'));
          let currentColIndex = 0;

          for (let j = 0; j < secondRowCells.length; j++) {
            const cell = secondRowCells[j];
            const cellColspan = parseInt(cell.getAttribute('colspan') || '1');
            const cellStartCol = currentColIndex;
            const cellEndCol = currentColIndex + cellColspan - 1;

            // 6열(인덱스 5)이 이 셀의 범위에 포함되는지 확인
            if (cellStartCol <= 5 && cellEndCol >= 5) {
              // 2행의 6열 셀에 텍스트가 있으면 1행으로 이동
              const cellContent = cell.innerHTML;
              if (cellContent && cellContent.trim() !== '' &&
                  cellContent !== '<p style="text-indent: 0pt;text-align: left;"><br/></p>') {
                // 1행의 6열 셀이 비어있으면 2행의 내용을 이동
                const col6CellContent = col6Cell.innerHTML;
                if (!col6CellContent || col6CellContent.trim() === '' ||
                    col6CellContent === '<p style="text-indent: 0pt;text-align: left;"><br/></p>') {
                  col6Cell.innerHTML = cellContent;
                }
              }
              break;
            }

            currentColIndex += cellColspan;
          }
        }

        // rowspan="6" 강제 설정
        col6Cell.setAttribute('rowspan', '6');
        col6Cell.removeAttribute('colspan');

        // rowspan 셀의 높이 계산을 위해 스타일 조정
        // vertical-align을 top으로 설정하여 높이 계산 문제 방지
        let cellStyle = col6Cell.getAttribute('style') || '';
        cellStyle = cellStyle.replace(/vertical-align[^;]*;?/gi, '');
        cellStyle += 'vertical-align:top !important;';
        // 높이 관련 제약 제거
        cellStyle = cellStyle.replace(/height[^;]*;?/gi, '');
        cellStyle = cellStyle.replace(/max-height[^;]*;?/gi, '');
        cellStyle = cellStyle.replace(/min-height[^;]*;?/gi, '');
        col6Cell.setAttribute('style', cellStyle);

        // 2~6행에서 6열 셀을 여러 번 반복하여 제거 (확실하게)
        const allRows = newTable.querySelectorAll('tr');
        let removedCount = 0;
        const maxIterations = 10;

        for (let iteration = 0; iteration < maxIterations; iteration++) {
          let foundAny = false;

          for (let r = 1; r <= 5 && r < allRows.length; r++) {
            const row = allRows[r];
            const rowCells = Array.from(row.querySelectorAll('td'));
            let currentColIndex = 0;
            let cellsToRemove = [];

            for (let j = 0; j < rowCells.length; j++) {
              const cell = rowCells[j];
              const cellColspan = parseInt(cell.getAttribute('colspan') || '1');
              const cellStartCol = currentColIndex;
              const cellEndCol = currentColIndex + cellColspan - 1;

              // 6열(인덱스 5)이 이 셀의 범위에 포함되는지 확인
              if (cellStartCol <= 5 && cellEndCol >= 5) {
                cellsToRemove.push(cell);
                foundAny = true;
              }

              currentColIndex += cellColspan;
            }

            // 찾은 셀들을 모두 제거
            cellsToRemove.forEach(function(cell) {
              cell.remove();
              removedCount++;
            });
          }

          if (!foundAny) break;
        }

        if (removedCount > 0) {
          console.log('6열 1~6행 병합 강제 적용: ' + removedCount + '개 셀 제거');
        }
      }

      // enforceColumn6Rowspan 함수 비활성화 - 테이블 생성 시점에 이미 rowspan이 설정되어 있으므로 불필요
      // 반복 실행으로 인한 문제 발생 가능성 있음
      // enforceColumn6Rowspan();
      // setTimeout(enforceColumn6Rowspan, 10);
      // setTimeout(enforceColumn6Rowspan, 50);
      // setTimeout(enforceColumn6Rowspan, 100);
      // setTimeout(enforceColumn6Rowspan, 200);
      // setTimeout(enforceColumn6Rowspan, 500);
      // setTimeout(enforceColumn6Rowspan, 1000);
      // setTimeout(enforceColumn6Rowspan, 2000);

      // window.ensureRowspanForColumn6는 enforceColumn6Rowspan으로 대체됨 (중복 제거)

      // "⑤ 과세표준명세" 테이블의 6열 병합 비활성화 (처음 나타나는 테이블 양식 유지)
      // setTimeout(function() {
      //   window.ensureRowspanForTaxBaseDetailTableColumn6();
      // }, 50);

      // "⑤ 과세표준명세" 테이블의 rowspan 보호를 위한 MutationObserver 비활성화 (처음 나타나는 테이블 양식 유지)
      // if (typeof MutationObserver !== 'undefined') {
      //   const taxBaseDetailTableObserver = new MutationObserver(function(mutations) {
      //     let shouldReapply = false;
      //     mutations.forEach(function(mutation) {
      //       if (mutation.type === 'attributes' &&
      //           (mutation.attributeName === 'rowspan' || mutation.attributeName === 'colspan')) {
      //         const target = mutation.target;
      //         if (target.tagName === 'TD') {
      //           const table = target.closest('table');
      //           if (table) {
      //             const tableText = table.textContent || '';
      //             if (tableText.includes('⑤') && tableText.includes('과세표준명세')) {
      //               shouldReapply = true;
      //             }
      //           }
      //         }
      //       }
      //     });
      //     if (shouldReapply) {
      //       setTimeout(function() {
      //         window.ensureRowspanForTaxBaseDetailTableColumn6();
      //       }, 10);
      //     }
      //   });

      //   // 모든 테이블을 관찰 대상으로 추가
      //   const allTables = document.querySelectorAll('table');
      //   allTables.forEach(function(table) {
      //     const tableText = table.textContent || '';
      //     if (tableText.includes('⑤') && tableText.includes('과세표준명세')) {
      //       taxBaseDetailTableObserver.observe(table, {
      //         attributes: true,
      //         attributeFilter: ['rowspan', 'colspan'],
      //         subtree: true,
      //         childList: true
      //       });
      //       console.log('과세표준명세 테이블 MutationObserver 설정 완료');
      //     }
      //   });
      // }

      // MutationObserver 완전 비활성화 - 테이블 생성 시점에 이미 rowspan이 설정되어 있으므로 불필요
      // Observer가 반복 실행되면서 문제 발생 가능성 있음
      // 6열 병합 보호를 위해 완전히 비활성화
      if (false && typeof MutationObserver !== 'undefined') {
        const rowspanProtectionObserver = new MutationObserver(function(mutations) {
          let shouldEnforce = false;

          mutations.forEach(function(mutation) {
            // rowspan 속성 변경 감지
            if (mutation.type === 'attributes' && mutation.attributeName === 'rowspan') {
              const target = mutation.target;
              if (target.closest && target.closest('table.below-zero-rate-table[data-below-zero-rate="true"]')) {
                const row = target.closest('tr');
                if (row && row === row.closest('table').querySelector('tr:first-child')) {
                  let actualCol = 0;
                  for (let i = 0; i < row.children.length; i++) {
                    if (row.children[i] === target) {
                      if (actualCol === 5) {
                        shouldEnforce = true;
                      }
                      break;
                    }
                    actualCol += parseInt(row.children[i].getAttribute('colspan') || '1');
                  }
                }
              }
            }

            // 새 셀이 추가되면 즉시 확인 및 제거
            if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
              mutation.addedNodes.forEach(function(node) {
                if (node.nodeType === 1 && node.tagName === 'TD') {
                  const table = node.closest('table.below-zero-rate-table[data-below-zero-rate="true"]');
                  if (table === newTable) {
                    // 추가된 셀이 2~6행의 6열 셀인지 확인
                    const row = node.closest('tr');
                    if (row) {
                      const rowIndex = Array.from(newTable.querySelectorAll('tr')).indexOf(row);
                      if (rowIndex >= 1 && rowIndex <= 5) {
                        // 6열인지 확인
                        const rowCells = Array.from(row.querySelectorAll('td'));
                        let currentColIndex = 0;
                        for (let j = 0; j < rowCells.length; j++) {
                          const cell = rowCells[j];
                          const cellColspan = parseInt(cell.getAttribute('colspan') || '1');
                          const cellStartCol = currentColIndex;
                          const cellEndCol = currentColIndex + cellColspan - 1;

                          if (cell === node && cellStartCol <= 5 && cellEndCol >= 5) {
                            // 2~6행의 6열 셀이 추가되었으므로 즉시 제거
                            node.remove();
                            shouldEnforce = true;
                            console.log('2~6행의 6열 셀 추가 감지 및 제거 (행: ' + (rowIndex + 1) + ')');
                            break;
                          }

                          currentColIndex += cellColspan;
                        }
                      }
                    }
                  }
                }
              });
            }
          });

          // enforceColumn6Rowspan 호출 비활성화 (6열 병합 보호)
          // if (shouldEnforce) {
          //   setTimeout(enforceColumn6Rowspan, 10);
          // }
        });

        // MutationObserver 완전 비활성화 (6열 병합 보호)
        // if (newTable) {
        //   rowspanProtectionObserver.observe(newTable, {
        //     attributes: true,
        //     attributeFilter: ['rowspan', 'colspan'],
        //     childList: true,
        //     subtree: true
        //   });
        // }
      }

      // setTableSpacing 함수 제거됨 (오늘 만든 테이블 간격 조절 기능 제거)

      // 즉시 실행
      // 6열 병합 해제: 2행부터 6행까지 개별 셀 생성
      // window.ensureRowspanForColumn6(newTable);

      // 여러 시점에서 재설정 (다른 스크립트가 덮어쓸 수 있으므로)
      setTimeout(function() {
        // 6열 병합 해제: 2행부터 6행까지 개별 셀 생성
      // window.ensureRowspanForColumn6(newTable);
      }, 10);
      setTimeout(function() {
        // 6열 병합 해제: 2행부터 6행까지 개별 셀 생성
      // window.ensureRowspanForColumn6(newTable);
      }, 50);
      setTimeout(function() {
        // 6열 병합 해제: 2행부터 6행까지 개별 셀 생성
      // window.ensureRowspanForColumn6(newTable);
      }, 100);
      setTimeout(function() {
        // 6열 병합 해제: 2행부터 6행까지 개별 셀 생성
      // window.ensureRowspanForColumn6(newTable);
      }, 200);
      setTimeout(function() {
        // 6열 병합 해제: 2행부터 6행까지 개별 셀 생성
      // window.ensureRowspanForColumn6(newTable);
      }, 500);
      setTimeout(function() {
        // 6열 병합 해제: 2행부터 6행까지 개별 셀 생성
      // window.ensureRowspanForColumn6(newTable);
      }, 1000);
      setTimeout(function() {
        // 6열 병합 해제: 2행부터 6행까지 개별 셀 생성
      // window.ensureRowspanForColumn6(newTable);
      }, 2000);
      setTimeout(function() {
        // 6열 병합 해제: 2행부터 6행까지 개별 셀 생성
      // window.ensureRowspanForColumn6(newTable);
      }, 3000);

      // 테이블이 실제로 DOM에 있는지 확인하고, 없으면 다시 생성
      setTimeout(function() {
        const checkTable = document.querySelector('table.below-zero-rate-table[data-below-zero-rate="true"]');
        if (!checkTable || !checkTable.parentNode || !document.body.contains(checkTable)) {
          console.log('테이블이 DOM에서 제거되었습니다. 재생성합니다.');
          // 테이블이 이미 올바른 위치에 있으면 재생성하지 않음 (6열 병합 보호)
          insertTableBelowZeroRate();
        } else {
          // 테이블이 보이도록 다시 확인
          checkTable.style.display = 'table';
          checkTable.style.visibility = 'visible';
          checkTable.style.opacity = '1';
        }
      }, 300);

      // 여러 시점에서 테이블이 보이는지 확인
      setTimeout(function() {
        const checkTable = document.querySelector('table.below-zero-rate-table[data-below-zero-rate="true"]');
        if (checkTable) {
          checkTable.style.display = 'table';
          checkTable.style.visibility = 'visible';
          checkTable.style.opacity = '1';
        }
      }, 1000);

      setTimeout(function() {
        const checkTable = document.querySelector('table.below-zero-rate-table[data-below-zero-rate="true"]');
        if (checkTable) {
          checkTable.style.display = 'table';
          checkTable.style.visibility = 'visible';
          checkTable.style.opacity = '1';
        }
      }, 2000);
    } else {
      console.log('영세율 상호주의 테이블의 부모 노드를 찾을 수 없습니다.');
      // 부모 노드를 찾지 못했을 때도 재시도
      setTimeout(function() {
        insertTableBelowZeroRate();
      }, 500);
    }
  }

  // 폐업신고 테이블 아래에 1행 8열 테이블 추가
  function insertTableBelowClosureReport(closureTableParam) {
    let closureTable = closureTableParam;

    // 테이블 객체가 전달되지 않은 경우 찾기
    if (!closureTable) {
      const allTables = document.querySelectorAll('table');

      // "폐업신고" 테이블 찾기 (inserted-between-tables 클래스를 가진 테이블 우선)
      for (let i = 0; i < allTables.length; i++) {
        const table = allTables[i];
        const tableText = table.textContent || '';
        if (tableText.includes('폐업신고')) {
          // inserted-between-tables 클래스를 가진 테이블인지 확인
          if (table.classList && table.classList.contains('inserted-between-tables')) {
            closureTable = table;
            console.log('폐업신고 테이블 발견 (인덱스: ' + i + ', 클래스: inserted-between-tables)');
            break;
          }
        }
      }

      // 클래스로 찾지 못한 경우 텍스트로만 찾기
      if (!closureTable) {
        for (let i = 0; i < allTables.length; i++) {
          const table = allTables[i];
          const tableText = table.textContent || '';
          if (tableText.includes('폐업신고') &&
              (tableText.includes('③') || tableText.includes('3.') || tableText.trim().startsWith('③'))) {
            closureTable = table;
            console.log('폐업신고 테이블 발견 (인덱스: ' + i + ', 텍스트로 찾음)');
            break;
          }
        }
      }
    } else {
      console.log('폐업신고 테이블 객체를 직접 전달받았습니다.');
    }

    if (!closureTable) {
      console.log('폐업신고 테이블을 찾을 수 없습니다.');
      return;
    }

    // 이미 테이블이 삽입되었는지 확인 (중복 방지)
    // closure-report-detail-table 클래스를 가진 테이블이 이미 있는지 확인
    const existingDetailTables = document.querySelectorAll('table.closure-report-detail-table');
    if (existingDetailTables.length > 0) {
      console.log('이미 영세율 상호주의 상세 테이블이 존재합니다 (' + existingDetailTables.length + '개 발견).');
      return;
    }

    // 새 테이블 생성 (1행 8열)
    const newTable = document.createElement('table');
    newTable.setAttribute('class', 'closure-report-detail-table');

    // 폐업신고 테이블의 margin-left와 width를 확인하여 동일하게 설정
    const closureTableStyle = closureTable.getAttribute('style') || '';
    const closureMarginLeft = closureTableStyle.match(/margin-left\s*:\s*([^;]+)/i);
    const marginLeftValue = closureMarginLeft ? closureMarginLeft[1].trim() : '0';

    // 폐업신고 테이블의 실제 width를 읽어옴 (스타일 속성에서 직접 읽기)
    const closureWidthMatch = closureTableStyle.match(/width\s*:\s*([^;]+)/i);
    let closureTableWidth = 624; // 기본값
    if (closureWidthMatch) {
      const widthValue = closureWidthMatch[1].trim();
      closureTableWidth = parseFloat(widthValue) || 624;
    } else {
      // 스타일 속성에 없으면 computed style에서 읽기
      const closureComputedStyle = window.getComputedStyle(closureTable);
      closureTableWidth = parseFloat(closureComputedStyle.width) || 624;
    }

    newTable.setAttribute('style', 'width:' + closureTableWidth + 'pt;border-collapse:collapse;margin:0;margin-top:2pt;margin-bottom:2pt;margin-left:' + marginLeftValue + ';table-layout:fixed;box-sizing:border-box;');
    newTable.setAttribute('cellspacing', '0');

    // 1행 생성 (높이 20pt)
    const newRow = document.createElement('tr');
    newRow.setAttribute('style', 'height:20pt');

    // 폐업신고 테이블의 실제 열 폭을 읽어서 설정
    const closureTableRows = closureTable.querySelectorAll('tr');
    let columnWidths = [150, 118, 59, 59, 59, 59, 60, 60]; // 기본값

    if (closureTableRows.length > 0) {
      const firstRow = closureTableRows[0];
      const closureCells = firstRow.querySelectorAll('td');

      if (closureCells.length >= 2) {
        // 폐업신고 테이블의 1열, 2열 폭을 읽어옴 (스타일 속성에서 직접 읽기)
        const cell1Style = closureCells[0].getAttribute('style') || '';
        const cell2Style = closureCells[1].getAttribute('style') || '';
        const width1Match = cell1Style.match(/width\s*:\s*([^;]+)/i);
        const width2Match = cell2Style.match(/width\s*:\s*([^;]+)/i);
        const width1 = width1Match ? parseFloat(width1Match[1].trim()) : 150;
        const width2 = width2Match ? parseFloat(width2Match[1].trim()) : 118;

        // 나머지 열 폭 계산 (폐업신고 테이블의 나머지 열 폭 합계를 6개로 분배)
        let remainingWidth = 0;
        for (let i = 2; i < closureCells.length; i++) {
          const computedStyle = window.getComputedStyle(closureCells[i]);
          remainingWidth += parseFloat(computedStyle.width) || 0;
        }

        // 새 테이블의 전체 폭에서 1열, 2열 폭을 뺀 나머지 (폐업신고 테이블의 실제 width 사용)
        const totalWidth = closureTableWidth;
        const remainingForNewTable = totalWidth - width1 - width2;

        // 나머지 6개 열에 균등 분배
        const eachWidth = remainingForNewTable / 6;
        const width3to8 = [];
        let sum = 0;
        for (let i = 0; i < 5; i++) {
          width3to8.push(Math.floor(eachWidth));
          sum += Math.floor(eachWidth);
        }
        width3to8.push(Math.floor(remainingForNewTable - sum));

        columnWidths = [width1, width2, ...width3to8];
        console.log('폐업신고 테이블 열 폭: [' + columnWidths.join(', ') + ']');
      }
    }

    for (let c = 0; c < 8; c++) {
      const newCell = document.createElement('td');

      // 셀 스타일 설정
      let cellStyle = 'vertical-align:middle;width:' + columnWidths[c] + 'pt;';

      // 외곽선: 상하만 검정 (좌우 세로 테두리 제거)
      cellStyle += 'border-top:1pt solid #000;';
      cellStyle += 'border-bottom:1pt solid #000;';

      // 내부 간선: 좌우는 #7E7E7E (모든 열에 적용)
      if (c > 0) {
        cellStyle += 'border-left:1pt solid #7E7E7E;';
      }

      newCell.setAttribute('style', cellStyle);

      // 각 열에 맞는 내용 추가
      if (c === 0) {
        // 1열: ④ 영세율 상호주의 (폐업신고와 동일한 폰트, ④ 앞에 3pt 간격, 좌측정렬)
        newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;font-size: 10pt;"><span style="margin-left: 3pt;">④</span> <span style="font-weight: bold;">영세율 상호주의</span></p>';
      } else if (c === 1) {
        // 2열: 해당[체크박스] 미해당[체크박스]
        newCell.style.textAlign = 'center';
        newCell.style.padding = '0';
        const container = document.createElement('div');
        container.style.display = 'flex';
        container.style.alignItems = 'center';
        container.style.justifyContent = 'center';
        container.style.gap = '5pt';

        const label1 = document.createElement('span');
        label1.textContent = '해당[';
        label1.style.fontSize = '9pt';
        label1.style.fontFamily = '돋움체, monospace';

        const radio1 = document.createElement('input');
        radio1.type = 'radio';
        radio1.name = 'zero-rate-applicable';
        radio1.className = 'zero-rate-radio';
        radio1.value = 'applicable';
        radio1.style.width = '7pt';
        radio1.style.height = '7pt';
        radio1.style.margin = '0';
        radio1.style.padding = '0';
        radio1.style.verticalAlign = 'middle';

        const label1End = document.createElement('span');
        label1End.textContent = ']';
        label1End.style.fontSize = '9pt';
        label1End.style.fontFamily = '돋움체, monospace';

        const label2 = document.createElement('span');
        label2.textContent = '미해당[';
        label2.style.fontSize = '9pt';
        label2.style.fontFamily = '돋움체, monospace';
        label2.style.marginLeft = '5pt';

        const radio2 = document.createElement('input');
        radio2.type = 'radio';
        radio2.name = 'zero-rate-applicable';
        radio2.className = 'zero-rate-radio';
        radio2.value = 'not-applicable';
        radio2.style.width = '7pt';
        radio2.style.height = '7pt';
        radio2.style.margin = '0';
        radio2.style.padding = '0';
        radio2.style.verticalAlign = 'middle';

        const label2End = document.createElement('span');
        label2End.textContent = ']';
        label2End.style.fontSize = '9pt';
        label2End.style.fontFamily = '돋움체, monospace';

        container.appendChild(label1);
        container.appendChild(radio1);
        container.appendChild(label1End);
        container.appendChild(label2);
        container.appendChild(radio2);
        container.appendChild(label2End);

        newCell.innerHTML = '';
        newCell.appendChild(container);
      } else if (c === 2) {
        // 3열: 적용구분 텍스트 (중앙정렬)
        newCell.innerHTML = '<p style="text-indent: 0pt;text-align: center;font-size: 9pt;">적용구분</p>';
      } else if (c === 3) {
        // 4열: 입력박스 (셀크기에 맞춤, 다른 테이블의 입력박스와 동일한 테두리)
        newCell.style.position = 'relative';
        newCell.style.padding = '0';
        const input1 = document.createElement('input');
        input1.type = 'text';
        input1.className = 'text-input';
        input1.style.position = 'absolute';
        input1.style.left = '0';
        input1.style.top = '0';
        input1.style.width = '100%';
        input1.style.height = '100%';
        input1.style.border = 'none';
        input1.style.background = 'transparent';
        input1.style.fontSize = '9pt';
        input1.style.fontFamily = 'Arial, sans-serif';
        input1.style.textAlign = 'center';
        input1.style.outline = 'none';
        input1.style.padding = '0';
        input1.style.margin = '0';
        input1.style.boxSizing = 'border-box';
        input1.style.lineHeight = '1em';
        newCell.innerHTML = '';
        newCell.appendChild(input1);
      } else if (c === 4) {
        // 5열: 업종 텍스트 (중앙정렬)
        newCell.innerHTML = '<p style="text-indent: 0pt;text-align: center;font-size: 9pt;">업종</p>';
      } else if (c === 5) {
        // 6열: 입력박스
        newCell.style.position = 'relative';
        newCell.style.padding = '0';
        const input2 = document.createElement('input');
        input2.type = 'text';
        input2.className = 'text-input';
        input2.style.position = 'absolute';
        input2.style.left = '0';
        input2.style.top = '0';
        input2.style.width = '100%';
        input2.style.height = '100%';
        input2.style.border = 'none';
        input2.style.background = 'transparent';
        input2.style.fontSize = '9pt';
        input2.style.fontFamily = 'Arial, sans-serif';
        input2.style.textAlign = 'center';
        input2.style.outline = 'none';
        input2.style.padding = '0';
        input2.style.margin = '0';
        input2.style.boxSizing = 'border-box';
        input2.style.lineHeight = '1em';
        newCell.innerHTML = '';
        newCell.appendChild(input2);
      } else if (c === 6) {
        // 7열: 해당국가 텍스트 (중앙정렬)
        newCell.innerHTML = '<p style="text-indent: 0pt;text-align: center;font-size: 9pt;">해당국가</p>';
      } else if (c === 7) {
        // 8열: 입력박스
        newCell.style.position = 'relative';
        newCell.style.padding = '0';
        const input3 = document.createElement('input');
        input3.type = 'text';
        input3.className = 'text-input';
        input3.style.position = 'absolute';
        input3.style.left = '0';
        input3.style.top = '0';
        input3.style.width = '100%';
        input3.style.height = '100%';
        input3.style.border = 'none';
        input3.style.background = 'transparent';
        input3.style.fontSize = '9pt';
        input3.style.fontFamily = 'Arial, sans-serif';
        input3.style.textAlign = 'center';
        input3.style.outline = 'none';
        input3.style.padding = '0';
        input3.style.margin = '0';
        input3.style.boxSizing = 'border-box';
        input3.style.lineHeight = '1em';
        newCell.innerHTML = '';
        newCell.appendChild(input3);
      }

      newRow.appendChild(newCell);
    }

    newTable.appendChild(newRow);

    // 폐업신고 테이블 다음에 삽입
    if (closureTable && closureTable.parentNode) {
      closureTable.parentNode.insertBefore(newTable, closureTable.nextSibling);
      console.log('폐업신고 테이블 아래에 1행 8열 테이블 삽입 완료');

      // 폐업신고 테이블과 새 테이블 사이 간격을 2pt로 설정 (여러 번 확인하여 덮어쓰기 방지)
      function setClosureTableSpacing() {
        // 폐업신고 테이블의 margin-bottom을 2pt로 설정 (CSS의 !important가 적용되도록)
        let closureTableStyle = closureTable.getAttribute('style') || '';
        closureTableStyle = closureTableStyle.replace(/margin-bottom\s*:\s*[^;]+;?/gi, '');
        if (closureTableStyle && !closureTableStyle.endsWith(';') && closureTableStyle.trim() !== '') {
          closureTableStyle += ';';
        }
        closureTableStyle += 'margin-bottom:2pt;';
        closureTable.setAttribute('style', closureTableStyle);

        // 새 테이블의 margin-top을 2pt로 설정하고, margin-left를 폐업신고 테이블과 동일하게 설정
        let newTableStyle = newTable.getAttribute('style') || '';
        newTableStyle = newTableStyle.replace(/margin-top\s*:\s*[^;]+;?/gi, '');

        // 폐업신고 테이블의 margin-left를 확인하여 동일하게 설정
        const computedClosureStyle = window.getComputedStyle(closureTable);
        const closureMarginLeft = computedClosureStyle.marginLeft;

        newTableStyle = newTableStyle.replace(/margin-left\s*:\s*[^;]+;?/gi, '');
        if (newTableStyle && !newTableStyle.endsWith(';') && newTableStyle.trim() !== '') {
          newTableStyle += ';';
        }
        newTableStyle += 'margin-top:2pt;margin-left:' + closureMarginLeft + ';';
        newTable.setAttribute('style', newTableStyle);
      }

      // 즉시 실행
      setClosureTableSpacing();

      // 여러 번 확인하여 다른 코드에 의해 덮어쓰여지는 것을 방지
      setTimeout(setClosureTableSpacing, 10);
      setTimeout(setClosureTableSpacing, 100);
      setTimeout(setClosureTableSpacing, 200);
      setTimeout(setClosureTableSpacing, 500);
      setTimeout(setClosureTableSpacing, 1000);

      console.log('폐업신고 테이블과 새 테이블 사이 간격 2pt 설정 완료');

      // 영세율 상호주의 테이블 아래에 6열 7행 테이블 추가
      // 영세율 상호주의 테이블이 생성된 직후 즉시 호출
      insertTableBelowZeroRate();
    } else {
      console.log('폐업신고 테이블의 부모 노드를 찾을 수 없습니다.');
    }
  }

  // 특정 텍스트들의 폰트 크기를 10pt로 설정
  function setSectionTextFontSize10pt() {
    // ② 국세환급금 계좌신고
    setTextFontSize10pt(['국세환급금 계좌신고', '②', '2.'], '국세환급금 계좌신고');

    // ④ 영세율 상호주의
    setTextFontSize10pt(['영세율 상호주의', '④', '4.'], '영세율 상호주의');

    // ⑤ 과 세 표 준 명 세 (별도 처리 - 공백 포함 텍스트도 검색)
    const allTables = document.querySelectorAll('table');
    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const cells = table.querySelectorAll('td');

      for (let j = 0; j < cells.length; j++) {
        const cell = cells[j];
        const cellText = cell.textContent || '';
        const normalizedText = cellText.replace(/\s+/g, '');

        // "과세표준명세" 또는 "⑤"와 "과세" 또는 "표준"이 함께 있는 경우
        if (cellText.includes('과세표준명세') ||
            normalizedText.includes('과세표준명세') ||
            (cellText.includes('⑤') && (cellText.includes('과세') || cellText.includes('표준'))) ||
            (cellText.includes('5.') && (cellText.includes('과세') || cellText.includes('표준')))) {

          // 셀 스타일 수정 (좌측 정렬 및 좌측 여백 3pt)
          let cellStyle = cell.getAttribute('style') || '';
          cellStyle = cellStyle.replace(/padding-left\s*:\s*[^;]+;?/gi, '');
          cellStyle = cellStyle.replace(/text-align\s*:\s*[^;]+;?/gi, '');
          if (cellStyle && !cellStyle.endsWith(';') && cellStyle.trim() !== '') {
            cellStyle += ';';
          }
          cellStyle += 'padding-left:3pt;text-align:left;';
          cell.setAttribute('style', cellStyle);

          const textElements = cell.querySelectorAll('p, span');
          if (textElements.length > 0) {
            textElements.forEach(function(element) {
              let elementStyle = element.getAttribute('style') || '';
              elementStyle = elementStyle.replace(/font-size\s*:\s*[^;]+;?/gi, '');
              elementStyle = elementStyle.replace(/text-align\s*:\s*[^;]+;?/gi, '');
              elementStyle = elementStyle.replace(/padding-left\s*:\s*[^;]+;?/gi, '');
              elementStyle = elementStyle.replace(/;;+/g, ';').replace(/^;|;$/g, '');
              if (elementStyle && !elementStyle.endsWith(';') && elementStyle.trim() !== '') {
                elementStyle += ';';
              }
              elementStyle += 'font-size:10pt;text-align:left;padding-left:0;';
              element.setAttribute('style', elementStyle);
            });
          } else {
            let cellStyle2 = cell.getAttribute('style') || '';
            cellStyle2 = cellStyle2.replace(/font-size\s*:\s*[^;]+;?/gi, '');
            cellStyle2 = cellStyle2.replace(/;;+/g, ';').replace(/^;|;$/g, '');
            if (cellStyle2 && !cellStyle2.endsWith(';') && cellStyle2.trim() !== '') {
              cellStyle2 += ';';
            }
            cellStyle2 += 'font-size:10pt;';
            cell.setAttribute('style', cellStyle2);
          }

          console.log('과세표준명세 텍스트 폰트 크기 10pt 및 좌측 정렬 설정 완료');
          break; // 첫 번째 매칭 셀만 처리
        }
      }
    }
  }

  // 국세환급금 계좌신고 테이블 및 아래 테이블들의 폭을 624pt로 설정하고 좌측 정렬
  function adjustTablesBelowAccountReport() {
    adjustTablesByKeyword('국세환급금 계좌신고', '국세환급금 계좌신고');
  }

  // 과세표준명세 테이블 및 아래 테이블들의 폭을 624pt로 설정하고 좌측 정렬 - 동적 기능 제거 (흔들림 방지)
  function adjustTaxBaseDetailTables() {
    // adjustTablesByKeyword('과세표준명세', '과세표준명세'); // 동적 기능 제거 - 테이블 흔들림 방지
  }

  // 업태 텍스트가 있는 테이블의 모든 병합 해제
  // unmergeAllCellsInBusinessTypeTable 함수 삭제됨

  // 신고 확인 텍스트가 있는 테이블의 모든 병합 해제
  let declarationConfirmTableUnmerged = false;
  let declarationConfirmTableSearched = false; // 검색 시도 플래그

  function unmergeAllCellsInDeclarationConfirmTable() {
    // 이미 검색을 시도했으면 실행하지 않음 (무한 루프 방지)
    if (declarationConfirmTableSearched) {
      return;
    }

    // 플래그를 먼저 설정하여 재시도 방지
    declarationConfirmTableSearched = true;

    const allTables = document.querySelectorAll('table');
    let declarationConfirmTable = null;

    // 해당 텍스트가 포함된 테이블 찾기
    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const tableText = table.textContent || '';
      // 공백 제거하여 비교
      const normalizedText = tableText.replace(/\s+/g, '');

      if (tableText.includes('부가가치세법') && tableText.includes('제48조') &&
          tableText.includes('국세기본법') && tableText.includes('제45조') &&
          (tableText.includes('신고하며') || tableText.includes('확인합니다'))) {
        declarationConfirmTable = table;
        console.log('신고 확인 텍스트가 있는 테이블 발견 (인덱스: ' + i + ')');
        break;
      }
    }

    if (!declarationConfirmTable) {
      console.log('신고 확인 텍스트가 있는 테이블을 찾지 못했습니다. (재시도하지 않음)');
      return;
    }

    const allRows = Array.from(declarationConfirmTable.querySelectorAll('tr'));
    console.log('신고 확인 테이블 총 행 수: ' + allRows.length);

    // 병합된 셀이 있는지 먼저 확인
    let hasMergedCells = false;
    for (let rowIdx = 0; rowIdx < allRows.length; rowIdx++) {
      const row = allRows[rowIdx];
      const cells = Array.from(row.querySelectorAll('td'));
      for (let cellIdx = 0; cellIdx < cells.length; cellIdx++) {
        const cell = cells[cellIdx];
        const rowspan = parseInt(cell.getAttribute('rowspan') || '1', 10);
        const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);
        if (rowspan > 1 || colspan > 1) {
          hasMergedCells = true;
          break;
        }
      }
      if (hasMergedCells) break;
    }

    if (!hasMergedCells) {
      console.log('신고 확인 테이블에 병합된 셀이 없습니다.');
      declarationConfirmTableUnmerged = true;
      return;
    }

    console.log('신고 확인 테이블에서 병합된 셀 발견, 병합 해제 시작...');

    // 1단계: 모든 rowspan 처리
    const rowspanCells = [];
    for (let rowIdx = 0; rowIdx < allRows.length; rowIdx++) {
      const row = allRows[rowIdx];
      const cells = Array.from(row.querySelectorAll('td'));
      let colPos = 0;

      for (let cellIdx = 0; cellIdx < cells.length; cellIdx++) {
        const cell = cells[cellIdx];
        const rowspan = parseInt(cell.getAttribute('rowspan') || '1', 10);
        const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);

        if (rowspan > 1) {
          rowspanCells.push({
            rowIdx: rowIdx,
            cellIdx: cellIdx,
            cell: cell,
            rowspan: rowspan,
            colspan: colspan,
            colPos: colPos
          });
          console.log('rowspan 발견: 행' + (rowIdx + 1) + ', 열위치' + colPos + ', rowspan=' + rowspan + ', colspan=' + colspan);
        }

        colPos += colspan;
      }
    }

    // 역순으로 처리 (아래 행부터 위로)
    for (let i = rowspanCells.length - 1; i >= 0; i--) {
      const item = rowspanCells[i];
      const cell = item.cell;
      const rowIdx = item.rowIdx;
      const rowspan = item.rowspan;
      const colspan = item.colspan;
      const colPos = item.colPos;
      const cellStyle = cell.getAttribute('style') || '';

      // rowspan 제거
      cell.removeAttribute('rowspan');

      // 아래 행들에 빈 셀 추가
      for (let r = 1; r < rowspan; r++) {
        const targetRowIdx = rowIdx + r;
        if (targetRowIdx < allRows.length) {
          const targetRow = allRows[targetRowIdx];
          const targetCells = Array.from(targetRow.querySelectorAll('td'));

          // 실제 열 위치 계산 (targetRow에서)
          let targetColPos = 0;
          let insertBeforeCell = null;
          let insertIndex = 0;

          for (let tc = 0; tc < targetCells.length; tc++) {
            const tcColspan = parseInt(targetCells[tc].getAttribute('colspan') || '1', 10);
            if (targetColPos >= colPos) {
              insertBeforeCell = targetCells[tc];
              insertIndex = tc;
              break;
            }
            targetColPos += tcColspan;
            insertIndex = tc + 1;
          }

          // 새 셀 생성
          const newCell = document.createElement('td');
          newCell.setAttribute('style', cellStyle);
          if (colspan > 1) {
            newCell.setAttribute('colspan', colspan.toString());
          }
          newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';

          if (colPos === 0) {
            targetRow.insertBefore(newCell, targetRow.firstChild);
          } else if (insertBeforeCell) {
            targetRow.insertBefore(newCell, insertBeforeCell);
          } else if (insertIndex < targetCells.length) {
            targetRow.insertBefore(newCell, targetCells[insertIndex]);
          } else {
            targetRow.appendChild(newCell);
          }
        }
      }
    }

    // 2단계: 모든 colspan 처리 (여러 번 반복하여 완전히 해제)
    let hasColspan = true;
    let iterationCount = 0;
    const maxIterations = 50;

    while (hasColspan && iterationCount < maxIterations) {
      hasColspan = false;
      iterationCount++;

      // 행 목록 다시 가져오기
      allRows.length = 0;
      allRows.push(...Array.from(declarationConfirmTable.querySelectorAll('tr')));

      for (let rowIdx = 0; rowIdx < allRows.length; rowIdx++) {
        const row = allRows[rowIdx];
        const cells = Array.from(row.querySelectorAll('td'));
        const cellsToProcess = [];

        // 모든 colspan 셀 수집
        cells.forEach(function(cell) {
          const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);
          const rowspan = parseInt(cell.getAttribute('rowspan') || '1', 10);
          if (colspan > 1) {
            hasColspan = true;
            cellsToProcess.push({
              cell: cell,
              colspan: colspan,
              rowspan: rowspan
            });
            console.log('colspan 발견: 행' + (rowIdx + 1) + ', colspan=' + colspan + ', rowspan=' + rowspan);
          }
        });

        // 각 colspan 셀 처리 (역순으로 처리하여 인덱스 문제 방지)
        for (let i = cellsToProcess.length - 1; i >= 0; i--) {
          const item = cellsToProcess[i];
          const cell = item.cell;
          const colspan = item.colspan;
          const rowspan = item.rowspan;
          const cellStyle = cell.getAttribute('style') || '';

          // 기존 셀의 내용 확인
          const cellContent = cell.innerHTML;
          const hasInput = cell.querySelector('input, select, textarea');

          // 원래 셀 제거
          const nextSibling = cell.nextElementSibling;
          cell.remove();

          // 개별 셀들 생성
          for (let c = 0; c < colspan; c++) {
            const newCell = document.createElement('td');
            newCell.setAttribute('style', cellStyle);

            // rowspan이 있으면 유지 (colspan만 해제)
            if (rowspan > 1) {
              newCell.setAttribute('rowspan', rowspan.toString());
            }

            // 첫 번째 셀에만 원래 내용 유지 (입력 필드가 있는 경우는 제외)
            if (c === 0 && !hasInput) {
              newCell.innerHTML = cellContent;
            } else {
              newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';
            }

            if (nextSibling) {
              row.insertBefore(newCell, nextSibling);
            } else {
              row.appendChild(newCell);
            }
          }
        }
      }
    }

    // 3단계: rowspan이 남아있는 경우 다시 처리
    let hasRowspan = true;
    let rowspanIterationCount = 0;
    const maxRowspanIterations = 30;

    while (hasRowspan && rowspanIterationCount < maxRowspanIterations) {
      hasRowspan = false;
      rowspanIterationCount++;

      // 행 목록 다시 가져오기
      allRows.length = 0;
      allRows.push(...Array.from(declarationConfirmTable.querySelectorAll('tr')));

      // 모든 rowspan 셀 수집 (역순으로 처리)
      const remainingRowspanCells = [];
      for (let rowIdx = 0; rowIdx < allRows.length; rowIdx++) {
        const row = allRows[rowIdx];
        const cells = Array.from(row.querySelectorAll('td'));
        let colPos = 0;

        for (let cellIdx = 0; cellIdx < cells.length; cellIdx++) {
          const cell = cells[cellIdx];
          const rowspan = parseInt(cell.getAttribute('rowspan') || '1', 10);
          const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);

          if (rowspan > 1) {
            hasRowspan = true;
            remainingRowspanCells.push({
              rowIdx: rowIdx,
              cellIdx: cellIdx,
              cell: cell,
              rowspan: rowspan,
              colspan: colspan,
              colPos: colPos
            });
          }

          colPos += colspan;
        }
      }

      // 역순으로 처리
      for (let i = remainingRowspanCells.length - 1; i >= 0; i--) {
        const item = remainingRowspanCells[i];
        const cell = item.cell;
        const rowIdx = item.rowIdx;
        const rowspan = item.rowspan;
        const colspan = item.colspan;
        const colPos = item.colPos;
        const cellStyle = cell.getAttribute('style') || '';

        // rowspan 제거
        cell.removeAttribute('rowspan');

        // 아래 행들에 빈 셀 추가
        for (let r = 1; r < rowspan; r++) {
          const targetRowIdx = rowIdx + r;
          if (targetRowIdx < allRows.length) {
            const targetRow = allRows[targetRowIdx];
            const targetCells = Array.from(targetRow.querySelectorAll('td'));

            // 실제 열 위치 계산
            let targetColPos = 0;
            let insertBeforeCell = null;
            let insertIndex = 0;

            for (let tc = 0; tc < targetCells.length; tc++) {
              const tcColspan = parseInt(targetCells[tc].getAttribute('colspan') || '1', 10);
              if (targetColPos >= colPos) {
                insertBeforeCell = targetCells[tc];
                insertIndex = tc;
                break;
              }
              targetColPos += tcColspan;
              insertIndex = tc + 1;
            }

            // 새 셀 생성
            const newCell = document.createElement('td');
            newCell.setAttribute('style', cellStyle);
            if (colspan > 1) {
              newCell.setAttribute('colspan', colspan.toString());
            }
            newCell.innerHTML = '<p style="text-indent: 0pt;text-align: left;"><br/></p>';

            if (colPos === 0) {
              targetRow.insertBefore(newCell, targetRow.firstChild);
            } else if (insertBeforeCell) {
              targetRow.insertBefore(newCell, insertBeforeCell);
            } else if (insertIndex < targetCells.length) {
              targetRow.insertBefore(newCell, targetCells[insertIndex]);
            } else {
              targetRow.appendChild(newCell);
            }
          }
        }
      }
    }

    // 최종 확인: 병합이 모두 해제되었는지 확인
    allRows.length = 0;
    allRows.push(...Array.from(declarationConfirmTable.querySelectorAll('tr')));
    let stillHasMerged = false;
    for (let rowIdx = 0; rowIdx < allRows.length; rowIdx++) {
      const row = allRows[rowIdx];
      const cells = Array.from(row.querySelectorAll('td'));
      for (let cellIdx = 0; cellIdx < cells.length; cellIdx++) {
        const cell = cells[cellIdx];
        const rowspan = parseInt(cell.getAttribute('rowspan') || '1', 10);
        const colspan = parseInt(cell.getAttribute('colspan') || '1', 10);
        if (rowspan > 1 || colspan > 1) {
          stillHasMerged = true;
          console.log('경고: 행' + (rowIdx + 1) + ', 셀' + (cellIdx + 1) + '에 여전히 병합이 있습니다 (rowspan=' + rowspan + ', colspan=' + colspan + ')');
        }
      }
    }

    if (!stillHasMerged) {
      declarationConfirmTableUnmerged = true;
      console.log('신고 확인 테이블 병합 해제 완료 (colspan 반복: ' + iterationCount + '회, rowspan 반복: ' + rowspanIterationCount + '회)');
    } else {
      console.log('신고 확인 테이블 병합 해제 시도 완료, 일부 병합이 남아있을 수 있습니다 (colspan 반복: ' + iterationCount + '회, rowspan 반복: ' + rowspanIterationCount + '회)');
      declarationConfirmTableUnmerged = false;
    }
  }

  // 과세표준명세 테이블의 모든 병합 해제 함수 완전 삭제됨 (6열 병합 보호를 위해)

  // 과세표준명세 테이블의 모든 셀에 테두리 추가
  function addBordersToTaxBaseDetailTable() {
    const allTables = document.querySelectorAll('table');
    let taxBaseDetailTable = null;

    // "⑤ 과세표준명세" 텍스트가 포함된 테이블 찾기 (엄격한 검색)
    // below-zero-rate-table은 제외 (6열 병합 보호)
    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      // below-zero-rate-table은 제외
      if (table.classList.contains('below-zero-rate-table') &&
          table.getAttribute('data-below-zero-rate') === 'true') {
        continue; // 이 테이블은 건너뜀 (6열 병합 보호)
      }

      const tableText = table.textContent || '';
      const normalizedText = tableText.replace(/\s+/g, '');
      const textWithoutSpaces = tableText.replace(/\s/g, '');

      // "⑤"와 "과세표준명세"가 모두 있는 경우 우선 선택
      if ((tableText.includes('⑤') && tableText.includes('과세표준명세')) ||
          textWithoutSpaces.includes('⑤과세표준명세')) {
        taxBaseDetailTable = table;
        console.log('과세표준명세 테이블 발견 (테두리 추가 대상, 엄격한 검색)');
        break;
      }
    }

    // 엄격한 검색으로 찾지 못한 경우 일반 검색
    if (!taxBaseDetailTable) {
      for (let i = 0; i < allTables.length; i++) {
        const table = allTables[i];
        // below-zero-rate-table은 제외
        if (table.classList.contains('below-zero-rate-table') &&
            table.getAttribute('data-below-zero-rate') === 'true') {
          continue; // 이 테이블은 건너뜀 (6열 병합 보호)
        }

        const tableText = table.textContent || '';
        const normalizedText = tableText.replace(/\s+/g, '');
        const textWithoutSpaces = tableText.replace(/\s/g, '');

        if (tableText.includes('과세표준명세') ||
            normalizedText.includes('과세표준명세') ||
            (tableText.includes('⑤') && (tableText.includes('과세') || tableText.includes('표준')))) {
          taxBaseDetailTable = table;
          console.log('과세표준명세 테이블 발견 (테두리 추가 대상, 일반 검색)');
          break;
        }
      }
    }

    if (!taxBaseDetailTable) {
      console.log('과세표준명세 테이블을 찾지 못했습니다 (테두리 추가)');
      return;
    }

    // 테이블에 border-collapse 설정
    let tableStyle = taxBaseDetailTable.getAttribute('style') || '';
    tableStyle = tableStyle.replace(/border-collapse[^;]*;?/gi, '');
    if (tableStyle && !tableStyle.endsWith(';') && tableStyle.trim() !== '') {
      tableStyle += ';';
    }
    tableStyle += 'border-collapse:collapse;';
    taxBaseDetailTable.setAttribute('style', tableStyle);

    // 모든 셀에 테두리 강제 추가
    // rowspan이 있는 셀도 포함하여 처리 (테이블 구조는 변경하지 않음)
    const allCells = taxBaseDetailTable.querySelectorAll('td, th');
    let borderAddedCount = 0;

    allCells.forEach(function(cell) {
      // rowspan이 있는 셀은 건너뛰지 않음 (테두리만 추가)
      let cellStyle = cell.getAttribute('style') || '';

      // 기존 border 스타일 모두 제거
      cellStyle = cellStyle.replace(/border[^;]*;?/gi, '');
      cellStyle = cellStyle.replace(/border-top[^;]*;?/gi, '');
      cellStyle = cellStyle.replace(/border-bottom[^;]*;?/gi, '');
      cellStyle = cellStyle.replace(/border-left[^;]*;?/gi, '');
      cellStyle = cellStyle.replace(/border-right[^;]*;?/gi, '');

      // 모든 방향에 테두리 추가
      if (cellStyle && !cellStyle.endsWith(';') && cellStyle.trim() !== '') {
        cellStyle += ';';
      }
      cellStyle += 'border:1pt solid #7E7E7E;';

      cell.setAttribute('style', cellStyle);
      borderAddedCount++;
    });

    if (borderAddedCount > 0) {
      console.log('과세표준명세 테이블: ' + borderAddedCount + '개 셀에 테두리 추가 완료');
    } else {
      console.log('과세표준명세 테이블: 모든 셀에 이미 테두리가 있습니다');
    }
  }

  // 과세표준명세 테이블 삭제 (엄격한 검색 조건으로 다른 테이블 보호)
  let taxBaseDetailTableRemoved = false;

  function removeTaxBaseDetailTable() {
    // 이미 삭제되었으면 실행하지 않음
    if (taxBaseDetailTableRemoved) {
      return;
    }

    const allTables = document.querySelectorAll('table');
    let taxBaseDetailTable = null;

    // "과세표준명세" 텍스트가 포함된 테이블 찾기 (엄격한 조건)
    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const tableText = table.textContent || '';
      const normalizedText = tableText.replace(/\s+/g, '');
      const textWithoutSpaces = tableText.replace(/\s/g, '');

      // 엄격한 검색: "⑤"와 "과세표준명세"가 모두 있어야 함
      // "과세표준"만으로는 매칭하지 않음 (다른 테이블 보호)
      const hasExactMatch = (
        (tableText.includes('⑤') && tableText.includes('과세표준명세')) ||
        textWithoutSpaces.includes('⑤과세표준명세')
      );

      // 추가 확인: "업태"가 같은 테이블에 있는지 확인 (과세표준명세 테이블의 특징)
      const hasBusinessType = tableText.includes('업태') || normalizedText.includes('업태');

      if (hasExactMatch && hasBusinessType) {
        taxBaseDetailTable = table;
        console.log('과세표준명세 테이블 발견 (인덱스: ' + i + ', 업태 포함 확인됨), 삭제합니다.');
        break;
      } else if (hasExactMatch) {
        // "⑤ 과세표준명세"가 명확히 있는 경우만 삭제
        taxBaseDetailTable = table;
        console.log('과세표준명세 테이블 발견 (인덱스: ' + i + '), 삭제합니다.');
        break;
      }
    }

    if (!taxBaseDetailTable) {
      // 테이블을 찾지 못했으면 재시도하지 않음 (무한 루프 방지)
      console.log('과세표준명세 테이블을 찾지 못했습니다. (엄격한 검색 조건으로 다른 테이블은 보호됨)');
      return;
    }

    // 테이블 삭제
    try {
      taxBaseDetailTable.remove();
      taxBaseDetailTableRemoved = true;
      console.log('과세표준명세 테이블 삭제 완료');
    } catch (e) {
      console.log('과세표준명세 테이블 삭제 중 오류 발생: ' + e.message);
      taxBaseDetailTableRemoved = true;
    }
  }

  // MutationObserver로 동적으로 생성되는 테이블도 감지하여 삭제 (엄격한 조건)
  function setupTaxBaseDetailTableObserver() {
    if (taxBaseDetailTableRemoved) {
      return;
    }

    const observer = new MutationObserver(function(mutations) {
      if (taxBaseDetailTableRemoved) {
        observer.disconnect();
        return;
      }

      const allTables = document.querySelectorAll('table');
      for (let i = 0; i < allTables.length; i++) {
        const table = allTables[i];
        const tableText = table.textContent || '';
        const normalizedText = tableText.replace(/\s+/g, '');
        const textWithoutSpaces = tableText.replace(/\s/g, '');

        // 엄격한 검색 조건
        const hasExactMatch = (
          (tableText.includes('⑤') && tableText.includes('과세표준명세')) ||
          textWithoutSpaces.includes('⑤과세표준명세')
        );

        const hasBusinessType = tableText.includes('업태') || normalizedText.includes('업태');

        if (hasExactMatch && hasBusinessType) {
          console.log('과세표준명세 테이블이 동적으로 생성되었습니다. 삭제합니다.');
          table.remove();
          taxBaseDetailTableRemoved = true;
          observer.disconnect();
          break;
        } else if (hasExactMatch) {
          console.log('과세표준명세 테이블이 동적으로 생성되었습니다. 삭제합니다.');
          table.remove();
          taxBaseDetailTableRemoved = true;
          observer.disconnect();
          break;
        }
      }
    });

    observer.observe(document.body, {
      childList: true,
      subtree: true
    });

    console.log('과세표준명세 테이블 감시 시작 (엄격한 조건 적용)');
  }

  // 과세표준명세 테이블과 업태 테이블이 같은 테이블인지 확인
  function checkTaxBaseDetailAndBusinessTypeTables() {
    const allTables = document.querySelectorAll('table');
    let taxBaseDetailTable = null;
    let businessTypeTable = null;

    // "과세표준명세" 텍스트가 포함된 테이블 찾기
    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const tableText = table.textContent || '';
      const normalizedText = tableText.replace(/\s+/g, '');
      const textWithoutSpaces = tableText.replace(/\s/g, '');

      if (tableText.includes('과세표준명세') ||
          tableText.includes('과세표준') ||
          normalizedText.includes('과세표준명세') ||
          textWithoutSpaces.includes('⑤과세표준명세') ||
          textWithoutSpaces.includes('⑤과세표준') ||
          (tableText.includes('⑤') && (tableText.includes('과세') || tableText.includes('표준')))) {
        taxBaseDetailTable = table;
        console.log('과세표준명세 테이블 발견 (인덱스: ' + i + ')');
      }

      // "업태" 텍스트가 포함된 테이블 찾기
      if (tableText.includes('업태') || normalizedText.includes('업태')) {
        businessTypeTable = table;
        console.log('업태 테이블 발견 (인덱스: ' + i + ')');
      }
    }

    if (!taxBaseDetailTable) {
      console.log('과세표준명세 테이블을 찾지 못했습니다.');
      return;
    }

    if (!businessTypeTable) {
      console.log('업태 테이블을 찾지 못했습니다.');
      return;
    }

    // 같은 테이블인지 확인
    if (taxBaseDetailTable === businessTypeTable) {
      console.log('=== 확인 결과: 과세표준명세 테이블과 업태 테이블은 같은 테이블입니다. ===');
      const allRows = Array.from(taxBaseDetailTable.querySelectorAll('tr'));
      console.log('테이블 총 행 수: ' + allRows.length);

      // 각 행의 내용 확인
      allRows.forEach(function(row, idx) {
        const rowText = row.textContent || '';
        console.log('행' + (idx + 1) + ': ' + rowText.substring(0, 100));
      });
    } else {
      console.log('=== 확인 결과: 과세표준명세 테이블과 업태 테이블은 별도의 테이블입니다. ===');
      const taxRows = Array.from(taxBaseDetailTable.querySelectorAll('tr'));
      const businessRows = Array.from(businessTypeTable.querySelectorAll('tr'));
      console.log('과세표준명세 테이블 행 수: ' + taxRows.length);
      console.log('업태 테이블 행 수: ' + businessRows.length);

      // 각 테이블의 내용 확인
      console.log('과세표준명세 테이블 내용:');
      taxRows.forEach(function(row, idx) {
        const rowText = row.textContent || '';
        console.log('  행' + (idx + 1) + ': ' + rowText.substring(0, 100));
      });

      console.log('업태 테이블 내용:');
      businessRows.forEach(function(row, idx) {
        const rowText = row.textContent || '';
        console.log('  행' + (idx + 1) + ': ' + rowText.substring(0, 100));
      });
    }
  }

  // 과세표준명세 테이블 아래 테이블과의 간격을 2pt로 설정
  function setMarginBelowTaxBaseDetailTable() {
    const allTables = document.querySelectorAll('table');
    let taxBaseDetailTable = null;

    // "과세표준명세" 텍스트가 포함된 테이블 찾기
    for (let i = 0; i < allTables.length; i++) {
      const table = allTables[i];
      const tableText = table.textContent || '';
      const normalizedText = tableText.replace(/\s+/g, '');
      const textWithoutSpaces = tableText.replace(/\s/g, '');

      if (tableText.includes('과세표준명세') ||
          tableText.includes('과세표준') ||
          normalizedText.includes('과세표준명세') ||
          textWithoutSpaces.includes('⑤과세표준명세') ||
          textWithoutSpaces.includes('⑤과세표준') ||
          (tableText.includes('⑤') && (tableText.includes('과세') || tableText.includes('표준')))) {
        taxBaseDetailTable = table;
        console.log('과세표준명세 테이블 발견 (인덱스: ' + i + ')');
        break;
      }
    }

    if (!taxBaseDetailTable) {
      return;
    }

    // 테이블의 행 수 확인
    const allRows = Array.from(taxBaseDetailTable.querySelectorAll('tr'));
    console.log('과세표준명세 테이블 총 행 수: ' + allRows.length);

    // 테이블의 현재 스타일 확인
    let tableStyle = taxBaseDetailTable.getAttribute('style') || '';

    // margin-bottom 제거 후 2pt로 설정
    tableStyle = tableStyle.replace(/margin-bottom\s*:\s*[^;]+;?/gi, '');
    if (tableStyle && !tableStyle.endsWith(';') && tableStyle.trim() !== '') {
      tableStyle += ';';
    }
    tableStyle += 'margin-bottom:2pt;';

    taxBaseDetailTable.setAttribute('style', tableStyle);
    console.log('과세표준명세 테이블 아래 간격 2pt 설정 완료');

    // 아래 테이블이 있으면 margin-top 제거 (간격은 위 테이블의 margin-bottom으로만 제어)
    const allTableElements = Array.from(document.querySelectorAll('table'));
    const currentIndex = allTableElements.indexOf(taxBaseDetailTable);

    if (currentIndex >= 0 && currentIndex < allTableElements.length - 1) {
      const nextTable = allTableElements[currentIndex + 1];
      let nextTableStyle = nextTable.getAttribute('style') || '';
      nextTableStyle = nextTableStyle.replace(/margin-top\s*:\s*[^;]+;?/gi, '');
      if (nextTableStyle && !nextTableStyle.endsWith(';') && nextTableStyle.trim() !== '') {
        nextTableStyle += ';';
      }
      nextTable.setAttribute('style', nextTableStyle);
      console.log('과세표준명세 테이블 아래 테이블의 margin-top 제거 완료');
    }
  }

  // 매입세액 테이블의 폭을 624pt로 설정하고 좌측 정렬
  function adjustPurchaseTaxTableWidth() {
    const purchaseTaxTable = document.querySelector('table.new-purchase-tax-table');
    if (!purchaseTaxTable) {
      return;
    }

    setTableWidthAndAlign(purchaseTaxTable);

    // box-sizing 추가하여 border가 폭에 포함되도록 설정 및 margin-top 제거
    let tableStyle = purchaseTaxTable.getAttribute('style') || '';

    // margin-top 제거
    tableStyle = tableStyle.replace(/margin-top\s*:\s*[^;]+;?/gi, '');
    tableStyle += 'margin-top:0;';

    if (!tableStyle.includes('box-sizing')) {
      if (tableStyle && !tableStyle.endsWith(';') && tableStyle.trim() !== '') {
        tableStyle += ';';
      }
      tableStyle += 'box-sizing:border-box;';
    }

    purchaseTaxTable.setAttribute('style', tableStyle);

    // 위의 테이블(신고내용 테이블)의 margin-bottom도 제거
    const allTables = document.querySelectorAll('table');
    let purchaseTaxTableIndex = -1;
    for (let i = 0; i < allTables.length; i++) {
      if (allTables[i] === purchaseTaxTable) {
        purchaseTaxTableIndex = i;
        break;
      }
    }

    if (purchaseTaxTableIndex > 0) {
      const prevTable = allTables[purchaseTaxTableIndex - 1];
      let prevTableStyle = prevTable.getAttribute('style') || '';
      prevTableStyle = prevTableStyle.replace(/margin-bottom\s*:\s*[^;]+;?/gi, '');
      prevTableStyle += 'margin-bottom:0;';
      prevTable.setAttribute('style', prevTableStyle);
    }

    console.log('매입세액 테이블 폭 및 정렬 설정 완료');
  }

  // 신고내용 테이블의 10행 6열 원문자 '㉮' 폰트 크기 키우기
  function increaseFontSizeForCircleText() {
    const reportTable = document.querySelector('table[style*="width:624pt"][style*="table-layout:fixed"]');
    if (!reportTable) {
      return;
    }

    const allRows = reportTable.querySelectorAll('tr');
    // 10행은 0-based index 9
    if (allRows.length > 9) {
      const row10 = allRows[9];
      const cells = row10.querySelectorAll('td');
      // 6열은 0-based index 5
      if (cells.length > 5) {
        const cell6 = cells[5];
        const pTag = cell6.querySelector('p');
        if (pTag && pTag.textContent.includes('㉮')) {
          let currentStyle = pTag.getAttribute('style') || '';
          // 기존 font-size 제거하고 10pt로 설정
          currentStyle = currentStyle.replace(/font-size[^;]*/gi, '');
          currentStyle = currentStyle.replace(/;;+/g, ';').replace(/^;|;$/g, '');
          if (currentStyle && !currentStyle.endsWith(';')) {
            currentStyle += ';';
          }
          pTag.setAttribute('style', currentStyle + 'font-size: 10pt;');
          console.log('신고내용 테이블 10행 6열 원문자 \'㉮\' 폰트 크기 10pt로 변경 완료');
        }
      }
    }
  }

  // 신고내용 테이블의 첫 번째 열 병합 셀 바닥 테두리 추가
  function addBottomBorderToMergedCell() {
    const reportTable = document.querySelector('table[style*="width:624pt"][style*="table-layout:fixed"]');
    if (!reportTable) {
      return;
    }

    const allRows = reportTable.querySelectorAll('tr');

    // 2행부터 시작 (0-based index 1)
    if (allRows.length > 1) {
      const row2 = allRows[1];
      const firstCell = row2.querySelector('td');

      if (firstCell) {
        const rowspan = parseInt(firstCell.getAttribute('rowspan') || '1', 10);

        // rowspan이 9인 셀 (2행~10행 병합) 찾기
        if (rowspan === 9) {
          const currentStyle = firstCell.getAttribute('style') || '';

          // 바닥 테두리 추가
          if (!currentStyle.includes('border-bottom')) {
            firstCell.setAttribute('style', currentStyle + '; border-bottom: 1pt solid #7E7E7E;');
            console.log('첫 번째 열 병합 셀 바닥 테두리 추가 완료');
          }
        }
      }
    }
  }

  // 여러 시점에서 실행
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
      addInputBoxesToReportTable();
      addBottomBorderToMergedCell();
      increaseFontSizeForCircleText();
      // DOMContentLoaded에서도 실행
      setTimeout(function() {
        unmergeAllCellsInDeclarationConfirmTable();
        adjustAccountReportTextAlignment();
        insertTableBetweenAccountReportAndZeroRate();
        setTimeout(function() {
          insertTableBelowClosureReport();
          alignAllTables();
        }, 150);
        adjustZeroRateTextAlignment();
        // adjustBusinessTypeTextAlignment(); // 동적 기능 제거 - 과세표준명세 테이블 좌측 열 흔들림 방지
        // setSectionTextFontSize10pt(); // 동적 기능 제거 - 과세표준명세 테이블 좌측 열 흔들림 방지
        // setBusinessTableToHrSpacing(); // 함수가 정의되지 않아 주석 처리
        removeInputBoxesFromTaxBaseDetailTableRow7();
        adjustSectionTitleHeight();
        checkZeroRateTableDimensions();
        checkZeroRateTableFirstRow();
        insertTableBelowZeroRate();
        // "⑤ 과세표준명세" 테이블의 6열 병합 비활성화 (처음 나타나는 테이블 양식 유지)
        // setTimeout(function() {
        //   window.ensureRowspanForTaxBaseDetailTableColumn6();
        // }, 150);
        // setTimeout(function() {
        //   window.ensureRowspanForTaxBaseDetailTableColumn6();
        // }, 300);
        // setTimeout(function() {
        //   window.ensureRowspanForTaxBaseDetailTableColumn6();
        // }, 500);
      }, 100);
    });
  } else {
    addInputBoxesToReportTable();
    addBottomBorderToMergedCell();
    increaseFontSizeForCircleText();
    // 즉시 실행 가능한 경우에도 시도
    setTimeout(function() {
      // 과세표준명세 테이블 병합 해제 비활성화 (처음 나타나는 테이블 양식 유지)
      // unmergeAllCellsInTaxBaseDetailTable();
      // unmergeColspanInTaxBaseDetailTableRow2();
      // 병합 해제 후 테두리 추가 - 동적 기능 제거 (HTML에 직접 테두리 추가됨)
      // setTimeout(function() {
      //   addBordersToTaxBaseDetailTable();
      // }, 300);
      unmergeAllCellsInDeclarationConfirmTable();
      adjustAccountReportTextAlignment();
      insertTableBetweenAccountReportAndZeroRate();
      setTimeout(function() {
        insertTableBelowClosureReport();
        alignAllTables();
      }, 150);
      // setSectionTextFontSize10pt(); // 동적 기능 제거 - 과세표준명세 테이블 좌측 열 흔들림 방지
      // setBusinessTableToHrSpacing(); // 함수가 정의되지 않아 주석 처리
      adjustSectionTitleHeight();
      setTimeout(function() {
        insertTableBelowZeroRate();
      }, 200);
      // "⑤ 과세표준명세" 테이블의 6열 병합 비활성화 (처음 나타나는 테이블 양식 유지)
      // setTimeout(function() {
      //   if (window.ensureRowspanForTaxBaseDetailTableColumn6) {
      //     window.ensureRowspanForTaxBaseDetailTableColumn6();
      //   }
      // }, 250);
      // setTimeout(function() {
      //   if (window.ensureRowspanForTaxBaseDetailTableColumn6) {
      //     window.ensureRowspanForTaxBaseDetailTableColumn6();
      //   }
      // }, 500);
    }, 100);
  }
  window.addEventListener('load', function() {
    // 과세표준명세 테이블 삭제 비활성화 (처음 나타나는 테이블 양식 유지)
    // removeTaxBaseDetailTable();
    // setupTaxBaseDetailTableObserver(); // 동적 생성 감지

    // 과세표준명세 테이블 초기 스타일 고정 (흔들림 방지 - 가장 먼저 실행)
    fixTaxBaseDetailTableStyle();

    addInputBoxesToEmptyCells();
    fitInputBoxesToCells();
    addInputBoxesToReportTable();
    addBottomBorderToMergedCell();
    increaseFontSizeForCircleText();
    createNewPurchaseTaxTable();
    adjustTablesBelowAccountReport();
    adjustAccountReportTextAlignment();
    insertTableBetweenAccountReportAndZeroRate();
    setTimeout(function() {
      insertTableBelowClosureReport();
    }, 150);
    adjustZeroRateTextAlignment();
    // adjustBusinessTypeTextAlignment(); // 동적 기능 제거 - 과세표준명세 테이블 좌측 열 흔들림 방지
    // setSectionTextFontSize10pt(); // 동적 기능 제거 - 과세표준명세 테이블 좌측 열 흔들림 방지
    // setBusinessTableToHrSpacing(); // 함수가 정의되지 않아 주석 처리
    // adjustSectionTitleHeight(); // 동적 기능 제거 - 과세표준명세 테이블 흔들림 방지
    // removeInputBoxesFromTaxBaseDetailTableRow7(); // 동적 기능 제거 - 과세표준명세 테이블 흔들림 방지
    // "⑤ 과세표준명세" 테이블의 6열 병합 비활성화 (처음 나타나는 테이블 양식 유지)
    // setTimeout(function() {
    //   window.ensureRowspanForTaxBaseDetailTableColumn6();
    // }, 100);
    // setTimeout(function() {
    //   window.ensureRowspanForTaxBaseDetailTableColumn6();
    // }, 300);
    // setTimeout(function() {
    //   window.ensureRowspanForTaxBaseDetailTableColumn6();
    // }, 600);
    // setTimeout(function() {
    //   window.ensureRowspanForTaxBaseDetailTableColumn6();
    // }, 1000);
    // 과세표준명세 테이블에 테두리 추가 - 동적 기능 제거 (HTML에 직접 테두리 추가됨)
    // setTimeout(function() {
    //   addBordersToTaxBaseDetailTable();
    // }, 400);
    // setTimeout(function() {
    //   addBordersToTaxBaseDetailTable();
    // }, 800);
    // setTimeout(function() {
    //   addBordersToTaxBaseDetailTable();
    // }, 1200);
    // 영세율 상호주의 테이블 아래 테이블 생성 (여러 시점에서 호출)
    setTimeout(function() {
      insertTableBelowZeroRate();
    }, 200);
    setTimeout(function() {
      insertTableBelowZeroRate();
    }, 500);
    setTimeout(function() {
      insertTableBelowZeroRate();
    }, 1000);
    // 과세표준명세 테이블 삭제는 load 이벤트에서만 실행
    unmergeAllCellsInDeclarationConfirmTable();
    // unmergeAllCellsInBusinessTypeTable(); // 과세표준명세 테이블이 삭제되었으므로 실행하지 않음
    // 매입세액 테이블 생성 후 배경색 설정 및 입력박스 추가
    setTimeout(function() {
      adjustPurchaseTaxTableWidth();
      // setBackgroundColorForColumn5(); // 비활성화됨
      addInputBoxesToPurchaseTaxTable();
    }, 200);
  });
  setTimeout(function() {
    addInputBoxesToEmptyCells();
    fitInputBoxesToCells();
    addInputBoxesToReportTable();
    addBottomBorderToMergedCell();
    increaseFontSizeForCircleText();
    // unmergeAllCellsInPurchaseTaxTable(); // 비활성화됨
    // setBackgroundColorForColumn5(); // 비활성화됨
    addInputBoxesToPurchaseTaxTable();
    setTimeout(ensureColumn7InputBoxes, 100);
    adjustTablesBelowAccountReport();
    adjustAccountReportTextAlignment();
    insertTableBetweenAccountReportAndZeroRate();
    setTimeout(function() {
      insertTableBelowClosureReport();
      alignAllTables();
    }, 150);
    adjustZeroRateTextAlignment();
    // adjustBusinessTypeTextAlignment(); // 동적 기능 제거 - 과세표준명세 테이블 좌측 열 흔들림 방지
    // setSectionTextFontSize10pt(); // 동적 기능 제거 - 과세표준명세 테이블 좌측 열 흔들림 방지
    checkZeroRateTableDimensions();
    checkZeroRateTableFirstRow();
    // 과세표준명세 테이블 삭제는 load 이벤트에서만 실행
    adjustPurchaseTaxTableWidth();
    unmergeAllCellsInDeclarationConfirmTable();
    // unmergeAllCellsInBusinessTypeTable(); // 삭제됨
    setLastTableWidth();
    removeInputBoxFromFirstColumn();
    addInputBoxesToLastTable();
    alignTaxAgentTextCenter();
  }, 500);
  setTimeout(function() {
    addInputBoxesToEmptyCells();
    addInputBoxesToReportTable();
    addBottomBorderToMergedCell();
    // unmergeAllCellsInPurchaseTaxTable(); // 비활성화됨
  }, 1000);
  setTimeout(function() {
    addInputBoxesToReportTable();
    addBottomBorderToMergedCell();
    // unmergeAllCellsInPurchaseTaxTable(); // 비활성화됨
    adjustTablesBelowAccountReport();
    adjustAccountReportTextAlignment();
    insertTableBetweenAccountReportAndZeroRate();
    setTimeout(function() {
      insertTableBelowClosureReport();
      alignAllTables();
    }, 150);
    adjustZeroRateTextAlignment();
    // adjustBusinessTypeTextAlignment(); // 동적 기능 제거 - 과세표준명세 테이블 좌측 열 흔들림 방지
    // setSectionTextFontSize10pt(); // 동적 기능 제거 - 과세표준명세 테이블 좌측 열 흔들림 방지
    // setBusinessTableToHrSpacing(); // 함수가 정의되지 않아 주석 처리
    adjustSectionTitleHeight();
    checkZeroRateTableDimensions();
    checkZeroRateTableFirstRow();
    // 과세표준명세 테이블 삭제는 load 이벤트에서만 실행
    adjustPurchaseTaxTableWidth();
    unmergeAllCellsInDeclarationConfirmTable();
    // unmergeAllCellsInBusinessTypeTable(); // 과세표준명세 테이블이 삭제되었으므로 실행하지 않음
    setLastTableWidth();
    removeInputBoxFromFirstColumn();
    addInputBoxesToLastTable();
    alignTaxAgentTextCenter();
  }, 2000);
  // 추가로 더 긴 지연 시간으로도 시도
  setTimeout(function() {
    unmergeAllCellsInDeclarationConfirmTable();
  }, 3000);
  setTimeout(function() {
    unmergeAllCellsInDeclarationConfirmTable();
  }, 5000);
});
</script></head><body><ul id="l1"><li data-list-text="■"><p style="padding-top: 2pt;padding-left: 18pt;text-indent: -11pt;text-align: left;">부가가치세법 시행규칙 [별지 제21호서식] <span style=" color: #00F;">&lt;개정 2025. 3. 21.&gt;</span></p></li></ul><table style="width:624pt;border-collapse:collapse;margin:0;padding:0"><tr><td style="vertical-align:middle;width:270pt;padding:0;margin:0;vertical-align:middle"><div class="textbox" style="display:flex;align-items:center;justify-content:center;min-height:70pt;width:100%;"><p class="s2" style="text-indent: 0pt;line-height: 20pt;text-align: center;margin:0;">일반과세자 부가가치세</p></div></td><td style="vertical-align:middle;width:354pt;padding:0;margin:0;vertical-align:middle"><div class="textbox" style="display:block;min-height:70pt;width:100%;"><p class="s2" style="padding-top: 6pt;padding-left: 2pt;text-indent: 0pt;line-height: 18pt;text-align: left;margin:0;">[<input type="checkbox" name="reportType" id="check1">] 예정 [<input type="checkbox" name="reportType" id="check2">]확정</p><p class="s2" style="padding-left: 2pt;text-indent: 0pt;line-height: 18pt;text-align: left;margin:0;">[<input type="checkbox" name="reportType" id="check3">] 기한후 과세표준<span style="padding-left: 30pt;">신고서</span></p><p class="s2" style="padding-left: 2pt;text-indent: 0pt;line-height: 18pt;text-align: left;margin:0;">[<input type="checkbox" name="reportType" id="check4">] 영세율 등 조기환급</p></div></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="width:624pt;border-collapse:collapse;margin:0;padding:0"><tr><td style="vertical-align:middle;width:400.4pt;padding:0;margin:0"><div class="textbox" style="background:#BABABA;display:block;min-height:12.9pt;width:100%;"><p class="s3" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;line-height: 15pt;padding-left: 8pt;text-align: left;">관리번호</p></div></td><td style="vertical-align:middle;width:223.6pt;padding:0;margin:0;vertical-align:middle"><div class="textbox" style="background:#BABABA;display:block;min-height:12.9pt;width:100%;border-left-style:solid;border-left-width:1pt;border-left-color:#808080;"><p class="s3" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;line-height: 15pt;text-align: left;">처리기간<span style="padding-left: 30pt;">즉시</span></div></td></tr></table><p style="text-indent: 0pt;height: 5pt;padding-bottom: 2pt;text-align: left;"/></p><p style="padding-left: 7pt;padding-bottom: 2pt;text-indent: 0pt;text-align: left;">신고기간 <input type="text" maxLength={4} class="report-period-input" style="width:40pt;border:none;text-align:center;font-size:8pt;" />년  제 <input type="text" maxLength={2} class="report-period-input" style="width:15pt;border:none;text-align:center;font-size:8pt;" /> 기 (<input type="text" maxLength={2} class="report-period-input" style="width:15pt;border:none;text-align:center;font-size:8pt;" />월 <input type="text" maxLength={2} class="report-period-input" style="width:15pt;border:none;text-align:center;font-size:8pt;" />일 ~ <input type="text" maxLength={2} class="report-period-input" style="width:15pt;border:none;text-align:center;font-size:8pt;" />월 <input type="text" maxLength={2} class="report-period-input" style="width:15pt;border:none;text-align:center;font-size:8pt;" /> 일)</p><table class="business-info-table" style="width:624pt;border-collapse:collapse;margin:0;table-layout:fixed" cellspacing="0"><tr style="height:18pt"><td style="vertical-align:middle;width:30pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="4"><p style="text-indent: 0pt;text-align: left;margin: 0;padding: 0;line-height: 0;height: 0;"><br/></p><p class="s3" style="padding-left: 3pt;padding-top: 0;margin-top: 0;text-indent: 0pt;text-align: left;">사업자</p></td><td style="vertical-align:middle;width:50pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-left: 8pt;text-indent: 0pt;line-height: 8pt;text-align: left;">상 호</p><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 8pt;text-align: left;">(법인명)</p></td><td style="vertical-align:middle;width:85pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><input type="text" class="cell-input" /></td><td style="vertical-align:middle;width:50pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-left: 2pt;text-indent: 0pt;line-height: 8pt;text-align: left;">성  명</p><p class="s3" style="padding-left: 1pt;text-indent: 0pt;line-height: 8pt;text-align: left;">(대표자명)</p></td><td style="vertical-align:middle;width:72pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><input type="text" class="cell-input" /></td><td style="vertical-align:middle;width:64pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-top: 3pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">사업자등록번호</p></td><td style="vertical-align:middle;width:18pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><input type="text" class="cell-input" /></td><td style="vertical-align:middle;width:18pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><input type="text" class="cell-input" /></td><td style="vertical-align:middle;width:18pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><input type="text" class="cell-input" /></td><td style="vertical-align:middle;width:18pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-top: 3pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">-</p></td><td style="vertical-align:middle;width:18pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:18pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:18pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-top: 3pt;padding-left: 4pt;text-indent: 0pt;text-align: left;">-</p></td><td style="vertical-align:middle;width:18pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:18pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:18pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:18pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:18pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:50pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="2"><p class="s3" style="padding-top: 5pt;padding-left: 6pt;text-indent: 0pt;text-align: left;">생년월일</p></td><td style="vertical-align:middle;width:136pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="2" rowspan="2"><input type="text" class="cell-input" /></td><td style="vertical-align:middle;width:72pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-left: 1pt;text-indent: 0pt;line-height: 10pt;text-align: center;">전화번호</p></td><td style="vertical-align:middle;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="1"><p class="s3" style="padding-left: 25pt;text-indent: 0pt;line-height: 9pt;text-align: left;">사업장</p></td><td style="vertical-align:middle;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="7"><p class="s3" style="padding-left: 25pt;text-indent: 0pt;line-height: 9pt;text-align: left;">주소지</p></td><td style="vertical-align:middle;width:73pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E" colspan="5"><p class="s3" style="padding-left: 21pt;text-indent: 0pt;line-height: 9pt;text-align: left;">휴대전화</p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:72pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><input type="text" class="cell-input" /></td><td style="vertical-align:middle;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E;position:relative!important;padding:0!important;margin:0!important;" colspan="1"><input type="text" class="cell-input" /></td><td style="vertical-align:middle;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E;position:relative!important;padding:0!important;margin:0!important;" colspan="7"><input type="text" class="cell-input" /></td><td style="vertical-align:middle;width:73pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E" colspan="5"><input type="text" class="cell-input" /></td></tr><tr style="height:18pt"><td style="vertical-align:middle;width:50pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-top: 3pt;padding-left: 1pt;text-indent: 0pt;text-align: left;">사업장주소</p></td><td style="vertical-align:middle;width:208pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="3"><input type="text" class="cell-input" /></td><td style="vertical-align:middle;width:45pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-left: 1pt;text-indent: 0pt;line-height: 8pt;text-align: center;">전자우편</p><p class="s3" style="padding-left: 1pt;text-indent: 0pt;line-height: 8pt;text-align: center;">주소</p></td><td style="vertical-align:middle;width:146pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt" colspan="12"><input type="text" class="cell-input" /></td></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><p style="text-indent: 0pt;text-align: left;"/><hr style="width: 624pt; height: 1pt; border: none; border-top: 1pt solid #000; margin: 0; padding: 0;"/><p class="s7" style="padding-left: 3pt;padding-top: 3pt;padding-bottom: 3pt;text-indent: 0pt;text-align: left;">①  <b>신고내용</b></p><table style="width:624pt;border-collapse:collapse;margin:0;table-layout:fixed" cellspacing="0"><colgroup><col style="width:40pt"/><col style="width:25pt"/><col style="width:161pt"/><col style="width:25pt"/><col style="width:161pt"/><col style="width:40pt"/><col style="width:171pt"/></colgroup><tr style="height:15pt"><td style="vertical-align:middle;width:251pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="4"><p class="s3" style="text-indent: 0pt;line-height: 11pt;text-align: center;font-size: 9pt;padding-left: 0pt;">구     분</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 11pt;text-align: center;font-size: 9pt;padding-left: 0pt;">금  액</p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 11pt;text-align: center;font-size: 9pt;padding-left: 0pt;">세율</p></td><td style="vertical-align:middle;width:171pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt"><p class="s3" style="text-indent: 0pt;line-height: 11pt;text-align: center;font-size: 9pt;padding-left: 0pt;">세  액</p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="9"><p class="s3" style="text-indent: 0pt;line-height: 130%;text-align: center;font-size: 9pt;">과세<br/>표준<br/><span style="display: block;margin-top: 5pt;"> 및 </span><span style="display: block;margin-top: 5pt;">매출<br/>세액</span></p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="4"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;font-size: 9pt;">과세</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">세금계산서 발급분</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;padding-left: 0pt;">(1)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s9" style="text-indent: 0pt;line-height: 8pt;text-align: center;font-size: 9pt;color: #000;padding-left: 0pt;">10/100</p></td><td style="vertical-align:middle;width:171pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">매입자발행 세금계산서</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;padding-left: 0pt;">(2)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s9" style="text-indent: 0pt;line-height: 8pt;text-align: center;font-size: 9pt;color: #000;padding-left: 0pt;">10/100</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">신용카드ㆍ현금영수증 발행분</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;padding-left: 0pt;">(3)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s9" style="text-indent: 0pt;line-height: 8pt;text-align: center;font-size: 9pt;color: #000;padding-left: 0pt;">10/100</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">기타(정규영수증 외 매출분)</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">(4)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s9" style="text-indent: 0pt;line-height: 8pt;text-align: center;font-size: 9pt;color: #000;padding-left: 0pt;">10/100</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="2"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;font-size: 9pt;">영세율</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;text-align: left;">세금계산서 발급분</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;text-align: center;padding-left: 0pt;">(5)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s9" style="padding-top: 1pt;text-indent: 0pt;text-align: center;font-size: 9pt;color: #000;padding-left: 0pt;">0/100</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 10pt;text-align: left;">기        타</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;padding-left: 0pt;">(6)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s9" style="text-indent: 0pt;text-align: center;font-size: 9pt;color: #000;padding-left: 0pt;">0/100</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:186pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="2"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;font-size: 9pt;">예정 신고 누락분</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;padding-left: 0pt;">(7)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:186pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="2"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;font-size: 9pt;">대손세액 가감</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;padding-left: 0pt;">(8)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:171pt;border-top:1pt solid #7E7E7E;border-left:1pt solid #7E7E7E;border-bottom:1pt solid #7E7E7E;border-right:0 !important;border-right-width:0 !important;border-right-style:none !important;border-right-color:transparent !important"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:186pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="2"><p class="s3" style="padding-left: 5pt;text-indent: 0pt;line-height: 9pt;text-align: left;font-size: 9pt;">합계</p></td><td style="vertical-align:middle;width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;padding-left: 0pt;">(9)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s6" style="text-indent: 0pt;line-height: 10pt;text-align: center;padding-left: 0pt;">㉮</p></td><td style="vertical-align:middle;width:171pt;border-top:1pt solid #7E7E7E;border-left:none !important;border-bottom:1pt solid #7E7E7E;border-right:none"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr></table><table style="width:624pt;border-collapse:collapse;margin:0;margin-top:2pt;table-layout:fixed" cellspacing="0"><tr style="height:15pt"><td style="vertical-align:middle;width:30pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="9"><p style="text-indent: 0pt;text-align: left;"><br/></p><p class="s3" style="padding-left: 7pt;padding-right: 5pt;text-indent: 0pt;line-height: 110%;text-align: left;font-size: 9pt;">매입 세액</p></td><td style="vertical-align:middle;width:50pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="3"><p class="s3" style="padding-top: 7pt;padding-left: 6pt;padding-right: 6pt;text-indent: 0pt;line-height: 100%;text-align: left;">세금계산서 수 취 분</p></td><td style="vertical-align:middle;width:30pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">일 반 매 입</p></td><td style="vertical-align:middle;width:18pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">(10)</p></td><td style="vertical-align:middle;width:90pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:30pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:98pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">수출기업 수입분 납부유예</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">(10-1)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" bgcolor="#D5D5D5"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:98pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="padding-left: 1pt;text-indent: 0pt;line-height: 9pt;text-align: left;">고정자산 매입</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">(11)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:151pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="2"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;font-size: 9pt;">예정 신고 누락분</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">(12)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:151pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="2"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">매입자발행 세금계산서</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">(13)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:151pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="2"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">그 밖의 공제매입세액</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">(14)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:151pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="2"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">합계 (10)-(10-1)+(11)+(12)+(13)+(14)</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">(15)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:151pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="2"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">공제받지 못할 매입세액</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">(16)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:151pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="2"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 9pt;text-align: left;">차감계 (15)-(16)</p></td><td style="vertical-align:middle;width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">(17)</p></td><td style="vertical-align:middle;width:120pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:30pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">㉯</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:321pt;border-top-style:solid;border-top-width:1pt;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="5"><p class="s3" style="padding-left: 36pt;text-indent: 0pt;line-height: 11pt;text-align: left;">납 부 ( 환 급 ) 세 액 ( 매 출 세 액 ㉮ - 매 입 세 액 ㉯ )</p></td><td style="vertical-align:middle;width:30pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">㉰</p></td><td style="vertical-align:middle;width:171pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:30pt;border-top-style:solid;border-top-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">경감</p></td><td style="vertical-align:middle;width:151pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="2" rowspan="2"><p class="s3" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">그 밖의 경감ㆍ공제세액</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="2"><p class="s3" style="padding-left: 2pt;text-indent: 0pt;text-align: left;">(18)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="2" bgcolor="#D5D5D5"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:30pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="2"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:171pt;border-top-style:solid;border-top-width:1pt;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E" rowspan="2"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="2"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">•</p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:151pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="2" rowspan="2"><p class="s3" style="padding-left: 1pt;text-indent: 0pt;text-align: left;">신용카드매출전표등 발행공제 등</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="2"><p class="s3" style="padding-left: 2pt;text-indent: 0pt;text-align: left;">(19)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="2"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="2"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E" rowspan="2"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="2"><p class="s3" style="padding-left: 7pt;text-indent: 0pt;line-height: 8pt;text-align: left;">공제</p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:151pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="2" rowspan="2"><p class="s3" style="padding-top: 1pt;padding-left: 3pt;text-indent: 0pt;text-align: left;">합계</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="2"><p class="s3" style="padding-top: 1pt;padding-left: 2pt;text-indent: 0pt;text-align: left;">(20)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="2"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" rowspan="2"><p class="s3" style="padding-top: 1pt;text-indent: 0pt;text-align: center;">㉱</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E" rowspan="2"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:30pt;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 9pt;text-align: center;">세액</p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:185pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#999999;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="3"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">소규모 개인사업자 부가가치세 감면세액</p></td><td style="vertical-align:middle;width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#999999;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">(20-1)</p></td><td style="vertical-align:middle;width:120pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#999999;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:30pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#999999;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">㉲</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#999999"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:185pt;border-top-style:solid;border-top-width:1pt;border-top-color:#999999;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="3"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">예정 신고 미환급 세액</p></td><td style="vertical-align:middle;width:15pt;border-top-style:solid;border-top-width:1pt;border-top-color:#999999;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">(21)</p></td><td style="vertical-align:middle;width:120pt;border-top-style:solid;border-top-width:1pt;border-top-color:#999999;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:30pt;border-top-style:solid;border-top-width:1pt;border-top-color:#999999;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">㉳</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#999999;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:185pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="3"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">예정 고지 세액</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">(22)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">㉴</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:185pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="3"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">사업양수자가 대리납부한 세액</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">(23)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" bgcolor="#D5D5D5"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">㉵</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:185pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="3"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">매입자 납부특례에 따라 납부한 세액</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">(24)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" bgcolor="#D5D5D5"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">㉶</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:185pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="3"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">신용카드업자가 대리납부한 세액</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">(25)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" bgcolor="#D5D5D5"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">㉷</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:185pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="3"><p class="s3" style="padding-left: 6pt;text-indent: 0pt;line-height: 11pt;text-align: left;">가산세액 계</p></td><td style="vertical-align:middle;width:25pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">(26)</p></td><td style="vertical-align:middle;width:161pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">㉸</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:321pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="5"><p class="s3" style="padding-left: 7pt;text-indent: 0pt;line-height: 11pt;text-align: left;">차감ㆍ가감하여 납부할 세액(환급받을 세액)(㉰-㉱-㉲-㉳-㉴-㉵-㉶-㉷+㉸)</p></td><td style="vertical-align:middle;width:40pt;text-align:center;text-align:center;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E"><p class="s3" style="text-indent: 0pt;line-height: 11pt;text-align: center;">(27)</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#7E7E7E"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:351pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt;border-right-style:solid;border-right-width:1pt;border-right-color:#7E7E7E" colspan="6"><p class="s3" style="text-indent: 0pt;line-height: 11pt;text-align: center;">총 괄 납 부 사 업 자 가 납 부 할 세 액 (환 급 받 을 세 액 )</p></td><td style="vertical-align:middle;width:134pt;border-top-style:solid;border-top-width:1pt;border-top-color:#7E7E7E;border-left-style:solid;border-left-width:1pt;border-left-color:#7E7E7E;border-bottom-style:solid;border-bottom-width:1pt"><p style="text-indent: 0pt;text-align: left;"><br/></p></tr></table><p style="text-indent: 0pt;text-align: left;"><br/></p><table style="border-collapse:collapse;margin-left:5.929pt" cellspacing="0"><tr style="height:15pt"><td style="vertical-align:middle;width:57pt;border-top-style:solid;border-top-width:1pt;border-top-color:#808080;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#808080;border-right-style:solid;border-right-width:1pt;border-right-color:#808080" rowspan="2"><p class="s3" style="padding:0;padding-left: 6pt;text-indent: 0pt;text-align: left;">세무대리인</p></td><td style="vertical-align:middle;width:79pt;border-top-style:solid;border-top-width:1pt;border-top-color:#808080;border-left-style:solid;border-left-width:1pt;border-left-color:#808080;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#808080;border-right-style:solid;border-right-width:1pt;border-right-color:#808080"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">성 명</p></td><td style="vertical-align:middle;width:132pt;border-top-style:solid;border-top-width:1pt;border-top-color:#808080;border-left-style:solid;border-left-width:1pt;border-left-color:#808080;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#808080;border-right-style:solid;border-right-width:1pt;border-right-color:#808080" colspan="2"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:70pt;border-top-style:solid;border-top-width:1pt;border-top-color:#808080;border-left-style:solid;border-left-width:1pt;border-left-color:#808080;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#808080;border-right-style:solid;border-right-width:1pt;border-right-color:#808080"><p class="s3" style="padding-left: 3pt;text-indent: 0pt;line-height: 10pt;text-align: left;">사업자등록번호</p></td><td style="vertical-align:middle;width:141pt;border-top-style:solid;border-top-width:1pt;border-top-color:#808080;border-left-style:solid;border-left-width:1pt;border-left-color:#808080;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#808080" colspan="2"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr><tr style="height:15pt"><td style="vertical-align:middle;width:69pt;border-top-style:solid;border-top-width:1pt;border-top-color:#808080;border-left-style:solid;border-left-width:1pt;border-left-color:#808080;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#808080;border-right-style:solid;border-right-width:1pt;border-right-color:#808080"><p class="s3" style="text-indent: 0pt;line-height: 10pt;text-align: center;">관리번호</p></td><td style="vertical-align:middle;width:72pt;border-top-style:solid;border-top-width:1pt;border-top-color:#808080;border-left-style:solid;border-left-width:1pt;border-left-color:#808080;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#808080;border-right-style:solid;border-right-width:1pt;border-right-color:#808080"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:70pt;border-top-style:solid;border-top-width:1pt;border-top-color:#808080;border-left-style:solid;border-left-width:1pt;border-left-color:#808080;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#808080;border-right-style:solid;border-right-width:1pt;border-right-color:#808080"><p class="s3" style="padding-left: 17pt;text-indent: 0pt;line-height: 10pt;text-align: left;">생년월일</p></td><td style="vertical-align:middle;width:70pt;border-top-style:solid;border-top-width:1pt;border-top-color:#808080;border-left-style:solid;border-left-width:1pt;border-left-color:#808080;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#808080;border-right-style:solid;border-right-width:1pt;border-right-color:#808080"><p style="text-indent: 0pt;text-align: left;"><br/></p></td><td style="vertical-align:middle;width:70pt;border-top-style:solid;border-top-width:1pt;border-top-color:#808080;border-left-style:solid;border-left-width:1pt;border-left-color:#808080;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#808080;border-right-style:solid;border-right-width:1pt;border-right-color:#808080"><p class="s3" style="padding-left: 17pt;text-indent: 0pt;line-height: 10pt;text-align: left;">전화번호</p></td><td style="vertical-align:middle;width:71pt;border-top-style:solid;border-top-width:1pt;border-top-color:#808080;border-left-style:solid;border-left-width:1pt;border-left-color:#808080;border-bottom-style:solid;border-bottom-width:1pt;border-bottom-color:#808080"><p style="text-indent: 0pt;text-align: left;"><br/></p></td></tr></table></body></h

